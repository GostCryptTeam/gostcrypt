\hypertarget{_xts_8c}{}\section{Common/\+Xts.c File Reference}
\label{_xts_8c}\index{Common/\+Xts.\+c@{Common/\+Xts.\+c}}


Manage the X\+TS encryption which consists of switching bytes in blocks before encrypting them. It covers 32 and 64 bytes platforms. there are optimized function for parallel and non parallel.  


{\ttfamily \#include \char`\"{}Xts.\+h\char`\"{}}\newline
Include dependency graph for Xts.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_xts_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_xts_8c_aad9147213002ffaa3c0450853005e646}{Encrypt\+Buffer\+X\+TS} (unsigned \+\_\+\+\_\+int8 $\ast$buffer, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT} length, const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$start\+Data\+Unit\+No, unsigned int start\+Cipher\+Block\+No, unsigned \+\_\+\+\_\+int8 $\ast$ks, unsigned \+\_\+\+\_\+int8 $\ast$ks2, int cipher)
\begin{DoxyCompactList}\small\item\em length\+: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cipher block size ks\+: the primary key schedule ks2\+: the secondary key schedule start\+Data\+Unit\+No\+: The sequential number of the data unit with which the buffer starts. start\+Cipher\+Block\+No\+: The sequential number of the first plaintext block to encrypt inside the data unit start\+Data\+Unit\+No. When encrypting the data unit from its first block, start\+Cipher\+Block\+No is 0. The start\+Cipher\+Block\+No value applies only to the first data unit in the buffer; each successive data unit is encrypted from its first block. The start of the buffer does not have to be aligned with the start of a data unit. If it is aligned, start\+Cipher\+Block\+No must be 0; if it is not aligned, start\+Cipher\+Block\+No must reflect the misalignment accordingly. \end{DoxyCompactList}\item 
void \hyperlink{_xts_8c_af9db6f7d5ac83732ee40cfdf0ca69e16}{Encrypt\+Buffer\+X\+T\+S8\+Byte} (unsigned \+\_\+\+\_\+int8 $\ast$buffer, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT} length, const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$start\+Data\+Unit\+No, unsigned int start\+Cipher\+Block\+No, unsigned \+\_\+\+\_\+int8 $\ast$ks, unsigned \+\_\+\+\_\+int8 $\ast$ks2, int cipher)
\begin{DoxyCompactList}\small\item\em The goal is to switch some byte of a encrypted data with the next encrypted data. This doesn\textquotesingle{}t hurt the algorithm security and add a switching parameter to the encryption. On a 32-\/byte data it switches data with another block of data Then encrypt it. \end{DoxyCompactList}\item 
void \hyperlink{_xts_8c_acf61facb05a3ea253498a379275f48a6}{Decrypt\+Buffer\+X\+TS} (unsigned \+\_\+\+\_\+int8 $\ast$buffer, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT} length, const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$start\+Data\+Unit\+No, unsigned int start\+Cipher\+Block\+No, unsigned \+\_\+\+\_\+int8 $\ast$ks, unsigned \+\_\+\+\_\+int8 $\ast$ks2, int cipher)
\begin{DoxyCompactList}\small\item\em For descriptions of the input parameters, see \hyperlink{_xts_8c_aad9147213002ffaa3c0450853005e646}{Encrypt\+Buffer\+X\+T\+S()}. Decrypt before switching back the data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{_xts_8c_a0b750322cc8c20d6c3fab26e0c5553d1}\label{_xts_8c_a0b750322cc8c20d6c3fab26e0c5553d1}} 
void {\bfseries Decrypt\+Buffer\+X\+T\+S8\+Byte} (unsigned \+\_\+\+\_\+int8 $\ast$buffer, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT} length, const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$start\+Data\+Unit\+No, unsigned int start\+Cipher\+Block\+No, unsigned \+\_\+\+\_\+int8 $\ast$ks, unsigned \+\_\+\+\_\+int8 $\ast$ks2, int cipher)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Manage the X\+TS encryption which consists of switching bytes in blocks before encrypting them. It covers 32 and 64 bytes platforms. there are optimized function for parallel and non parallel. 

\begin{DoxyVersion}{Version}
1.\+3.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
23/01/2017 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{_xts_8c_acf61facb05a3ea253498a379275f48a6}\label{_xts_8c_acf61facb05a3ea253498a379275f48a6}} 
\index{Xts.\+c@{Xts.\+c}!Decrypt\+Buffer\+X\+TS@{Decrypt\+Buffer\+X\+TS}}
\index{Decrypt\+Buffer\+X\+TS@{Decrypt\+Buffer\+X\+TS}!Xts.\+c@{Xts.\+c}}
\subsubsection{\texorpdfstring{Decrypt\+Buffer\+X\+T\+S()}{DecryptBufferXTS()}}
{\footnotesize\ttfamily void Decrypt\+Buffer\+X\+TS (\begin{DoxyParamCaption}\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{buffer,  }\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT}}]{length,  }\item[{const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$}]{start\+Data\+Unit\+No,  }\item[{unsigned int}]{start\+Cipher\+Block\+No,  }\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{ks,  }\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{ks2,  }\item[{int}]{cipher }\end{DoxyParamCaption})}



For descriptions of the input parameters, see \hyperlink{_xts_8c_aad9147213002ffaa3c0450853005e646}{Encrypt\+Buffer\+X\+T\+S()}. Decrypt before switching back the data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ buffer \\
\hline
\mbox{\tt in}  & {\em G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT} & length \\
\hline
\mbox{\tt in}  & {\em const} & \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$ start\+Data\+Unit\+No \\
\hline
\mbox{\tt in}  & {\em unsigned} & int start\+Cipher\+Block\+No \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ ks \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ ks2 \\
\hline
\mbox{\tt in}  & {\em int} & cipher \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_xts_8c_acf61facb05a3ea253498a379275f48a6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_xts_8c_aad9147213002ffaa3c0450853005e646}\label{_xts_8c_aad9147213002ffaa3c0450853005e646}} 
\index{Xts.\+c@{Xts.\+c}!Encrypt\+Buffer\+X\+TS@{Encrypt\+Buffer\+X\+TS}}
\index{Encrypt\+Buffer\+X\+TS@{Encrypt\+Buffer\+X\+TS}!Xts.\+c@{Xts.\+c}}
\subsubsection{\texorpdfstring{Encrypt\+Buffer\+X\+T\+S()}{EncryptBufferXTS()}}
{\footnotesize\ttfamily void Encrypt\+Buffer\+X\+TS (\begin{DoxyParamCaption}\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{buffer,  }\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT}}]{length,  }\item[{const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$}]{start\+Data\+Unit\+No,  }\item[{unsigned int}]{start\+Cipher\+Block\+No,  }\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{ks,  }\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{ks2,  }\item[{int}]{cipher }\end{DoxyParamCaption})}



length\+: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cipher block size ks\+: the primary key schedule ks2\+: the secondary key schedule start\+Data\+Unit\+No\+: The sequential number of the data unit with which the buffer starts. start\+Cipher\+Block\+No\+: The sequential number of the first plaintext block to encrypt inside the data unit start\+Data\+Unit\+No. When encrypting the data unit from its first block, start\+Cipher\+Block\+No is 0. The start\+Cipher\+Block\+No value applies only to the first data unit in the buffer; each successive data unit is encrypted from its first block. The start of the buffer does not have to be aligned with the start of a data unit. If it is aligned, start\+Cipher\+Block\+No must be 0; if it is not aligned, start\+Cipher\+Block\+No must reflect the misalignment accordingly. 

Copyright (c) 2008-\/2010 True\+Crypt Developers Association. All rights reserved.

Governed by the True\+Crypt License 3.\+0 the full text of which is contained in the file License.\+txt included in True\+Crypt binary and source code distribution packages.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ buffer \\
\hline
\mbox{\tt in}  & {\em G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT} & length \\
\hline
\mbox{\tt in}  & {\em const} & \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$ start\+Data\+Unit\+No \\
\hline
\mbox{\tt in}  & {\em unsigned} & int start\+Cipher\+Block\+No \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ ks \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ ks2 \\
\hline
\mbox{\tt in}  & {\em int} & cipher \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_xts_8c_aad9147213002ffaa3c0450853005e646_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_xts_8c_af9db6f7d5ac83732ee40cfdf0ca69e16}\label{_xts_8c_af9db6f7d5ac83732ee40cfdf0ca69e16}} 
\index{Xts.\+c@{Xts.\+c}!Encrypt\+Buffer\+X\+T\+S8\+Byte@{Encrypt\+Buffer\+X\+T\+S8\+Byte}}
\index{Encrypt\+Buffer\+X\+T\+S8\+Byte@{Encrypt\+Buffer\+X\+T\+S8\+Byte}!Xts.\+c@{Xts.\+c}}
\subsubsection{\texorpdfstring{Encrypt\+Buffer\+X\+T\+S8\+Byte()}{EncryptBufferXTS8Byte()}}
{\footnotesize\ttfamily void Encrypt\+Buffer\+X\+T\+S8\+Byte (\begin{DoxyParamCaption}\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{buffer,  }\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT}}]{length,  }\item[{const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$}]{start\+Data\+Unit\+No,  }\item[{unsigned int}]{start\+Cipher\+Block\+No,  }\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{ks,  }\item[{unsigned \+\_\+\+\_\+int8 $\ast$}]{ks2,  }\item[{int}]{cipher }\end{DoxyParamCaption})}



The goal is to switch some byte of a encrypted data with the next encrypted data. This doesn\textquotesingle{}t hurt the algorithm security and add a switching parameter to the encryption. On a 32-\/byte data it switches data with another block of data Then encrypt it. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ buffer \\
\hline
\mbox{\tt in}  & {\em G\+S\+T\+\_\+\+L\+A\+R\+G\+E\+S\+T\+\_\+\+C\+O\+M\+P\+I\+L\+E\+R\+\_\+\+U\+I\+NT} & length \\
\hline
\mbox{\tt in}  & {\em const} & \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$ start\+Data\+Unit\+No \\
\hline
\mbox{\tt in}  & {\em unsigned} & int start\+Cipher\+Block\+No \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ ks \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int8 $\ast$ ks2 \\
\hline
\mbox{\tt in}  & {\em int} & cipher \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_xts_8c_af9db6f7d5ac83732ee40cfdf0ca69e16_icgraph}
\end{center}
\end{figure}
