\hypertarget{_tests_8c}{}\section{Common/\+Tests.c File Reference}
\label{_tests_8c}\index{Common/\+Tests.\+c@{Common/\+Tests.\+c}}


Define some fake data to encrypt where we know the results then encrypt them to test all the algorithm on the installed machine. The file defines the function that will test.  


{\ttfamily \#include \char`\"{}Gstdefs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Crc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Common/\+Endian.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Tests.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Xts.\+h\char`\"{}}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}Pkcs5.\+h\char`\"{}}\newline
Include dependency graph for Tests.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_x_t_s___t_e_s_t}{X\+T\+S\+\_\+\+T\+E\+ST}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_tests_8c_ad5f017aff0060a12802d71b7dfb7a376}\label{_tests_8c_ad5f017aff0060a12802d71b7dfb7a376}} 
\#define {\bfseries X\+T\+S\+\_\+\+T\+E\+S\+T\+\_\+\+C\+O\+U\+NT}~5
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_tests_8c_ad617523ccc7cb2ef8df5cbeefd26b68c}{Cipher\+Init2} (int cipher, void $\ast$key, void $\ast$ks, int key\+\_\+len)
\begin{DoxyCompactList}\small\item\em Init the key and ciphers depending the cipher value. \end{DoxyCompactList}\item 
void \hyperlink{_tests_8c_a84ce3754a4463f9d2281cfabafb0b779}{Test\+C\+R\+Cs} (char $\ast$buf)
\begin{DoxyCompactList}\small\item\em Test the stribog algorithm. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_tests_8c_a9f2eb67594414b8bea27e345fc69fdef}{Test\+Sector\+Buf\+Encryption} (\hyperlink{struct_c_r_y_p_t_o___i_n_f_o__t}{P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO} ci)
\begin{DoxyCompactList}\small\item\em Encrypt same value of data to test if the encryption algorithm woks well. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_tests_8c_a56d230d77b34ccd318135fbaeee388f1}{Test\+Legacy\+Sector\+Buf\+Encryption} (\hyperlink{struct_c_r_y_p_t_o___i_n_f_o__t}{P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO} ci)
\begin{DoxyCompactList}\small\item\em Test the legacy mode for boot encryption. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_tests_8c_a3419657af70c95047111e21b37a484b7}{Auto\+Test\+Algorithms} (void)
\begin{DoxyCompactList}\small\item\em Launch the auto test algorithm before Enable\+Hw\+Encryption and after setting it. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_tests_8c_af13a8c116ddf948cb0a505ffe5d84657}{test\+\_\+hmac\+\_\+whirlpool} ()
\begin{DoxyCompactList}\small\item\em Test the whirpool with algorithm. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_tests_8c_ae410069dfc9af368167a9b60860e68c5}{test\+\_\+hmac\+\_\+gosthash} ()
\begin{DoxyCompactList}\small\item\em Test the gosthash. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_tests_8c_a404584bd0f9ebbd806d2012b00d543b0}{test\+\_\+hmac\+\_\+stribog} ()
\begin{DoxyCompactList}\small\item\em Test the stribog algorithm. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_tests_8c_a7dca7b0d4c13132eeef1cccbc09cd9e3}{test\+\_\+pkcs5} ()
\begin{DoxyCompactList}\small\item\em Test the whole pkcs5. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_tests_8c_a1faa20c31c7bdc0a34ad1f5c07b22cc8}\label{_tests_8c_a1faa20c31c7bdc0a34ad1f5c07b22cc8}} 
\hyperlink{struct_x_t_s___t_e_s_t}{X\+T\+S\+\_\+\+T\+E\+ST} {\bfseries X\+T\+S\+\_\+vectors} \mbox{[}X\+T\+S\+\_\+\+T\+E\+S\+T\+\_\+\+C\+O\+U\+NT\mbox{]}
\item 
char $\ast$ {\bfseries hmac\+\_\+whirlpool\+\_\+test\+\_\+key}
\item 
char $\ast$ {\bfseries hmac\+\_\+whirlpool\+\_\+test\+\_\+data}
\item 
char $\ast$ {\bfseries hmac\+\_\+whirlpool\+\_\+test\+\_\+vectors}
\item 
char $\ast$ {\bfseries hmac\+\_\+gosthash\+\_\+test\+\_\+key}
\item 
char $\ast$ {\bfseries hmac\+\_\+gosthash\+\_\+test\+\_\+data}
\item 
char $\ast$ {\bfseries hmac\+\_\+gosthash\+\_\+test\+\_\+vectors}
\item 
char $\ast$ {\bfseries hmac\+\_\+stribog\+\_\+test\+\_\+key}
\item 
char $\ast$ {\bfseries hmac\+\_\+stribog\+\_\+test\+\_\+data}
\item 
char $\ast$ {\bfseries hmac\+\_\+stribog\+\_\+test\+\_\+vectors}
\item 
\mbox{\Hypertarget{_tests_8c_a6719c16548a84ab3a861dfc0aeb5d898}\label{_tests_8c_a6719c16548a84ab3a861dfc0aeb5d898}} 
unsigned char {\bfseries ks\+\_\+tmp} \mbox{[}M\+A\+X\+\_\+\+E\+X\+P\+A\+N\+D\+E\+D\+\_\+\+K\+EY\mbox{]}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Define some fake data to encrypt where we know the results then encrypt them to test all the algorithm on the installed machine. The file defines the function that will test. 

\begin{DoxyVersion}{Version}
1.\+3.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
16/12/2016 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{_tests_8c_a3419657af70c95047111e21b37a484b7}\label{_tests_8c_a3419657af70c95047111e21b37a484b7}} 
\index{Tests.\+c@{Tests.\+c}!Auto\+Test\+Algorithms@{Auto\+Test\+Algorithms}}
\index{Auto\+Test\+Algorithms@{Auto\+Test\+Algorithms}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{Auto\+Test\+Algorithms()}{AutoTestAlgorithms()}}
{\footnotesize\ttfamily B\+O\+OL Auto\+Test\+Algorithms (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Launch the auto test algorithm before Enable\+Hw\+Encryption and after setting it. 

\begin{DoxyReturn}{Returns}
B\+O\+OL result 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{_tests_8c_a3419657af70c95047111e21b37a484b7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{_tests_8c_a3419657af70c95047111e21b37a484b7_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_tests_8c_ad617523ccc7cb2ef8df5cbeefd26b68c}\label{_tests_8c_ad617523ccc7cb2ef8df5cbeefd26b68c}} 
\index{Tests.\+c@{Tests.\+c}!Cipher\+Init2@{Cipher\+Init2}}
\index{Cipher\+Init2@{Cipher\+Init2}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{Cipher\+Init2()}{CipherInit2()}}
{\footnotesize\ttfamily Cipher\+Init2 (\begin{DoxyParamCaption}\item[{int}]{cipher,  }\item[{void $\ast$}]{key,  }\item[{void $\ast$}]{ks,  }\item[{int}]{key\+\_\+len }\end{DoxyParamCaption})}



Init the key and ciphers depending the cipher value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & cipher \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ key \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ ks \\
\hline
\mbox{\tt in}  & {\em int} & key\+\_\+len \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c_ad617523ccc7cb2ef8df5cbeefd26b68c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_tests_8c_ae410069dfc9af368167a9b60860e68c5}\label{_tests_8c_ae410069dfc9af368167a9b60860e68c5}} 
\index{Tests.\+c@{Tests.\+c}!test\+\_\+hmac\+\_\+gosthash@{test\+\_\+hmac\+\_\+gosthash}}
\index{test\+\_\+hmac\+\_\+gosthash@{test\+\_\+hmac\+\_\+gosthash}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{test\+\_\+hmac\+\_\+gosthash()}{test\_hmac\_gosthash()}}
{\footnotesize\ttfamily B\+O\+OL test\+\_\+hmac\+\_\+gosthash (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Test the gosthash. 

\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (memcmp (digest, hmac\+\_\+gosthash\+\_\+test\+\_\+vectors, G\+O\+S\+T\+H\+A\+S\+H\+\_\+\+D\+I\+G\+E\+S\+T\+S\+I\+ZE) != 0) T\+R\+UE otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c_ae410069dfc9af368167a9b60860e68c5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=288pt]{_tests_8c_ae410069dfc9af368167a9b60860e68c5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_tests_8c_a404584bd0f9ebbd806d2012b00d543b0}\label{_tests_8c_a404584bd0f9ebbd806d2012b00d543b0}} 
\index{Tests.\+c@{Tests.\+c}!test\+\_\+hmac\+\_\+stribog@{test\+\_\+hmac\+\_\+stribog}}
\index{test\+\_\+hmac\+\_\+stribog@{test\+\_\+hmac\+\_\+stribog}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{test\+\_\+hmac\+\_\+stribog()}{test\_hmac\_stribog()}}
{\footnotesize\ttfamily B\+O\+OL test\+\_\+hmac\+\_\+stribog (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Test the stribog algorithm. 

\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (memcmp (digest, hmac\+\_\+stribog\+\_\+test\+\_\+vectors, S\+T\+R\+I\+B\+O\+G\+\_\+\+D\+I\+G\+E\+S\+T\+S\+I\+ZE) != 0) T\+R\+UE otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=278pt]{_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_tests_8c_af13a8c116ddf948cb0a505ffe5d84657}\label{_tests_8c_af13a8c116ddf948cb0a505ffe5d84657}} 
\index{Tests.\+c@{Tests.\+c}!test\+\_\+hmac\+\_\+whirlpool@{test\+\_\+hmac\+\_\+whirlpool}}
\index{test\+\_\+hmac\+\_\+whirlpool@{test\+\_\+hmac\+\_\+whirlpool}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{test\+\_\+hmac\+\_\+whirlpool()}{test\_hmac\_whirlpool()}}
{\footnotesize\ttfamily B\+O\+OL test\+\_\+hmac\+\_\+whirlpool (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Test the whirpool with algorithm. 

\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (memcmp (digest, hmac\+\_\+whirlpool\+\_\+test\+\_\+vectors, W\+H\+I\+R\+L\+P\+O\+O\+L\+\_\+\+D\+I\+G\+E\+S\+T\+S\+I\+ZE) != 0) T\+R\+UE otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=304pt]{_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=286pt]{_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_tests_8c_a7dca7b0d4c13132eeef1cccbc09cd9e3}\label{_tests_8c_a7dca7b0d4c13132eeef1cccbc09cd9e3}} 
\index{Tests.\+c@{Tests.\+c}!test\+\_\+pkcs5@{test\+\_\+pkcs5}}
\index{test\+\_\+pkcs5@{test\+\_\+pkcs5}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{test\+\_\+pkcs5()}{test\_pkcs5()}}
{\footnotesize\ttfamily B\+O\+OL test\+\_\+pkcs5 (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Test the whole pkcs5. 

\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (\hyperlink{_tests_8c_af13a8c116ddf948cb0a505ffe5d84657}{test\+\_\+hmac\+\_\+whirlpool()} == F\+A\+L\+SE) F\+A\+L\+SE if (\hyperlink{_tests_8c_ae410069dfc9af368167a9b60860e68c5}{test\+\_\+hmac\+\_\+gosthash()} == F\+A\+L\+SE) F\+A\+L\+SE if (\hyperlink{_tests_8c_a404584bd0f9ebbd806d2012b00d543b0}{test\+\_\+hmac\+\_\+stribog()} == F\+A\+L\+SE) F\+A\+L\+SE if (memcmp (dk, \char`\"{}\textbackslash{}x50\textbackslash{}x7c\textbackslash{}x36\textbackslash{}x6f\char`\"{}, 4) != 0) F\+A\+L\+SE if if (memcmp (dk, \char`\"{}\textbackslash{}x50\textbackslash{}x7c\textbackslash{}x36\textbackslash{}x6f\textbackslash{}xee\textbackslash{}x10\textbackslash{}x2e\textbackslash{}x9a\textbackslash{}xe2\textbackslash{}x8a\textbackslash{}xd5\textbackslash{}x82\textbackslash{}x72\textbackslash{}x7d\textbackslash{}x27\textbackslash{}x0f\textbackslash{}xe8\textbackslash{}x4d\textbackslash{}x7f\textbackslash{}x68\textbackslash{}x7a\textbackslash{}xcf\textbackslash{}xb5\textbackslash{}xe7\textbackslash{}x43\textbackslash{}x67\textbackslash{}xaa\textbackslash{}x98\textbackslash{}x93\textbackslash{}x52\textbackslash{}x2b\textbackslash{}x09\textbackslash{}x6e\textbackslash{}x42\textbackslash{}xdf\textbackslash{}x2c\textbackslash{}x59\textbackslash{}x4a\textbackslash{}x91\textbackslash{}x6d\textbackslash{}x7e\textbackslash{}x10\textbackslash{}xae\textbackslash{}xb2\textbackslash{}x1a\textbackslash{}x89\textbackslash{}x8f\textbackslash{}xb9\textbackslash{}x8f\textbackslash{}xe6\textbackslash{}x31\textbackslash{}xa9\textbackslash{}xd8\textbackslash{}x9f\textbackslash{}x98\textbackslash{}x26\textbackslash{}xf4\textbackslash{}xda\textbackslash{}xcd\textbackslash{}x7d\textbackslash{}x65\textbackslash{}x65\textbackslash{}xde\textbackslash{}x10\textbackslash{}x95\textbackslash{}x91\textbackslash{}xb4\textbackslash{}x84\textbackslash{}x26\textbackslash{}xae\textbackslash{}x43\textbackslash{}xa1\textbackslash{}x00\textbackslash{}x5b\textbackslash{}x1e\textbackslash{}xb8\textbackslash{}x38\textbackslash{}x97\textbackslash{}xa4\textbackslash{}x1e\textbackslash{}x4b\textbackslash{}xd2\textbackslash{}x65\textbackslash{}x64\textbackslash{}xbc\textbackslash{}xfa\textbackslash{}x1f\textbackslash{}x35\textbackslash{}x85\textbackslash{}xdb\textbackslash{}x4f\textbackslash{}x97\textbackslash{}x65\textbackslash{}x6f\textbackslash{}xbd\textbackslash{}x24\char`\"{}, 96) != 0) F\+A\+L\+SE if (memcmp (dk, \char`\"{}\textbackslash{}x7d\textbackslash{}x53\textbackslash{}xe0\textbackslash{}x7e\char`\"{}, 4) != 0) F\+A\+L\+SE if (memcmp (dk, \char`\"{}\textbackslash{}xc7\textbackslash{}x13\textbackslash{}x56\textbackslash{}xb6\char`\"{}, 4) != 0) T\+R\+UE otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c_a7dca7b0d4c13132eeef1cccbc09cd9e3_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_tests_8c_a84ce3754a4463f9d2281cfabafb0b779}\label{_tests_8c_a84ce3754a4463f9d2281cfabafb0b779}} 
\index{Tests.\+c@{Tests.\+c}!Test\+C\+R\+Cs@{Test\+C\+R\+Cs}}
\index{Test\+C\+R\+Cs@{Test\+C\+R\+Cs}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{Test\+C\+R\+Cs()}{TestCRCs()}}
{\footnotesize\ttfamily void Test\+C\+R\+Cs (\begin{DoxyParamCaption}\item[{char $\ast$}]{buf }\end{DoxyParamCaption})}



Test the stribog algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em char} & $\ast$ buf \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c_a84ce3754a4463f9d2281cfabafb0b779_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_tests_8c_a56d230d77b34ccd318135fbaeee388f1}\label{_tests_8c_a56d230d77b34ccd318135fbaeee388f1}} 
\index{Tests.\+c@{Tests.\+c}!Test\+Legacy\+Sector\+Buf\+Encryption@{Test\+Legacy\+Sector\+Buf\+Encryption}}
\index{Test\+Legacy\+Sector\+Buf\+Encryption@{Test\+Legacy\+Sector\+Buf\+Encryption}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{Test\+Legacy\+Sector\+Buf\+Encryption()}{TestLegacySectorBufEncryption()}}
{\footnotesize\ttfamily B\+O\+OL Test\+Legacy\+Sector\+Buf\+Encryption (\begin{DoxyParamCaption}\item[{\hyperlink{struct_c_r_y_p_t_o___i_n_f_o__t}{P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO}}]{ci }\end{DoxyParamCaption})}



Test the legacy mode for boot encryption. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO} & ci \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (crc == 0xb70b4c26) F\+A\+L\+SE if (E\+A\+Init (ci-\/$>$ea, (unsigned char $\ast$)buf, ci-\/$>$ks) == E\+R\+R\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+I\+N\+I\+T\+\_\+\+F\+A\+I\+L\+U\+RE) F\+A\+L\+SE if (Get\+Crc32 (buf, sizeof (buf)) != 0xb70b4c26) F\+A\+L\+SE if (crc == 0xb70b4c26) 1 otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c_a56d230d77b34ccd318135fbaeee388f1_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c_a56d230d77b34ccd318135fbaeee388f1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_tests_8c_a9f2eb67594414b8bea27e345fc69fdef}\label{_tests_8c_a9f2eb67594414b8bea27e345fc69fdef}} 
\index{Tests.\+c@{Tests.\+c}!Test\+Sector\+Buf\+Encryption@{Test\+Sector\+Buf\+Encryption}}
\index{Test\+Sector\+Buf\+Encryption@{Test\+Sector\+Buf\+Encryption}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{Test\+Sector\+Buf\+Encryption()}{TestSectorBufEncryption()}}
{\footnotesize\ttfamily B\+O\+OL Test\+Sector\+Buf\+Encryption (\begin{DoxyParamCaption}\item[{\hyperlink{struct_c_r_y_p_t_o___i_n_f_o__t}{P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO}}]{ci }\end{DoxyParamCaption})}



Encrypt same value of data to test if the encryption algorithm woks well. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO} & ci \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (!\+Test\+Legacy\+Sector\+Buf\+Encryption(ci)) F\+A\+L\+SE if (E\+A\+Init(ci-\/$>$ea, key1, ci-\/$>$ks) != E\+R\+R\+\_\+\+S\+U\+C\+C\+E\+SS) F\+A\+L\+SE if (!\+E\+A\+Init\+Mode(ci)) F\+A\+L\+SE if (crc != 0x05eacf7d) F\+A\+L\+SE if (crc != 0x5b5926d9) F\+A\+L\+SE if (crc != 0xcf0cfdd1) F\+A\+L\+SE if (crc != 0xe82865a8) F\+A\+L\+SE if (crc == 0x9f5edd58) F\+A\+L\+SE if (Get\+Crc32(buf, sizeof (buf)) != 0x9f5edd58) F\+A\+L\+SE if (E\+A\+Init(ci-\/$>$ea, key1, ci-\/$>$ks) != E\+R\+R\+\_\+\+S\+U\+C\+C\+E\+SS) F\+A\+L\+SE if (!\+E\+A\+Init\+Mode(ci)) F\+A\+L\+SE if (crc != 0x5d31eec2) F\+A\+L\+SE if (crc == 0x9f5edd58) 1 otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_tests_8c_a9f2eb67594414b8bea27e345fc69fdef_cgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{_tests_8c_a3b88dcf8e71277fea9baec941511ee14}\label{_tests_8c_a3b88dcf8e71277fea9baec941511ee14}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+gosthash\+\_\+test\+\_\+data@{hmac\+\_\+gosthash\+\_\+test\+\_\+data}}
\index{hmac\+\_\+gosthash\+\_\+test\+\_\+data@{hmac\+\_\+gosthash\+\_\+test\+\_\+data}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+gosthash\+\_\+test\+\_\+data}{hmac\_gosthash\_test\_data}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+gosthash\+\_\+test\+\_\+data}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq"}
\}
\end{DoxyCode}
\mbox{\Hypertarget{_tests_8c_ac77596640668b0c0890b99ef15924f04}\label{_tests_8c_ac77596640668b0c0890b99ef15924f04}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+gosthash\+\_\+test\+\_\+key@{hmac\+\_\+gosthash\+\_\+test\+\_\+key}}
\index{hmac\+\_\+gosthash\+\_\+test\+\_\+key@{hmac\+\_\+gosthash\+\_\+test\+\_\+key}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+gosthash\+\_\+test\+\_\+key}{hmac\_gosthash\_test\_key}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+gosthash\+\_\+test\+\_\+key}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"\(\backslash\)x00\(\backslash\)x11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF\(\backslash\)x01\(\backslash\)x23\(\backslash\)x45\(\backslash\)x67\(\backslash\)x89\(\backslash\)xAB\(\backslash\)xCD\(\backslash\)xEF\(\backslash\)x00\(\backslash\)x
      11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF\(\backslash\)x01\(\backslash\)x23\(\backslash\)x45\(\backslash\)x67\(\backslash\)x89\(\backslash\)xAB\(\backslash\)xCD\(\backslash\)xEF\(\backslash\)x00\(\backslash\)x11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x
      44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF"}
\}
\end{DoxyCode}
\mbox{\Hypertarget{_tests_8c_aba879dbba59727a77a6e5b43cb8a690c}\label{_tests_8c_aba879dbba59727a77a6e5b43cb8a690c}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+gosthash\+\_\+test\+\_\+vectors@{hmac\+\_\+gosthash\+\_\+test\+\_\+vectors}}
\index{hmac\+\_\+gosthash\+\_\+test\+\_\+vectors@{hmac\+\_\+gosthash\+\_\+test\+\_\+vectors}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+gosthash\+\_\+test\+\_\+vectors}{hmac\_gosthash\_test\_vectors}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+gosthash\+\_\+test\+\_\+vectors}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"\(\backslash\)x52\(\backslash\)x35\(\backslash\)xb7\(\backslash\)x17\(\backslash\)x56\(\backslash\)xb8\(\backslash\)x75\(\backslash\)x21\(\backslash\)xca\(\backslash\)xe9\(\backslash\)x52\(\backslash\)x9b\(\backslash\)x21\(\backslash\)x97\(\backslash\)x3e\(\backslash\)x6d\(\backslash\)x4e\(\backslash\)x54\(\backslash\)x12\(\backslash\)xfc\(\backslash\)x61\(\backslash\)x70\(\backslash\)x40\(\backslash\)xfa\(\backslash\)x46\(\backslash\)x
      4c\(\backslash\)xf7\(\backslash\)x24\(\backslash\)x9d\(\backslash\)x28\(\backslash\)xde\(\backslash\)x1d"}
    
\}
\end{DoxyCode}
\mbox{\Hypertarget{_tests_8c_a6e4a4d015489f4e28ae426670238f2d2}\label{_tests_8c_a6e4a4d015489f4e28ae426670238f2d2}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+stribog\+\_\+test\+\_\+data@{hmac\+\_\+stribog\+\_\+test\+\_\+data}}
\index{hmac\+\_\+stribog\+\_\+test\+\_\+data@{hmac\+\_\+stribog\+\_\+test\+\_\+data}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+stribog\+\_\+test\+\_\+data}{hmac\_stribog\_test\_data}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+stribog\+\_\+test\+\_\+data}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq"}
\}
\end{DoxyCode}
\mbox{\Hypertarget{_tests_8c_a30ff4e64859229aa28cb73fb13a69d75}\label{_tests_8c_a30ff4e64859229aa28cb73fb13a69d75}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+stribog\+\_\+test\+\_\+key@{hmac\+\_\+stribog\+\_\+test\+\_\+key}}
\index{hmac\+\_\+stribog\+\_\+test\+\_\+key@{hmac\+\_\+stribog\+\_\+test\+\_\+key}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+stribog\+\_\+test\+\_\+key}{hmac\_stribog\_test\_key}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+stribog\+\_\+test\+\_\+key}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"\(\backslash\)x00\(\backslash\)x11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF\(\backslash\)x01\(\backslash\)x23\(\backslash\)x45\(\backslash\)x67\(\backslash\)x89\(\backslash\)xAB\(\backslash\)xCD\(\backslash\)xEF\(\backslash\)x00\(\backslash\)x
      11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF\(\backslash\)x01\(\backslash\)x23\(\backslash\)x45\(\backslash\)x67\(\backslash\)x89\(\backslash\)xAB\(\backslash\)xCD\(\backslash\)xEF\(\backslash\)x00\(\backslash\)x11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x
      44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF"}
\}
\end{DoxyCode}
\mbox{\Hypertarget{_tests_8c_ac5136b9069100f9dee7b10ea1fcf15f7}\label{_tests_8c_ac5136b9069100f9dee7b10ea1fcf15f7}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+stribog\+\_\+test\+\_\+vectors@{hmac\+\_\+stribog\+\_\+test\+\_\+vectors}}
\index{hmac\+\_\+stribog\+\_\+test\+\_\+vectors@{hmac\+\_\+stribog\+\_\+test\+\_\+vectors}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+stribog\+\_\+test\+\_\+vectors}{hmac\_stribog\_test\_vectors}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+stribog\+\_\+test\+\_\+vectors}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"\(\backslash\)x74\(\backslash\)x8a\(\backslash\)x64\(\backslash\)x94\(\backslash\)xb8\(\backslash\)x34\(\backslash\)xbd\(\backslash\)x72\(\backslash\)x95\(\backslash\)xa2\(\backslash\)x3b\(\backslash\)x11\(\backslash\)x86\(\backslash\)x1d\(\backslash\)x46\(\backslash\)xe7\(\backslash\)x88\(\backslash\)x0f\(\backslash\)x65\(\backslash\)x98\(\backslash\)xd3\(\backslash\)x54\(\backslash\)xe1\(\backslash\)xb2\(\backslash\)x4a\(\backslash\)x
      35\(\backslash\)xc2\(\backslash\)xa2\(\backslash\)x85\(\backslash\)x41\(\backslash\)x08\(\backslash\)x85\(\backslash\)x07\(\backslash\)xc8\(\backslash\)x52\(\backslash\)x51\(\backslash\)x36\(\backslash\)x26\(\backslash\)xd2\(\backslash\)x8c\(\backslash\)x38\(\backslash\)xe5\(\backslash\)x55\(\backslash\)x9e\(\backslash\)xd2\(\backslash\)x1b\(\backslash\)x88\(\backslash\)x2b\(\backslash\)x2b\(\backslash\)x37\(\backslash\)xae\(\backslash\)x87\(\backslash\)x
      11\(\backslash\)x1a\(\backslash\)x37\(\backslash\)xe4\(\backslash\)xb1\(\backslash\)x88\(\backslash\)xd3\(\backslash\)xd7\(\backslash\)x8c\(\backslash\)x9f\(\backslash\)xef\(\backslash\)x1b"}
\}
\end{DoxyCode}
\mbox{\Hypertarget{_tests_8c_a845192a8755185349a6afd1aa5142cc2}\label{_tests_8c_a845192a8755185349a6afd1aa5142cc2}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+whirlpool\+\_\+test\+\_\+data@{hmac\+\_\+whirlpool\+\_\+test\+\_\+data}}
\index{hmac\+\_\+whirlpool\+\_\+test\+\_\+data@{hmac\+\_\+whirlpool\+\_\+test\+\_\+data}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+whirlpool\+\_\+test\+\_\+data}{hmac\_whirlpool\_test\_data}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+whirlpool\+\_\+test\+\_\+data}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq"}
\}
\end{DoxyCode}
\mbox{\Hypertarget{_tests_8c_a865ecd2f8e4cfcb4a49e422097ac494e}\label{_tests_8c_a865ecd2f8e4cfcb4a49e422097ac494e}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+whirlpool\+\_\+test\+\_\+key@{hmac\+\_\+whirlpool\+\_\+test\+\_\+key}}
\index{hmac\+\_\+whirlpool\+\_\+test\+\_\+key@{hmac\+\_\+whirlpool\+\_\+test\+\_\+key}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+whirlpool\+\_\+test\+\_\+key}{hmac\_whirlpool\_test\_key}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+whirlpool\+\_\+test\+\_\+key}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"\(\backslash\)x00\(\backslash\)x11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF\(\backslash\)x01\(\backslash\)x23\(\backslash\)x45\(\backslash\)x67\(\backslash\)x89\(\backslash\)xAB\(\backslash\)xCD\(\backslash\)xEF\(\backslash\)x00\(\backslash\)x
      11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF\(\backslash\)x01\(\backslash\)x23\(\backslash\)x45\(\backslash\)x67\(\backslash\)x89\(\backslash\)xAB\(\backslash\)xCD\(\backslash\)xEF\(\backslash\)x00\(\backslash\)x11\(\backslash\)x22\(\backslash\)x33\(\backslash\)x
      44\(\backslash\)x55\(\backslash\)x66\(\backslash\)x77\(\backslash\)x88\(\backslash\)x99\(\backslash\)xAA\(\backslash\)xBB\(\backslash\)xCC\(\backslash\)xDD\(\backslash\)xEE\(\backslash\)xFF"}
\}
\end{DoxyCode}
\mbox{\Hypertarget{_tests_8c_a8469e44c5aa501e8a1be310685f27b29}\label{_tests_8c_a8469e44c5aa501e8a1be310685f27b29}} 
\index{Tests.\+c@{Tests.\+c}!hmac\+\_\+whirlpool\+\_\+test\+\_\+vectors@{hmac\+\_\+whirlpool\+\_\+test\+\_\+vectors}}
\index{hmac\+\_\+whirlpool\+\_\+test\+\_\+vectors@{hmac\+\_\+whirlpool\+\_\+test\+\_\+vectors}!Tests.\+c@{Tests.\+c}}
\subsubsection{\texorpdfstring{hmac\+\_\+whirlpool\+\_\+test\+\_\+vectors}{hmac\_whirlpool\_test\_vectors}}
{\footnotesize\ttfamily char$\ast$ hmac\+\_\+whirlpool\+\_\+test\+\_\+vectors}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
    \textcolor{stringliteral}{"\(\backslash\)x03\(\backslash\)x91\(\backslash\)xd2\(\backslash\)x80\(\backslash\)x00\(\backslash\)xb6\(\backslash\)x62\(\backslash\)xbb\(\backslash\)xb8\(\backslash\)xe6\(\backslash\)x23\(\backslash\)x3e\(\backslash\)xe8\(\backslash\)x6c\(\backslash\)xf2\(\backslash\)xb2\(\backslash\)x84\(\backslash\)x74\(\backslash\)x4c\(\backslash\)x73"}
    \textcolor{stringliteral}{"\(\backslash\)x8b\(\backslash\)x58\(\backslash\)x00\(\backslash\)xba\(\backslash\)x28\(\backslash\)x12\(\backslash\)xed\(\backslash\)x52\(\backslash\)x6f\(\backslash\)xe3\(\backslash\)x15\(\backslash\)x3a\(\backslash\)xb1\(\backslash\)xba\(\backslash\)xe7\(\backslash\)xe2\(\backslash\)x36\(\backslash\)xbe\(\backslash\)x96\(\backslash\)x54"}
    \textcolor{stringliteral}{"\(\backslash\)x49\(\backslash\)x3f\(\backslash\)x19\(\backslash\)xfa\(\backslash\)xce\(\backslash\)xa6\(\backslash\)x44\(\backslash\)x1f\(\backslash\)x60\(\backslash\)xf5\(\backslash\)xf0\(\backslash\)x18\(\backslash\)x93\(\backslash\)x09\(\backslash\)x11\(\backslash\)xa5\(\backslash\)xe5\(\backslash\)xce\(\backslash\)xd8\(\backslash\)xf2"}
    \textcolor{stringliteral}{"\(\backslash\)x6a\(\backslash\)xbf\(\backslash\)xa4\(\backslash\)x02"}
\}
\end{DoxyCode}
