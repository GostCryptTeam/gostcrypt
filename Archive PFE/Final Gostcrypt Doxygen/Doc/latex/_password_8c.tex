\hypertarget{_password_8c}{}\section{Common/\+Password.c File Reference}
\label{_password_8c}\index{Common/\+Password.\+c@{Common/\+Password.\+c}}


Manage the basic checks and actions on the password such as creating / modifying checking length and encoding.  


{\ttfamily \#include \char`\"{}Gstdefs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Volumes.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Password.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Dlgcode.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Language.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Pkcs5.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Endian.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Random.\+h\char`\"{}}\newline
{\ttfamily \#include $<$io.\+h$>$}\newline
Include dependency graph for Password.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_password_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_password_8c_a523488d13475ba45022f7fab8e01d047}{Verify\+Password\+And\+Update} (H\+W\+ND hwnd\+Dlg, H\+W\+ND h\+Button, H\+W\+ND h\+Password, H\+W\+ND h\+Verify, unsigned char $\ast$sz\+Password, char $\ast$sz\+Verify, B\+O\+OL key\+Files\+Enabled)
\begin{DoxyCompactList}\small\item\em Verify the password value (minimum size and repeated is equal) when the user enter it for the first time to protect its folder. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_password_8c_a1a8e1c5a24ae447c7af45f2e53973655}{Check\+Password\+Char\+Encoding} (H\+W\+ND h\+Password, \hyperlink{struct_password}{Password} $\ast$ptr\+Pw)
\begin{DoxyCompactList}\small\item\em Check if the password contains A\+S\+C\+II or printable character. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_password_8c_a3aca9dd7f358bffa36046c1709212bea}{Check\+Password\+Length} (H\+W\+ND hwnd\+Dlg, H\+W\+ND hwnd\+Item)
\begin{DoxyCompactList}\small\item\em Check the password length. \end{DoxyCompactList}\item 
int \hyperlink{_password_8c_a572e279b7fade7cdb66f93c09102bb99}{Change\+Pwd} (char $\ast$lpsz\+Volume, \hyperlink{struct_password}{Password} $\ast$old\+Password, \hyperlink{struct_password}{Password} $\ast$new\+Password, int pkcs5, H\+W\+ND hwnd\+Dlg)
\begin{DoxyCompactList}\small\item\em Check the old password. Check all the requirements if the new password fits the rules and the program doesn\textquotesingle{}t have problem. make a copy of teh ciphered area, encrypt the old area with the new password and if the encryption is successful change the password otherwise cancel. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Manage the basic checks and actions on the password such as creating / modifying checking length and encoding. 

\begin{DoxyVersion}{Version}
1.\+3.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
20/01/2017 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{_password_8c_a572e279b7fade7cdb66f93c09102bb99}\label{_password_8c_a572e279b7fade7cdb66f93c09102bb99}} 
\index{Password.\+c@{Password.\+c}!Change\+Pwd@{Change\+Pwd}}
\index{Change\+Pwd@{Change\+Pwd}!Password.\+c@{Password.\+c}}
\subsubsection{\texorpdfstring{Change\+Pwd()}{ChangePwd()}}
{\footnotesize\ttfamily int Change\+Pwd (\begin{DoxyParamCaption}\item[{char $\ast$}]{lpsz\+Volume,  }\item[{\hyperlink{struct_password}{Password} $\ast$}]{old\+Password,  }\item[{\hyperlink{struct_password}{Password} $\ast$}]{new\+Password,  }\item[{int}]{pkcs5,  }\item[{H\+W\+ND}]{hwnd\+Dlg }\end{DoxyParamCaption})}



Check the old password. Check all the requirements if the new password fits the rules and the program doesn\textquotesingle{}t have problem. make a copy of teh ciphered area, encrypt the old area with the new password and if the encryption is successful change the password otherwise cancel. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em H\+W\+ND} & hwnd\+Dlg \\
\hline
\mbox{\tt in}  & {\em int} & pkcs5 \\
\hline
\mbox{\tt in}  & {\em \hyperlink{struct_password}{Password}} & $\ast$ new\+Password \\
\hline
\mbox{\tt in}  & {\em \hyperlink{struct_password}{Password}} & $\ast$ old\+Password \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ lpsz\+Volume \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (n\+Dos\+Link\+Created != 0) E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (dev == I\+N\+V\+A\+L\+I\+D\+\_\+\+H\+A\+N\+D\+L\+E\+\_\+\+V\+A\+L\+UE) E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (b\+Device \&\& (dev == I\+N\+V\+A\+L\+I\+D\+\_\+\+H\+A\+N\+D\+L\+E\+\_\+\+V\+A\+L\+UE)) E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (b\+Device \&\& !(dev == I\+N\+V\+A\+L\+I\+D\+\_\+\+H\+A\+N\+D\+L\+E\+\_\+\+V\+A\+L\+UE) \&\& (!b\+Result)) E\+R\+R\+\_\+\+V\+O\+L\+\_\+\+S\+I\+Z\+E\+\_\+\+W\+R\+O\+NG if (b\+Device \&\& !(dev == I\+N\+V\+A\+L\+I\+D\+\_\+\+H\+A\+N\+D\+L\+E\+\_\+\+V\+A\+L\+UE) \&\& (host\+Size == 0)) E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (!b\+Device \&\& (!\+Get\+File\+Size\+Ex (dev, \&file\+Size)))
\end{DoxyReturn}
E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (Randinit ()) E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (!\+Set\+File\+Pointer\+Ex ((H\+A\+N\+D\+LE) dev, header\+Offset, N\+U\+LL, F\+I\+L\+E\+\_\+\+B\+E\+G\+IN)) E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (!\+Read\+Effective\+Volume\+Header (b\+Device, dev, buffer, \&bytes\+Read)) E\+R\+R\+\_\+\+S\+Y\+S\+\_\+\+H\+I\+D\+V\+O\+L\+\_\+\+H\+E\+A\+D\+\_\+\+R\+E\+E\+N\+C\+\_\+\+M\+O\+D\+E\+\_\+\+W\+R\+O\+NG if (crypto\+Info-\/$>$Header\+Flags \& G\+S\+T\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+L\+A\+G\+\_\+\+E\+N\+C\+R\+Y\+P\+T\+E\+D\+\_\+\+S\+Y\+S\+T\+EM) E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (!\+Set\+File\+Pointer\+Ex ((H\+A\+N\+D\+LE) dev, header\+Offset, N\+U\+LL, F\+I\+L\+E\+\_\+\+B\+E\+G\+IN)) E\+R\+R\+\_\+\+O\+S\+\_\+\+E\+R\+R\+OR if (!\+Write\+Effective\+Volume\+Header (b\+Device, dev, buffer)) Write\+Random\+Data\+To\+Reserved\+Header\+Areas (dev, crypto\+Info, crypto\+Info-\/$>$Volume\+Size.\+Value, !backup\+Header, backup\+Header) if (n\+Status != E\+R\+R\+\_\+\+S\+U\+C\+C\+E\+SS) 0 else The header will be re-\/encrypted P\+R\+A\+N\+D\+\_\+\+D\+I\+S\+K\+\_\+\+W\+I\+P\+E\+\_\+\+P\+A\+S\+S\+ES times to prevent adversaries from using techniques such as magnetic force microscopy or magnetic force scanning tunnelling microscopy to recover the overwritten header. According to Peter Gutmann, data should be overwritten 22 times (ideally, 35 times) using non-\/random patterns and pseudorandom data. However, as users might impatiently interupt the process (etc.) we will not use the Gutmann\textquotesingle{}s patterns but will write the valid re-\/encrypted header, i.\+e. pseudorandom data, and there will be many more passes than Guttman recommends. During each pass we will write a valid working header. Each pass will use the same master key, and also the same header key, secondary key (X\+TS), etc., derived from the new password. The only item that will be different for each pass will be the salt. This is sufficient to cause each \char`\"{}version\char`\"{} of the header to differ substantially and in a random manner from the versions written during the other passes.\mbox{\Hypertarget{_password_8c_a1a8e1c5a24ae447c7af45f2e53973655}\label{_password_8c_a1a8e1c5a24ae447c7af45f2e53973655}} 
\index{Password.\+c@{Password.\+c}!Check\+Password\+Char\+Encoding@{Check\+Password\+Char\+Encoding}}
\index{Check\+Password\+Char\+Encoding@{Check\+Password\+Char\+Encoding}!Password.\+c@{Password.\+c}}
\subsubsection{\texorpdfstring{Check\+Password\+Char\+Encoding()}{CheckPasswordCharEncoding()}}
{\footnotesize\ttfamily B\+O\+OL Check\+Password\+Char\+Encoding (\begin{DoxyParamCaption}\item[{H\+W\+ND}]{h\+Password,  }\item[{\hyperlink{struct_password}{Password} $\ast$}]{ptr\+Pw }\end{DoxyParamCaption})}



Check if the password contains A\+S\+C\+II or printable character. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \hyperlink{struct_password}{Password}} & $\ast$ ptr\+Pw \\
\hline
\mbox{\tt in}  & {\em H\+W\+ND} & h\+Password \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (i $<$ len) F\+A\+L\+SE if (len $>$ M\+A\+X\+\_\+\+P\+A\+S\+S\+W\+O\+RD) F\+A\+L\+SE if (pw\mbox{[}i\mbox{]} $>$= 0x7f $\vert$$\vert$ pw\mbox{[}i\mbox{]} $<$ 0x20) T\+R\+UE else 
\end{DoxyReturn}
\mbox{\Hypertarget{_password_8c_a3aca9dd7f358bffa36046c1709212bea}\label{_password_8c_a3aca9dd7f358bffa36046c1709212bea}} 
\index{Password.\+c@{Password.\+c}!Check\+Password\+Length@{Check\+Password\+Length}}
\index{Check\+Password\+Length@{Check\+Password\+Length}!Password.\+c@{Password.\+c}}
\subsubsection{\texorpdfstring{Check\+Password\+Length()}{CheckPasswordLength()}}
{\footnotesize\ttfamily B\+O\+OL Check\+Password\+Length (\begin{DoxyParamCaption}\item[{H\+W\+ND}]{hwnd\+Dlg,  }\item[{H\+W\+ND}]{hwnd\+Item }\end{DoxyParamCaption})}



Check the password length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em H\+W\+ND} & hwnd\+Item \\
\hline
\mbox{\tt in}  & {\em H\+W\+ND} & hwnd\+Dlg \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (Message\+BoxW (hwnd\+Dlg, Get\+String (\char`\"{}\+P\+A\+S\+S\+W\+O\+R\+D\+\_\+\+L\+E\+N\+G\+T\+H\+\_\+\+W\+A\+R\+N\+I\+N\+G\char`\"{}), lpsz\+Title, M\+B\+\_\+\+Y\+E\+S\+N\+O$\vert$\+M\+B\+\_\+\+I\+C\+O\+N\+W\+A\+R\+N\+I\+N\+G$\vert$\+M\+B\+\_\+\+D\+E\+F\+B\+U\+T\+T\+O\+N2) != I\+D\+Y\+ES) T\+R\+UE else 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=290pt]{_password_8c_a3aca9dd7f358bffa36046c1709212bea_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_password_8c_a523488d13475ba45022f7fab8e01d047}\label{_password_8c_a523488d13475ba45022f7fab8e01d047}} 
\index{Password.\+c@{Password.\+c}!Verify\+Password\+And\+Update@{Verify\+Password\+And\+Update}}
\index{Verify\+Password\+And\+Update@{Verify\+Password\+And\+Update}!Password.\+c@{Password.\+c}}
\subsubsection{\texorpdfstring{Verify\+Password\+And\+Update()}{VerifyPasswordAndUpdate()}}
{\footnotesize\ttfamily void Verify\+Password\+And\+Update (\begin{DoxyParamCaption}\item[{H\+W\+ND}]{hwnd\+Dlg,  }\item[{H\+W\+ND}]{h\+Button,  }\item[{H\+W\+ND}]{h\+Password,  }\item[{H\+W\+ND}]{h\+Verify,  }\item[{unsigned char $\ast$}]{sz\+Password,  }\item[{char $\ast$}]{sz\+Verify,  }\item[{B\+O\+OL}]{key\+Files\+Enabled }\end{DoxyParamCaption})}



Verify the password value (minimum size and repeated is equal) when the user enter it for the first time to protect its folder. 

Legal Notice\+: Some portions of the source code contained in this file were derived from the source code of Encryption for the Masses 2.\+02a, which is Copyright (c) 1998-\/2000 Paul Le Roux and which is governed by the \textquotesingle{}License Agreement for Encryption for the Masses\textquotesingle{}. Modifications and additions to the original source code (contained in this file) and all other portions of this file are Copyright (c) 2003-\/2010 True\+Crypt Developers Association and are governed by the True\+Crypt License 3.\+0 the full text of which is contained in the file License.\+txt included in True\+Crypt binary and source code distribution packages.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em H\+W\+ND} & hwnd\+Dlg \\
\hline
\mbox{\tt in}  & {\em H\+W\+ND} & h\+Button \\
\hline
\mbox{\tt in}  & {\em H\+W\+ND} & h\+Password \\
\hline
\mbox{\tt in}  & {\em H\+W\+ND} & h\+Verify \\
\hline
\mbox{\tt in}  & {\em unsigned} & char $\ast$ sz\+Password \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ sz\+Verify \\
\hline
\mbox{\tt in}  & {\em B\+O\+OL} & key\+Files\+Enabled \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
