\hypertarget{_decompressor_8c}{}\section{Boot/\+Windows/\+Decompressor.c File Reference}
\label{_decompressor_8c}\index{Boot/\+Windows/\+Decompressor.\+c@{Boot/\+Windows/\+Decompressor.\+c}}


Manage Blocks.  


\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structstate}{state}
\item 
struct \hyperlink{structhuffman}{huffman}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local}~static            /$\ast$ for local function definitions $\ast$/
\item 
\mbox{\Hypertarget{_decompressor_8c_a263efce0e5cda1d387a1a43f94715445}\label{_decompressor_8c_a263efce0e5cda1d387a1a43f94715445}} 
\#define {\bfseries N\+IL}~((unsigned char $\ast$)0)        /$\ast$ for no output option $\ast$/
\item 
\mbox{\Hypertarget{_decompressor_8c_a6fcad31e688110d9d61bdcc99b2a59d7}\label{_decompressor_8c_a6fcad31e688110d9d61bdcc99b2a59d7}} 
\#define {\bfseries M\+A\+X\+B\+I\+TS}~15              /$\ast$ maximum \hyperlink{_decompressor_8c_af23433d9d58fb31d4a1ac224e3bc46e8}{bits} in a code $\ast$/
\item 
\mbox{\Hypertarget{_decompressor_8c_a882cea3ad6d6a7b1af23998cca38fff8}\label{_decompressor_8c_a882cea3ad6d6a7b1af23998cca38fff8}} 
\#define {\bfseries M\+A\+X\+L\+C\+O\+D\+ES}~286           /$\ast$ maximum number of literal/length \hyperlink{_decompressor_8c_afce25d8162a22b60b1c6124eeac0e37e}{codes} $\ast$/
\item 
\mbox{\Hypertarget{_decompressor_8c_a1caf3c3995675a37b8db90112ac276bb}\label{_decompressor_8c_a1caf3c3995675a37b8db90112ac276bb}} 
\#define {\bfseries M\+A\+X\+D\+C\+O\+D\+ES}~30            /$\ast$ maximum number of distance \hyperlink{_decompressor_8c_afce25d8162a22b60b1c6124eeac0e37e}{codes} $\ast$/
\item 
\mbox{\Hypertarget{_decompressor_8c_a4b99f94b98defb9b267ea98c2b7ed35b}\label{_decompressor_8c_a4b99f94b98defb9b267ea98c2b7ed35b}} 
\#define {\bfseries M\+A\+X\+C\+O\+D\+ES}~(M\+A\+X\+L\+C\+O\+D\+ES+M\+A\+X\+D\+C\+O\+D\+ES)  /$\ast$ maximum \hyperlink{_decompressor_8c_afce25d8162a22b60b1c6124eeac0e37e}{codes} lengths to read $\ast$/
\item 
\mbox{\Hypertarget{_decompressor_8c_a07f2d271bc15402e50a75a2b580ccb38}\label{_decompressor_8c_a07f2d271bc15402e50a75a2b580ccb38}} 
\#define {\bfseries F\+I\+X\+L\+C\+O\+D\+ES}~288           /$\ast$ number of \hyperlink{_decompressor_8c_af3340594bb80768552b17efb18581c98}{fixed} literal/length \hyperlink{_decompressor_8c_afce25d8162a22b60b1c6124eeac0e37e}{codes} $\ast$/
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int \hyperlink{_decompressor_8c_af23433d9d58fb31d4a1ac224e3bc46e8}{bits} (struct \hyperlink{structstate}{state} $\ast$s, int need)
\begin{DoxyCompactList}\small\item\em Get needed bits. \end{DoxyCompactList}\item 
\hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int \hyperlink{_decompressor_8c_a2c157e80e65abde8e3f64853a41bfecc}{stored} (struct \hyperlink{structstate}{state} $\ast$s)
\begin{DoxyCompactList}\small\item\em Store a block. \end{DoxyCompactList}\item 
\hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int \hyperlink{_decompressor_8c_a25b79328579a3f00f9d7baf16b9d49e9}{decode} (struct \hyperlink{structstate}{state} $\ast$s, struct \hyperlink{structhuffman}{huffman} $\ast$h)
\begin{DoxyCompactList}\small\item\em Decode with huffman faster. \end{DoxyCompactList}\item 
\hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int \hyperlink{_decompressor_8c_aaad3ca7ae854bf9197295c9e3e32db85}{construct} (struct \hyperlink{structhuffman}{huffman} $\ast$h, short $\ast$length, int n)
\begin{DoxyCompactList}\small\item\em build huffman table for code lengths codes \end{DoxyCompactList}\item 
\hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int \hyperlink{_decompressor_8c_afce25d8162a22b60b1c6124eeac0e37e}{codes} (struct \hyperlink{structstate}{state} $\ast$s, struct \hyperlink{structhuffman}{huffman} $\ast$lencode, struct \hyperlink{structhuffman}{huffman} $\ast$distcode)
\begin{DoxyCompactList}\small\item\em Decode data until end-\/of-\/block code. \end{DoxyCompactList}\item 
\hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int \hyperlink{_decompressor_8c_af3340594bb80768552b17efb18581c98}{fixed} (struct \hyperlink{structstate}{state} $\ast$s)
\begin{DoxyCompactList}\small\item\em Build fixed huffman tables if first call. \end{DoxyCompactList}\item 
\hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int \hyperlink{_decompressor_8c_a5f81f35c5fef404a03c7059b39ab45f1}{dynamic} (struct \hyperlink{structstate}{state} $\ast$s)
\begin{DoxyCompactList}\small\item\em Read code lenght, build huffman tables and decode data until end-\/of-\/block code. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{_decompressor_8c_a59abdf40ea627da330da8cdfd69efffb}\label{_decompressor_8c_a59abdf40ea627da330da8cdfd69efffb}} 
void {\bfseries \+\_\+acrtused} ()
\item 
int far \hyperlink{_decompressor_8c_a93747b6f64a7778977983853051e3f90}{main} (unsigned char $\ast$dest, unsigned int destlen, unsigned char $\ast$source)
\begin{DoxyCompactList}\small\item\em Process all blocks or until error. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Manage Blocks. 

\begin{DoxyVersion}{Version}
1.\+3.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
13/12/2016 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}\label{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}} 
\index{Decompressor.\+c@{Decompressor.\+c}!local@{local}}
\index{local@{local}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{local}{local}}
{\footnotesize\ttfamily \#define local~static            /$\ast$ for local function definitions $\ast$/}

puff.\+c Copyright (C) 2002-\/2004 Mark Adler, all rights reserved version 1.\+8, 9 Jan 2004

This software is provided \textquotesingle{}as-\/is\textquotesingle{}, without any express or implied warranty. In no event will the author be held liable for any damages arising from the use of this software.

Permission is granted to anyone to use this software for any purpose, including commercial applications, and to alter it and redistribute it freely, subject to the following restrictions\+:


\begin{DoxyEnumerate}
\item The origin of this software must not be misrepresented; you must not claim that you wrote the original software. If you use this software in a product, an acknowledgment in the product documentation would be appreciated but is not required.
\item Altered source versions must be plainly marked as such, and must not be misrepresented as being the original software.
\item This notice may not be removed or altered from any source distribution.
\end{DoxyEnumerate}

Mark Adler \href{mailto:madler@alumni.caltech.edu}{\tt madler@alumni.\+caltech.\+edu}

Adapted for True\+Crypt 

\subsection{Function Documentation}
\mbox{\Hypertarget{_decompressor_8c_af23433d9d58fb31d4a1ac224e3bc46e8}\label{_decompressor_8c_af23433d9d58fb31d4a1ac224e3bc46e8}} 
\index{Decompressor.\+c@{Decompressor.\+c}!bits@{bits}}
\index{bits@{bits}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{bits()}{bits()}}
{\footnotesize\ttfamily \hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int bits (\begin{DoxyParamCaption}\item[{struct \hyperlink{structstate}{state} $\ast$}]{s,  }\item[{int}]{need }\end{DoxyParamCaption})}



Get needed bits. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & need \\
\hline
\mbox{\tt in}  & {\em struct} & state $\ast$ s \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
local int (val \& ((1L $<$$<$ need) -\/ 1)) 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=307pt]{_decompressor_8c_af23433d9d58fb31d4a1ac224e3bc46e8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=186pt]{_decompressor_8c_af23433d9d58fb31d4a1ac224e3bc46e8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_decompressor_8c_afce25d8162a22b60b1c6124eeac0e37e}\label{_decompressor_8c_afce25d8162a22b60b1c6124eeac0e37e}} 
\index{Decompressor.\+c@{Decompressor.\+c}!codes@{codes}}
\index{codes@{codes}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{codes()}{codes()}}
{\footnotesize\ttfamily \hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int codes (\begin{DoxyParamCaption}\item[{struct \hyperlink{structstate}{state} $\ast$}]{s,  }\item[{struct \hyperlink{structhuffman}{huffman} $\ast$}]{lencode,  }\item[{struct \hyperlink{structhuffman}{huffman} $\ast$}]{distcode }\end{DoxyParamCaption})}



Decode data until end-\/of-\/block code. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & huffman $\ast$ distcode \\
\hline
\mbox{\tt in}  & {\em struct} & huffman $\ast$ lencode \\
\hline
\mbox{\tt in}  & {\em struct} & state $\ast$ s \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
local int 0 for complete set $>$0 for incomplete set 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=207pt]{_decompressor_8c_afce25d8162a22b60b1c6124eeac0e37e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_decompressor_8c_aaad3ca7ae854bf9197295c9e3e32db85}\label{_decompressor_8c_aaad3ca7ae854bf9197295c9e3e32db85}} 
\index{Decompressor.\+c@{Decompressor.\+c}!construct@{construct}}
\index{construct@{construct}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{construct()}{construct()}}
{\footnotesize\ttfamily \hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int construct (\begin{DoxyParamCaption}\item[{struct \hyperlink{structhuffman}{huffman} $\ast$}]{h,  }\item[{short $\ast$}]{length,  }\item[{int}]{n }\end{DoxyParamCaption})}



build huffman table for code lengths codes 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n \\
\hline
\mbox{\tt in}  & {\em short} & $\ast$ length \\
\hline
\mbox{\tt in}  & {\em struct} & huffman $\ast$ h \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
local int 0 for complete set $>$0 for incomplete set 
\end{DoxyReturn}
\mbox{\Hypertarget{_decompressor_8c_a25b79328579a3f00f9d7baf16b9d49e9}\label{_decompressor_8c_a25b79328579a3f00f9d7baf16b9d49e9}} 
\index{Decompressor.\+c@{Decompressor.\+c}!decode@{decode}}
\index{decode@{decode}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{decode()}{decode()}}
{\footnotesize\ttfamily \hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int decode (\begin{DoxyParamCaption}\item[{struct \hyperlink{structstate}{state} $\ast$}]{s,  }\item[{struct \hyperlink{structhuffman}{huffman} $\ast$}]{h }\end{DoxyParamCaption})}



Decode with huffman faster. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & huffman $\ast$ h \\
\hline
\mbox{\tt in}  & {\em struct} & state $\ast$ s \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
local int h-\/$>$symbol\mbox{[}index + (code -\/ first)\mbox{]} if (code $<$ first + count) -\/9 else (if ran out of codes) 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=207pt]{_decompressor_8c_a25b79328579a3f00f9d7baf16b9d49e9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_decompressor_8c_a5f81f35c5fef404a03c7059b39ab45f1}\label{_decompressor_8c_a5f81f35c5fef404a03c7059b39ab45f1}} 
\index{Decompressor.\+c@{Decompressor.\+c}!dynamic@{dynamic}}
\index{dynamic@{dynamic}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{dynamic()}{dynamic()}}
{\footnotesize\ttfamily \hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int dynamic (\begin{DoxyParamCaption}\item[{struct \hyperlink{structstate}{state} $\ast$}]{s }\end{DoxyParamCaption})}



Read code lenght, build huffman tables and decode data until end-\/of-\/block code. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & state $\ast$ s \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
local int -\/3 if (nlen $>$ M\+A\+X\+L\+C\+O\+D\+ES $\vert$$\vert$ ndist $>$ M\+A\+X\+D\+C\+O\+D\+ES) -\/4 if (err != 0), -\/5 if (symbol == 16) -\/6 if (index + symbol $>$ nlen + ndist) -\/7 if (err $<$ 0 $\vert$$\vert$ (err $>$ 0 \&\& nlen -\/ lencode.\+count\mbox{[}0\mbox{]} != 1)) -\/8 if (err $<$ 0 $\vert$$\vert$ (err $>$ 0 \&\& ndist -\/ distcode.\+count\mbox{[}0\mbox{]} != 1)) codes(s, \&lencode, \&distcode) else 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=207pt]{_decompressor_8c_a5f81f35c5fef404a03c7059b39ab45f1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_decompressor_8c_af3340594bb80768552b17efb18581c98}\label{_decompressor_8c_af3340594bb80768552b17efb18581c98}} 
\index{Decompressor.\+c@{Decompressor.\+c}!fixed@{fixed}}
\index{fixed@{fixed}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{fixed()}{fixed()}}
{\footnotesize\ttfamily \hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int fixed (\begin{DoxyParamCaption}\item[{struct \hyperlink{structstate}{state} $\ast$}]{s }\end{DoxyParamCaption})}



Build fixed huffman tables if first call. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & state $\ast$ s \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
local int codes(s, \&lencode, \&distcode) 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=191pt]{_decompressor_8c_af3340594bb80768552b17efb18581c98_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_decompressor_8c_a93747b6f64a7778977983853051e3f90}\label{_decompressor_8c_a93747b6f64a7778977983853051e3f90}} 
\index{Decompressor.\+c@{Decompressor.\+c}!main@{main}}
\index{main@{main}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int far main (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{dest,  }\item[{unsigned int}]{destlen,  }\item[{unsigned char $\ast$}]{source }\end{DoxyParamCaption})}



Process all blocks or until error. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unsigned} & char $\ast$ source \\
\hline
\mbox{\tt in}  & {\em unsigned} & int destlen \\
\hline
\mbox{\tt in}  & {\em unsigned} & char $\ast$ dest \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int far err 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_decompressor_8c_a93747b6f64a7778977983853051e3f90_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_decompressor_8c_a2c157e80e65abde8e3f64853a41bfecc}\label{_decompressor_8c_a2c157e80e65abde8e3f64853a41bfecc}} 
\index{Decompressor.\+c@{Decompressor.\+c}!stored@{stored}}
\index{stored@{stored}!Decompressor.\+c@{Decompressor.\+c}}
\subsubsection{\texorpdfstring{stored()}{stored()}}
{\footnotesize\ttfamily \hyperlink{_decompressor_8c_a08023ea6765c99d60a6a3840cd07156e}{local} int stored (\begin{DoxyParamCaption}\item[{struct \hyperlink{structstate}{state} $\ast$}]{s }\end{DoxyParamCaption})}



Store a block. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & state $\ast$ s \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
local int 0 if done with a valid stored block -\/2 if (s-\/$>$in\mbox{[}s-\/$>$incnt++\mbox{]} != ($\sim$len \& 0xff) $\vert$$\vert$ s-\/$>$in\mbox{[}s-\/$>$incnt++\mbox{]} != (($\sim$len $>$$>$ 8) \& 0xff)) 1 if (s-\/$>$outcnt + len $>$ s-\/$>$outlen \&\& (s-\/$>$out != N\+IL)) 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=198pt]{_decompressor_8c_a2c157e80e65abde8e3f64853a41bfecc_icgraph}
\end{center}
\end{figure}
