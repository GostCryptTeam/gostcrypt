\hypertarget{_random_8c}{}\section{Common/\+Random.c File Reference}
\label{_random_8c}\index{Common/\+Random.\+c@{Common/\+Random.\+c}}


Manage the requirements for using the mix\+Pool (defined in this file) function that will add random into the crypting process.  


{\ttfamily \#include \char`\"{}Gstdefs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Crc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Random.\+h\char`\"{}}\newline
{\ttfamily \#include $<$tlhelp32.\+h$>$}\newline
{\ttfamily \#include \char`\"{}Dlgcode.\+h\char`\"{}}\newline
Include dependency graph for Random.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_random_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define {\bfseries Randadd\+Byte}(x)
\item 
\mbox{\Hypertarget{_random_8c_a5b2c2e236e93fc6933405d8aed4bf20c}\label{_random_8c_a5b2c2e236e93fc6933405d8aed4bf20c}} 
\#define {\bfseries Randadd\+Int32}(x)~\hyperlink{_random_8c_a986e0406e6679a9dfd267c574aa8ec8d}{Rand\+Add\+Int}((unsigned \+\_\+\+\_\+int32)x);
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_random_8c_a50f7f9da1f34b324fb68f9d242ed8509}\label{_random_8c_a50f7f9da1f34b324fb68f9d242ed8509}} 
typedef D\+W\+O\+RD(W\+I\+N\+A\+PI $\ast$ {\bfseries N\+E\+T\+S\+T\+A\+T\+I\+S\+T\+I\+C\+S\+G\+ET}) (L\+P\+W\+S\+TR sz\+Server, L\+P\+W\+S\+TR sz\+Service, D\+W\+O\+RD dw\+Level, D\+W\+O\+RD dw\+Options, L\+P\+B\+Y\+TE $\ast$lp\+Buffer)
\item 
\mbox{\Hypertarget{_random_8c_acf58d1059549792cde3c717853dccdb0}\label{_random_8c_acf58d1059549792cde3c717853dccdb0}} 
typedef D\+W\+O\+RD(W\+I\+N\+A\+PI $\ast$ {\bfseries N\+E\+T\+A\+P\+I\+B\+U\+F\+F\+E\+R\+S\+I\+ZE}) (L\+P\+V\+O\+ID lp\+Buffer, L\+P\+D\+W\+O\+RD cb\+Buffer)
\item 
\mbox{\Hypertarget{_random_8c_aa8e43b8b490a096bc31f13524a905fc0}\label{_random_8c_aa8e43b8b490a096bc31f13524a905fc0}} 
typedef D\+W\+O\+RD(W\+I\+N\+A\+PI $\ast$ {\bfseries N\+E\+T\+A\+P\+I\+B\+U\+F\+F\+E\+R\+F\+R\+EE}) (L\+P\+V\+O\+ID lp\+Buffer)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_random_8c_a986e0406e6679a9dfd267c574aa8ec8d}{Rand\+Add\+Int} (unsigned \+\_\+\+\_\+int32 x)
\begin{DoxyCompactList}\small\item\em Add random byte in all bytes of x value (in argument) \end{DoxyCompactList}\item 
int \hyperlink{_random_8c_a4c51a11fb671c29c6f9c22e3db140618}{Randinit} ()
\begin{DoxyCompactList}\small\item\em Init the random number generator, setup the hooks, and start the thread. \end{DoxyCompactList}\item 
void \hyperlink{_random_8c_a009589ab36ed5eba8dfee41cef19792a}{Rand\+Stop} (B\+O\+OL free\+Pool)
\begin{DoxyCompactList}\small\item\em Close everything down, including the thread which is closed down by setting a flag which eventually causes the thread function to exit. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_random_8c_adde1d6fdecdc1df8fbadcb16dc445b4c}{Is\+Random\+Number\+Generator\+Started} ()
\begin{DoxyCompactList}\small\item\em Return the status of Random\+Number\+Generator thread. \end{DoxyCompactList}\item 
void \hyperlink{_random_8c_aba80bcfbc12785c63c8bbb16f415c516}{Rand\+Set\+Hash\+Function} (int hash\+\_\+algo\+\_\+id)
\begin{DoxyCompactList}\small\item\em Set the hash function that will be used by the default one if none was chosen otherwise set it the the hash ID. \end{DoxyCompactList}\item 
int \hyperlink{_random_8c_a2014fa3d97acda067c9618a43e184e2c}{Rand\+Get\+Hash\+Function} (void)
\begin{DoxyCompactList}\small\item\em Getter for the hash function. \end{DoxyCompactList}\item 
void \hyperlink{_random_8c_a0dbcb0c1d268cb4fb1736a0565781f61}{Set\+Random\+Pool\+Enriched\+By\+User\+Status} (B\+O\+OL enriched)
\begin{DoxyCompactList}\small\item\em Set the random pool to enriched. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_random_8c_a31f3fbcec0bed8fbb7242084a017fabb}{Is\+Random\+Pool\+Enriched\+By\+User} ()
\begin{DoxyCompactList}\small\item\em Getter for the enriched status of the pool. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_random_8c_a204161668b3568f6d98344329287e95d}{Randmix} ()
\begin{DoxyCompactList}\small\item\em The random pool mixing function. Set the digest size according to the hash, compute the digest message with the seleted hash function, mix and delete for avoiding leaks. \end{DoxyCompactList}\item 
void \hyperlink{_random_8c_afc917d62bccdd2bddc5c345b24d20117}{Randadd\+Buf} (void $\ast$buf, int len)
\begin{DoxyCompactList}\small\item\em Add a buffer to the pool. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_random_8c_a39824abaa63b4069cd5e4a50d89f5a31}{Randpeek\+Bytes} (unsigned char $\ast$buf, int len)
\begin{DoxyCompactList}\small\item\em Enter the critical section and copy some data of a given length. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_random_8c_a4f9073a1b47a63a40fed7a2b39ea63d2}{Randget\+Bytes} (unsigned char $\ast$buf, int len, B\+O\+OL force\+Slow\+Poll)
\begin{DoxyCompactList}\small\item\em Get len random bytes from the pool (max. R\+N\+G\+\_\+\+P\+O\+O\+L\+\_\+\+S\+I\+ZE bytes per a single call) \end{DoxyCompactList}\item 
L\+R\+E\+S\+U\+LT C\+A\+L\+L\+B\+A\+CK \hyperlink{_random_8c_a6f936ea5a2403f24ff9917e7e6ec7d43}{Mouse\+Proc} (int n\+Code, W\+P\+A\+R\+AM w\+Param, L\+P\+A\+R\+AM l\+Param)
\begin{DoxyCompactList}\small\item\em Capture the mouse, and as long as the event is not the same as the last two events, add the crc of the event, and the crc of the time difference between this event and the last + the current time to the pool. The role of C\+R\+C-\/32 is merely to perform diffusion. Note that the output of C\+R\+C-\/32 is subsequently processed using a cryptographically secure hash algorithm. \end{DoxyCompactList}\item 
L\+R\+E\+S\+U\+LT C\+A\+L\+L\+B\+A\+CK \hyperlink{_random_8c_a30a5a763fbbb5f49194e48600b749c01}{Keyboard\+Proc} (int n\+Code, W\+P\+A\+R\+AM w\+Param, L\+P\+A\+R\+AM l\+Param)
\begin{DoxyCompactList}\small\item\em Capture the keyboard, as long as the event is not the same as the last two events, add the crc of the event to the pool along with the crc of the time difference between this event and the last. The role of C\+R\+C-\/32 is merely to perform diffusion. Note that the output of C\+R\+C-\/32 is subsequently processed using a cryptographically secure hash algorithm. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_random_8c_a40afdfbd27ad7326c80e1fce5644783c}{Slow\+Poll} (void)
\begin{DoxyCompactList}\small\item\em This is the slowpoll function which gathers up network/hard drive. It is only used for NT server like \+: Win\+NT, Server\+NT, Lanman\+NT. performance data for the random pool. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_random_8c_a59f86574d41b814045c8b68bdf9e4c6e}{Fast\+Poll} (void)
\begin{DoxyCompactList}\small\item\em This is the fastpoll function which gathers up info by calling various api\textquotesingle{}s. It gets the system information in order to avoid problem for the processes. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_random_8c_a8243cfab6e48b9868319bd9da5c1f038}\label{_random_8c_a8243cfab6e48b9868319bd9da5c1f038}} 
B\+O\+OL volatile {\bfseries b\+Fast\+Poll\+Enabled} = T\+R\+UE
\item 
\mbox{\Hypertarget{_random_8c_a86ee99e68428f16f711dc531c469a3bd}\label{_random_8c_a86ee99e68428f16f711dc531c469a3bd}} 
B\+O\+OL volatile {\bfseries b\+Randmix\+Enabled} = T\+R\+UE
\item 
\mbox{\Hypertarget{_random_8c_a90e998a20ccc3d302dbcc2e415f7ceba}\label{_random_8c_a90e998a20ccc3d302dbcc2e415f7ceba}} 
H\+H\+O\+OK {\bfseries h\+Mouse} = N\+U\+LL
\item 
\mbox{\Hypertarget{_random_8c_af2b3dde75f9f3f5b074b749ef40767de}\label{_random_8c_af2b3dde75f9f3f5b074b749ef40767de}} 
H\+H\+O\+OK {\bfseries h\+Keyboard} = N\+U\+LL
\item 
\mbox{\Hypertarget{_random_8c_afe542c34fd5eef605425a615a9a94d94}\label{_random_8c_afe542c34fd5eef605425a615a9a94d94}} 
C\+R\+I\+T\+I\+C\+A\+L\+\_\+\+S\+E\+C\+T\+I\+ON {\bfseries crit\+Rand\+Prot}
\item 
\mbox{\Hypertarget{_random_8c_a477ef5686248e139ec392390722f5e22}\label{_random_8c_a477ef5686248e139ec392390722f5e22}} 
B\+O\+OL volatile {\bfseries b\+Thread\+Terminate} = F\+A\+L\+SE
\item 
\mbox{\Hypertarget{_random_8c_a12a9cba5cb1216bcd1e36f43c935a796}\label{_random_8c_a12a9cba5cb1216bcd1e36f43c935a796}} 
H\+A\+N\+D\+LE {\bfseries h\+Net\+A\+P\+I32} = N\+U\+LL
\item 
\mbox{\Hypertarget{_random_8c_a14581f3926bd0852f775d7df8232b155}\label{_random_8c_a14581f3926bd0852f775d7df8232b155}} 
B\+O\+OL {\bfseries Crypto\+A\+P\+I\+Available} = F\+A\+L\+SE
\item 
\mbox{\Hypertarget{_random_8c_a2ba57d821ca61ef1882f32c140244cf5}\label{_random_8c_a2ba57d821ca61ef1882f32c140244cf5}} 
H\+C\+R\+Y\+P\+T\+P\+R\+OV {\bfseries h\+Crypt\+Prov}
\item 
\mbox{\Hypertarget{_random_8c_a9fd65700c705f1b5b94c1735f53be5d1}\label{_random_8c_a9fd65700c705f1b5b94c1735f53be5d1}} 
N\+E\+T\+S\+T\+A\+T\+I\+S\+T\+I\+C\+S\+G\+ET {\bfseries p\+Net\+Statistics\+Get} = N\+U\+LL
\item 
\mbox{\Hypertarget{_random_8c_a755b688c93f218351ac883629b661476}\label{_random_8c_a755b688c93f218351ac883629b661476}} 
N\+E\+T\+A\+P\+I\+B\+U\+F\+F\+E\+R\+S\+I\+ZE {\bfseries p\+Net\+Api\+Buffer\+Size} = N\+U\+LL
\item 
\mbox{\Hypertarget{_random_8c_a85f0ba532ac2ade27e46b9af9a1bf74d}\label{_random_8c_a85f0ba532ac2ade27e46b9af9a1bf74d}} 
N\+E\+T\+A\+P\+I\+B\+U\+F\+F\+E\+R\+F\+R\+EE {\bfseries p\+Net\+Api\+Buffer\+Free} = N\+U\+LL
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Manage the requirements for using the mix\+Pool (defined in this file) function that will add random into the crypting process. 

\begin{DoxyVersion}{Version}
1.\+3.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
20/01/2017 
\end{DoxyDate}


\subsection{Macro Definition Documentation}
\mbox{\Hypertarget{_random_8c_a91a2ce1ee1581aec0e782c45745667fc}\label{_random_8c_a91a2ce1ee1581aec0e782c45745667fc}} 
\index{Random.\+c@{Random.\+c}!Randadd\+Byte@{Randadd\+Byte}}
\index{Randadd\+Byte@{Randadd\+Byte}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Randadd\+Byte}{RandaddByte}}
{\footnotesize\ttfamily \#define Randadd\+Byte(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}
\{\(\backslash\)
    if (nRandIndex == RNG\_POOL\_SIZE) nRandIndex = 0;\(\backslash\)
    pRandPool[nRandIndex] = (\textcolor{keywordtype}{unsigned} char) ((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char})x + pRandPool[nRandIndex]); \(\backslash\)
    if (nRandIndex % RANDMIX\_BYTE\_INTERVAL == 0) \hyperlink{_random_8c_a204161668b3568f6d98344329287e95d}{Randmix}();\(\backslash\)
    nRandIndex++; \(\backslash\)
    \}
\end{DoxyCode}


\subsection{Function Documentation}
\mbox{\Hypertarget{_random_8c_a59f86574d41b814045c8b68bdf9e4c6e}\label{_random_8c_a59f86574d41b814045c8b68bdf9e4c6e}} 
\index{Random.\+c@{Random.\+c}!Fast\+Poll@{Fast\+Poll}}
\index{Fast\+Poll@{Fast\+Poll}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Fast\+Poll()}{FastPoll()}}
{\footnotesize\ttfamily B\+O\+OL Fast\+Poll (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



This is the fastpoll function which gathers up info by calling various api\textquotesingle{}s. It gets the system information in order to avoid problem for the processes. 

\begin{DoxyReturn}{Returns}
B\+O\+OL T\+R\+UE 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_adde1d6fdecdc1df8fbadcb16dc445b4c}\label{_random_8c_adde1d6fdecdc1df8fbadcb16dc445b4c}} 
\index{Random.\+c@{Random.\+c}!Is\+Random\+Number\+Generator\+Started@{Is\+Random\+Number\+Generator\+Started}}
\index{Is\+Random\+Number\+Generator\+Started@{Is\+Random\+Number\+Generator\+Started}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Is\+Random\+Number\+Generator\+Started()}{IsRandomNumberGeneratorStarted()}}
{\footnotesize\ttfamily B\+O\+OL Is\+Random\+Number\+Generator\+Started (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Return the status of Random\+Number\+Generator thread. 

\begin{DoxyReturn}{Returns}
B\+O\+OL b\+Rand\+Did\+Init 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_a31f3fbcec0bed8fbb7242084a017fabb}\label{_random_8c_a31f3fbcec0bed8fbb7242084a017fabb}} 
\index{Random.\+c@{Random.\+c}!Is\+Random\+Pool\+Enriched\+By\+User@{Is\+Random\+Pool\+Enriched\+By\+User}}
\index{Is\+Random\+Pool\+Enriched\+By\+User@{Is\+Random\+Pool\+Enriched\+By\+User}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Is\+Random\+Pool\+Enriched\+By\+User()}{IsRandomPoolEnrichedByUser()}}
{\footnotesize\ttfamily B\+O\+OL Is\+Random\+Pool\+Enriched\+By\+User (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Getter for the enriched status of the pool. 

\begin{DoxyReturn}{Returns}
B\+O\+OL Random\+Pool\+Enriched\+By\+User 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_random_8c_a31f3fbcec0bed8fbb7242084a017fabb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_random_8c_a30a5a763fbbb5f49194e48600b749c01}\label{_random_8c_a30a5a763fbbb5f49194e48600b749c01}} 
\index{Random.\+c@{Random.\+c}!Keyboard\+Proc@{Keyboard\+Proc}}
\index{Keyboard\+Proc@{Keyboard\+Proc}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Keyboard\+Proc()}{KeyboardProc()}}
{\footnotesize\ttfamily L\+R\+E\+S\+U\+LT C\+A\+L\+L\+B\+A\+CK Keyboard\+Proc (\begin{DoxyParamCaption}\item[{int}]{n\+Code,  }\item[{W\+P\+A\+R\+AM}]{w\+Param,  }\item[{L\+P\+A\+R\+AM}]{l\+Param }\end{DoxyParamCaption})}



Capture the keyboard, as long as the event is not the same as the last two events, add the crc of the event to the pool along with the crc of the time difference between this event and the last. The role of C\+R\+C-\/32 is merely to perform diffusion. Note that the output of C\+R\+C-\/32 is subsequently processed using a cryptographically secure hash algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em L\+P\+A\+R\+AM} & l\+Param \\
\hline
\mbox{\tt in}  & {\em W\+P\+A\+R\+AM} & w\+Param \\
\hline
\mbox{\tt in}  & {\em int} & n\+Code \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
L\+R\+E\+S\+U\+LT Call\+Next\+Hook\+Ex (h\+Mouse, n\+Code, w\+Param, l\+Param) if (n\+Code $<$ 0) Call\+Next\+Hook\+Ex (h\+Mouse, n\+Code, w\+Param, l\+Param) else 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_a6f936ea5a2403f24ff9917e7e6ec7d43}\label{_random_8c_a6f936ea5a2403f24ff9917e7e6ec7d43}} 
\index{Random.\+c@{Random.\+c}!Mouse\+Proc@{Mouse\+Proc}}
\index{Mouse\+Proc@{Mouse\+Proc}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Mouse\+Proc()}{MouseProc()}}
{\footnotesize\ttfamily L\+R\+E\+S\+U\+LT C\+A\+L\+L\+B\+A\+CK Mouse\+Proc (\begin{DoxyParamCaption}\item[{int}]{n\+Code,  }\item[{W\+P\+A\+R\+AM}]{w\+Param,  }\item[{L\+P\+A\+R\+AM}]{l\+Param }\end{DoxyParamCaption})}



Capture the mouse, and as long as the event is not the same as the last two events, add the crc of the event, and the crc of the time difference between this event and the last + the current time to the pool. The role of C\+R\+C-\/32 is merely to perform diffusion. Note that the output of C\+R\+C-\/32 is subsequently processed using a cryptographically secure hash algorithm. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em L\+P\+A\+R\+AM} & l\+Param \\
\hline
\mbox{\tt in}  & {\em W\+P\+A\+R\+AM} & w\+Param \\
\hline
\mbox{\tt in}  & {\em int} & n\+Code \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
L\+R\+E\+S\+U\+LT Call\+Next\+Hook\+Ex (h\+Mouse, n\+Code, w\+Param, l\+Param) if (n\+Code $<$ 0) 0 else 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_afc917d62bccdd2bddc5c345b24d20117}\label{_random_8c_afc917d62bccdd2bddc5c345b24d20117}} 
\index{Random.\+c@{Random.\+c}!Randadd\+Buf@{Randadd\+Buf}}
\index{Randadd\+Buf@{Randadd\+Buf}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Randadd\+Buf()}{RandaddBuf()}}
{\footnotesize\ttfamily void Randadd\+Buf (\begin{DoxyParamCaption}\item[{void $\ast$}]{buf,  }\item[{int}]{len }\end{DoxyParamCaption})}



Add a buffer to the pool. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & len \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ buf \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_a986e0406e6679a9dfd267c574aa8ec8d}\label{_random_8c_a986e0406e6679a9dfd267c574aa8ec8d}} 
\index{Random.\+c@{Random.\+c}!Rand\+Add\+Int@{Rand\+Add\+Int}}
\index{Rand\+Add\+Int@{Rand\+Add\+Int}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Rand\+Add\+Int()}{RandAddInt()}}
{\footnotesize\ttfamily void Rand\+Add\+Int (\begin{DoxyParamCaption}\item[{unsigned \+\_\+\+\_\+int32}]{x }\end{DoxyParamCaption})}



Add random byte in all bytes of x value (in argument) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int32 x \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_a4f9073a1b47a63a40fed7a2b39ea63d2}\label{_random_8c_a4f9073a1b47a63a40fed7a2b39ea63d2}} 
\index{Random.\+c@{Random.\+c}!Randget\+Bytes@{Randget\+Bytes}}
\index{Randget\+Bytes@{Randget\+Bytes}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Randget\+Bytes()}{RandgetBytes()}}
{\footnotesize\ttfamily B\+O\+OL Randget\+Bytes (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{buf,  }\item[{int}]{len,  }\item[{B\+O\+OL}]{force\+Slow\+Poll }\end{DoxyParamCaption})}



Get len random bytes from the pool (max. R\+N\+G\+\_\+\+P\+O\+O\+L\+\_\+\+S\+I\+ZE bytes per a single call) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B\+O\+OL} & force\+Slow\+Poll \\
\hline
\mbox{\tt in}  & {\em int} & len \\
\hline
\mbox{\tt in}  & {\em unsigned} & char $\ast$ buf \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (b\+Did\+Slow\+Poll == F\+A\+L\+SE $\vert$$\vert$ force\+Slow\+Poll \&\& (!\+Slow\+Poll ())) F\+A\+L\+SE if (!\+Fast\+Poll ()) T\+R\+UE else 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=346pt]{_random_8c_a4f9073a1b47a63a40fed7a2b39ea63d2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_random_8c_a2014fa3d97acda067c9618a43e184e2c}\label{_random_8c_a2014fa3d97acda067c9618a43e184e2c}} 
\index{Random.\+c@{Random.\+c}!Rand\+Get\+Hash\+Function@{Rand\+Get\+Hash\+Function}}
\index{Rand\+Get\+Hash\+Function@{Rand\+Get\+Hash\+Function}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Rand\+Get\+Hash\+Function()}{RandGetHashFunction()}}
{\footnotesize\ttfamily int Rand\+Get\+Hash\+Function (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Getter for the hash function. 

\begin{DoxyReturn}{Returns}
int Hash\+Function 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_a4c51a11fb671c29c6f9c22e3db140618}\label{_random_8c_a4c51a11fb671c29c6f9c22e3db140618}} 
\index{Random.\+c@{Random.\+c}!Randinit@{Randinit}}
\index{Randinit@{Randinit}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Randinit()}{Randinit()}}
{\footnotesize\ttfamily int Randinit (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Init the random number generator, setup the hooks, and start the thread. 

\begin{DoxyReturn}{Returns}
int 0 if (b\+Rand\+Did\+Init) 1 if (p\+Rand\+Pool == N\+U\+LL \&\& (p\+Rand\+Pool == N\+U\+LL)) 1 if (h\+Mouse == 0) 1 if (!(Periodic\+Fast\+Poll\+Thread\+Handle = (H\+A\+N\+D\+LE) \+\_\+beginthreadex (N\+U\+LL, 0, Periodic\+Fast\+Poll\+Thread\+Proc, N\+U\+LL, 0, N\+U\+LL))) 0 else 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_random_8c_a4c51a11fb671c29c6f9c22e3db140618_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_random_8c_a4c51a11fb671c29c6f9c22e3db140618_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_random_8c_a204161668b3568f6d98344329287e95d}\label{_random_8c_a204161668b3568f6d98344329287e95d}} 
\index{Random.\+c@{Random.\+c}!Randmix@{Randmix}}
\index{Randmix@{Randmix}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Randmix()}{Randmix()}}
{\footnotesize\ttfamily B\+O\+OL Randmix (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



The random pool mixing function. Set the digest size according to the hash, compute the digest message with the seleted hash function, mix and delete for avoiding leaks. 

\begin{DoxyReturn}{Returns}
B\+O\+OL T\+R\+UE 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_a39824abaa63b4069cd5e4a50d89f5a31}\label{_random_8c_a39824abaa63b4069cd5e4a50d89f5a31}} 
\index{Random.\+c@{Random.\+c}!Randpeek\+Bytes@{Randpeek\+Bytes}}
\index{Randpeek\+Bytes@{Randpeek\+Bytes}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Randpeek\+Bytes()}{RandpeekBytes()}}
{\footnotesize\ttfamily B\+O\+OL Randpeek\+Bytes (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{buf,  }\item[{int}]{len }\end{DoxyParamCaption})}



Enter the critical section and copy some data of a given length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & len \\
\hline
\mbox{\tt in}  & {\em unsigned} & char \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (!b\+Rand\+Did\+Init) T\+R\+UE else 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=293pt]{_random_8c_a39824abaa63b4069cd5e4a50d89f5a31_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_random_8c_aba80bcfbc12785c63c8bbb16f415c516}\label{_random_8c_aba80bcfbc12785c63c8bbb16f415c516}} 
\index{Random.\+c@{Random.\+c}!Rand\+Set\+Hash\+Function@{Rand\+Set\+Hash\+Function}}
\index{Rand\+Set\+Hash\+Function@{Rand\+Set\+Hash\+Function}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Rand\+Set\+Hash\+Function()}{RandSetHashFunction()}}
{\footnotesize\ttfamily void Rand\+Set\+Hash\+Function (\begin{DoxyParamCaption}\item[{int}]{hash\+\_\+algo\+\_\+id }\end{DoxyParamCaption})}



Set the hash function that will be used by the default one if none was chosen otherwise set it the the hash ID. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & hash\+\_\+algo\+\_\+id \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_random_8c_aba80bcfbc12785c63c8bbb16f415c516_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_random_8c_aba80bcfbc12785c63c8bbb16f415c516_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_random_8c_a009589ab36ed5eba8dfee41cef19792a}\label{_random_8c_a009589ab36ed5eba8dfee41cef19792a}} 
\index{Random.\+c@{Random.\+c}!Rand\+Stop@{Rand\+Stop}}
\index{Rand\+Stop@{Rand\+Stop}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Rand\+Stop()}{RandStop()}}
{\footnotesize\ttfamily void Rand\+Stop (\begin{DoxyParamCaption}\item[{B\+O\+OL}]{free\+Pool }\end{DoxyParamCaption})}



Close everything down, including the thread which is closed down by setting a flag which eventually causes the thread function to exit. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B\+O\+OL} & free\+Pool \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{_random_8c_a009589ab36ed5eba8dfee41cef19792a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_random_8c_a0dbcb0c1d268cb4fb1736a0565781f61}\label{_random_8c_a0dbcb0c1d268cb4fb1736a0565781f61}} 
\index{Random.\+c@{Random.\+c}!Set\+Random\+Pool\+Enriched\+By\+User\+Status@{Set\+Random\+Pool\+Enriched\+By\+User\+Status}}
\index{Set\+Random\+Pool\+Enriched\+By\+User\+Status@{Set\+Random\+Pool\+Enriched\+By\+User\+Status}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Set\+Random\+Pool\+Enriched\+By\+User\+Status()}{SetRandomPoolEnrichedByUserStatus()}}
{\footnotesize\ttfamily void Set\+Random\+Pool\+Enriched\+By\+User\+Status (\begin{DoxyParamCaption}\item[{B\+O\+OL}]{enriched }\end{DoxyParamCaption})}



Set the random pool to enriched. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B\+O\+OL} & enriched \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_random_8c_a40afdfbd27ad7326c80e1fce5644783c}\label{_random_8c_a40afdfbd27ad7326c80e1fce5644783c}} 
\index{Random.\+c@{Random.\+c}!Slow\+Poll@{Slow\+Poll}}
\index{Slow\+Poll@{Slow\+Poll}!Random.\+c@{Random.\+c}}
\subsubsection{\texorpdfstring{Slow\+Poll()}{SlowPoll()}}
{\footnotesize\ttfamily B\+O\+OL Slow\+Poll (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



This is the slowpoll function which gathers up network/hard drive. It is only used for NT server like \+: Win\+NT, Server\+NT, Lanman\+NT. performance data for the random pool. 

\begin{DoxyReturn}{Returns}
B\+O\+OL T\+R\+UE 
\end{DoxyReturn}
