\hypertarget{_encryption_thread_pool_8c}{}\section{Common/\+Encryption\+Thread\+Pool.c File Reference}
\label{_encryption_thread_pool_8c}\index{Common/\+Encryption\+Thread\+Pool.\+c@{Common/\+Encryption\+Thread\+Pool.\+c}}


Manage the pool that gather multiple thread that will encrypt/decrypt data. the threads use small amount data to run the whole encryption/decryption process faster.  


{\ttfamily \#include \char`\"{}Encryption\+Thread\+Pool.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Pkcs5.\+h\char`\"{}}\newline
Include dependency graph for Encryption\+Thread\+Pool.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_encryption_thread_pool_8c__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_encryption_thread_pool_work_item_struct}{Encryption\+Thread\+Pool\+Work\+Item\+Struct}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_a52e25cfd4f3523acf0c0425e7ed67cd8}\label{_encryption_thread_pool_8c_a52e25cfd4f3523acf0c0425e7ed67cd8}} 
\#define {\bfseries G\+S\+T\+\_\+\+E\+N\+C\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+P\+O\+O\+L\+\_\+\+M\+A\+X\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+C\+O\+U\+NT}~64
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_a2df460f4490f0d8f5caac3b57ff2e089}\label{_encryption_thread_pool_8c_a2df460f4490f0d8f5caac3b57ff2e089}} 
\#define {\bfseries G\+S\+T\+\_\+\+E\+N\+C\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+P\+O\+O\+L\+\_\+\+Q\+U\+E\+U\+E\+\_\+\+S\+I\+ZE}~(G\+S\+T\+\_\+\+E\+N\+C\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+P\+O\+O\+L\+\_\+\+M\+A\+X\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+C\+O\+U\+NT $\ast$ 2)
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_ad48c4bf0e965f8d061253a6c0b0cae34}\label{_encryption_thread_pool_8c_ad48c4bf0e965f8d061253a6c0b0cae34}} 
\#define {\bfseries G\+S\+T\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+H\+A\+N\+D\+LE}~H\+A\+N\+D\+LE
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_a2c317670998a6d99a72e0e5e35bf337e}\label{_encryption_thread_pool_8c_a2c317670998a6d99a72e0e5e35bf337e}} 
\#define {\bfseries G\+S\+T\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+P\+R\+OC}~unsigned \+\_\+\+\_\+stdcall
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_a9bccb4656b26c32f647ca41e55d69903}\label{_encryption_thread_pool_8c_a9bccb4656b26c32f647ca41e55d69903}} 
\#define {\bfseries G\+S\+T\+\_\+\+S\+E\+T\+\_\+\+E\+V\+E\+NT}(E\+V\+E\+NT)~Set\+Event (E\+V\+E\+NT)
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_ad21b7ef049fa8ba23d9c5e34b6c20823}\label{_encryption_thread_pool_8c_ad21b7ef049fa8ba23d9c5e34b6c20823}} 
\#define {\bfseries G\+S\+T\+\_\+\+C\+L\+E\+A\+R\+\_\+\+E\+V\+E\+NT}(E\+V\+E\+NT)~Reset\+Event (E\+V\+E\+NT)
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_a84caab69fa2b03a189f61be7e2aa9682}\label{_encryption_thread_pool_8c_a84caab69fa2b03a189f61be7e2aa9682}} 
\#define {\bfseries G\+S\+T\+\_\+\+M\+U\+T\+EX}~H\+A\+N\+D\+LE
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_a3951310095d03ce3f56320d8c7a836c6}\label{_encryption_thread_pool_8c_a3951310095d03ce3f56320d8c7a836c6}} 
\#define {\bfseries G\+S\+T\+\_\+\+A\+C\+Q\+U\+I\+R\+E\+\_\+\+M\+U\+T\+EX}(M\+U\+T\+EX)~Wait\+For\+Single\+Object ($\ast$(M\+U\+T\+EX), I\+N\+F\+I\+N\+I\+TE)
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_af019a1e0d07a1b48e3b509d4a5be9190}\label{_encryption_thread_pool_8c_af019a1e0d07a1b48e3b509d4a5be9190}} 
\#define {\bfseries G\+S\+T\+\_\+\+R\+E\+L\+E\+A\+S\+E\+\_\+\+M\+U\+T\+EX}(M\+U\+T\+EX)~Release\+Mutex ($\ast$(M\+U\+T\+EX))
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_a401d44c38ba995365716cc654d40127b}\label{_encryption_thread_pool_8c_a401d44c38ba995365716cc654d40127b}} 
typedef struct \hyperlink{struct_encryption_thread_pool_work_item_struct}{Encryption\+Thread\+Pool\+Work\+Item\+Struct} {\bfseries Encryption\+Thread\+Pool\+Work\+Item}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_encryption_thread_pool_8c_aca47798700702f0c4ea9754d539e8156}\label{_encryption_thread_pool_8c_aca47798700702f0c4ea9754d539e8156}} 
enum {\bfseries Work\+Item\+State} \{ {\bfseries Work\+Item\+Free}, 
{\bfseries Work\+Item\+Ready}, 
{\bfseries Work\+Item\+Busy}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
B\+O\+OL \hyperlink{_encryption_thread_pool_8c_a8f9b019bfe0193831080c346249213ec}{Encryption\+Thread\+Pool\+Start} (size\+\_\+t encryption\+Free\+Cpu\+Count)
\begin{DoxyCompactList}\small\item\em Start the thread pool ofr encryption. \end{DoxyCompactList}\item 
void \hyperlink{_encryption_thread_pool_8c_aff550ed963bd1be1b973b4d571b19c1e}{Encryption\+Thread\+Pool\+Stop} ()
\begin{DoxyCompactList}\small\item\em Stop the encryption pool thread. \end{DoxyCompactList}\item 
void \hyperlink{_encryption_thread_pool_8c_a981f3c0914f749f330430832c7606a6f}{Encryption\+Thread\+Pool\+Begin\+Key\+Derivation} (G\+S\+T\+\_\+\+E\+V\+E\+NT $\ast$completion\+Event, G\+S\+T\+\_\+\+E\+V\+E\+NT $\ast$no\+Outstanding\+Work\+Item\+Event, L\+O\+NG $\ast$completion\+Flag, L\+O\+NG $\ast$outstanding\+Work\+Item\+Count, int pkcs5\+Prf, char $\ast$password, int password\+Length, char $\ast$salt, int iteration\+Count, char $\ast$derived\+Key)
\begin{DoxyCompactList}\small\item\em Start the encryption key using the key chosed by the user. \end{DoxyCompactList}\item 
void \hyperlink{_encryption_thread_pool_8c_abb01516958dcdb87a96eea999242e434}{Encryption\+Thread\+Pool\+Do\+Work} (Encryption\+Thread\+Pool\+Work\+Type type, byte $\ast$data, const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$start\+Unit\+No, uint32 unit\+Count, \hyperlink{struct_c_r_y_p_t_o___i_n_f_o__t}{P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO} crypto\+Info)
\begin{DoxyCompactList}\small\item\em Start the encryption key into the thread pool. Each thread encrypt or decrypt small amount of data. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{_encryption_thread_pool_8c_a461a5a13d91d6fb689e91a37a3b67c72}{Get\+Encryption\+Thread\+Count} ()
\begin{DoxyCompactList}\small\item\em Getter for the number of thread running. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{_encryption_thread_pool_8c_a8293bdd71665ebbf9860276b6fbb2760}{Get\+Max\+Encryption\+Thread\+Count} ()
\begin{DoxyCompactList}\small\item\em Getter for the maximum Thread count define (half useless) \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_encryption_thread_pool_8c_a1396afc46dc30af3a48bdb3a1d450041}{Is\+Encryption\+Thread\+Pool\+Running} ()
\begin{DoxyCompactList}\small\item\em Getter to know if the thread pool is running. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Manage the pool that gather multiple thread that will encrypt/decrypt data. the threads use small amount data to run the whole encryption/decryption process faster. 

Copyright (c) 2008-\/2010 True\+Crypt Developers Association. All rights reserved.

Governed by the True\+Crypt License 3.\+0 the full text of which is contained in the file License.\+txt included in True\+Crypt binary and source code distribution packages.

\begin{DoxyVersion}{Version}
1.\+3.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
15/12/2016 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{_encryption_thread_pool_8c_a981f3c0914f749f330430832c7606a6f}\label{_encryption_thread_pool_8c_a981f3c0914f749f330430832c7606a6f}} 
\index{Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}!Encryption\+Thread\+Pool\+Begin\+Key\+Derivation@{Encryption\+Thread\+Pool\+Begin\+Key\+Derivation}}
\index{Encryption\+Thread\+Pool\+Begin\+Key\+Derivation@{Encryption\+Thread\+Pool\+Begin\+Key\+Derivation}!Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}}
\subsubsection{\texorpdfstring{Encryption\+Thread\+Pool\+Begin\+Key\+Derivation()}{EncryptionThreadPoolBeginKeyDerivation()}}
{\footnotesize\ttfamily void Encryption\+Thread\+Pool\+Begin\+Key\+Derivation (\begin{DoxyParamCaption}\item[{G\+S\+T\+\_\+\+E\+V\+E\+NT $\ast$}]{completion\+Event,  }\item[{G\+S\+T\+\_\+\+E\+V\+E\+NT $\ast$}]{no\+Outstanding\+Work\+Item\+Event,  }\item[{L\+O\+NG $\ast$}]{completion\+Flag,  }\item[{L\+O\+NG $\ast$}]{outstanding\+Work\+Item\+Count,  }\item[{int}]{pkcs5\+Prf,  }\item[{char $\ast$}]{password,  }\item[{int}]{password\+Length,  }\item[{char $\ast$}]{salt,  }\item[{int}]{iteration\+Count,  }\item[{char $\ast$}]{derived\+Key }\end{DoxyParamCaption})}



Start the encryption key using the key chosed by the user. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em char} & $\ast$ derived\+Key \\
\hline
\mbox{\tt in}  & {\em int} & iteration\+Count \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ salt \\
\hline
\mbox{\tt in}  & {\em int} & password\+Length \\
\hline
\mbox{\tt in}  & {\em char} & $\ast$ password \\
\hline
\mbox{\tt in}  & {\em int} & pkcs5\+Prf \\
\hline
\mbox{\tt in}  & {\em L\+O\+NG} & $\ast$ outstanding\+Work\+Item\+Count \\
\hline
\mbox{\tt in}  & {\em L\+O\+NG} & $\ast$ completion\+Flag \\
\hline
\mbox{\tt in}  & {\em G\+S\+T\+\_\+\+E\+V\+E\+NT} & $\ast$ no\+Outstanding\+Work\+Item\+Event \\
\hline
\mbox{\tt in}  & {\em G\+S\+T\+\_\+\+E\+V\+E\+NT} & $\ast$ completion\+Event \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_encryption_thread_pool_8c_a981f3c0914f749f330430832c7606a6f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_encryption_thread_pool_8c_abb01516958dcdb87a96eea999242e434}\label{_encryption_thread_pool_8c_abb01516958dcdb87a96eea999242e434}} 
\index{Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}!Encryption\+Thread\+Pool\+Do\+Work@{Encryption\+Thread\+Pool\+Do\+Work}}
\index{Encryption\+Thread\+Pool\+Do\+Work@{Encryption\+Thread\+Pool\+Do\+Work}!Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}}
\subsubsection{\texorpdfstring{Encryption\+Thread\+Pool\+Do\+Work()}{EncryptionThreadPoolDoWork()}}
{\footnotesize\ttfamily void Encryption\+Thread\+Pool\+Do\+Work (\begin{DoxyParamCaption}\item[{Encryption\+Thread\+Pool\+Work\+Type}]{type,  }\item[{byte $\ast$}]{data,  }\item[{const \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} $\ast$}]{start\+Unit\+No,  }\item[{uint32}]{unit\+Count,  }\item[{\hyperlink{struct_c_r_y_p_t_o___i_n_f_o__t}{P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO}}]{crypto\+Info }\end{DoxyParamCaption})}



Start the encryption key into the thread pool. Each thread encrypt or decrypt small amount of data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+C\+R\+Y\+P\+T\+O\+\_\+\+I\+N\+FO} & crypto\+Info \\
\hline
\mbox{\tt in}  & {\em uint32} & unit\+Count \\
\hline
\mbox{\tt in}  & {\em const} & \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{U\+I\+N\+T64\+\_\+\+S\+T\+R\+U\+CT} \\
\hline
\mbox{\tt in}  & {\em byte} & $\ast$ data \\
\hline
\mbox{\tt in}  & {\em Encryption\+Thread\+Pool\+Work\+Type} & type \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_encryption_thread_pool_8c_abb01516958dcdb87a96eea999242e434_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_encryption_thread_pool_8c_a8f9b019bfe0193831080c346249213ec}\label{_encryption_thread_pool_8c_a8f9b019bfe0193831080c346249213ec}} 
\index{Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}!Encryption\+Thread\+Pool\+Start@{Encryption\+Thread\+Pool\+Start}}
\index{Encryption\+Thread\+Pool\+Start@{Encryption\+Thread\+Pool\+Start}!Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}}
\subsubsection{\texorpdfstring{Encryption\+Thread\+Pool\+Start()}{EncryptionThreadPoolStart()}}
{\footnotesize\ttfamily B\+O\+OL Encryption\+Thread\+Pool\+Start (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{encryption\+Free\+Cpu\+Count }\end{DoxyParamCaption})}



Start the thread pool ofr encryption. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em size\+\_\+t} & encryption\+Free\+Cpu\+Count \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL T\+R\+UE if (Thread\+Pool\+Running) T\+R\+UE if (cpu\+Count $<$ 2) F\+A\+L\+SE \#else D\+E\+V\+I\+C\+E\+\_\+\+D\+R\+I\+V\+ER if (!\+Work\+Item\+Ready\+Event) F\+A\+L\+SE \#else D\+E\+V\+I\+C\+E\+\_\+\+D\+R\+I\+V\+ER if (!\+Work\+Item\+Completed\+Event) F\+A\+L\+SE \#else D\+E\+V\+I\+C\+E\+\_\+\+D\+R\+I\+V\+ER if (!\+Dequeue\+Mutex) F\+A\+L\+SE \#else D\+E\+V\+I\+C\+E\+\_\+\+D\+R\+I\+V\+ER if (!\+Enqueue\+Mutex) F\+A\+L\+SE \#else D\+E\+V\+I\+C\+E\+\_\+\+D\+R\+I\+V\+ER if (!\+Work\+Item\+Queue\mbox{[}i\mbox{]}.Item\+Completed\+Event) F\+A\+L\+SE if (!(Thread\+Handles\mbox{[}Thread\+Count\mbox{]} = (H\+A\+N\+D\+LE) \+\_\+beginthreadex (N\+U\+LL, 0, Encryption\+Thread\+Proc, N\+U\+LL, 0, N\+U\+LL))) T\+R\+UE otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{_encryption_thread_pool_8c_aff550ed963bd1be1b973b4d571b19c1e}\label{_encryption_thread_pool_8c_aff550ed963bd1be1b973b4d571b19c1e}} 
\index{Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}!Encryption\+Thread\+Pool\+Stop@{Encryption\+Thread\+Pool\+Stop}}
\index{Encryption\+Thread\+Pool\+Stop@{Encryption\+Thread\+Pool\+Stop}!Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}}
\subsubsection{\texorpdfstring{Encryption\+Thread\+Pool\+Stop()}{EncryptionThreadPoolStop()}}
{\footnotesize\ttfamily void Encryption\+Thread\+Pool\+Stop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Stop the encryption pool thread. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{_encryption_thread_pool_8c_aff550ed963bd1be1b973b4d571b19c1e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_encryption_thread_pool_8c_a461a5a13d91d6fb689e91a37a3b67c72}\label{_encryption_thread_pool_8c_a461a5a13d91d6fb689e91a37a3b67c72}} 
\index{Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}!Get\+Encryption\+Thread\+Count@{Get\+Encryption\+Thread\+Count}}
\index{Get\+Encryption\+Thread\+Count@{Get\+Encryption\+Thread\+Count}!Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}}
\subsubsection{\texorpdfstring{Get\+Encryption\+Thread\+Count()}{GetEncryptionThreadCount()}}
{\footnotesize\ttfamily size\+\_\+t Get\+Encryption\+Thread\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Getter for the number of thread running. 

\begin{DoxyReturn}{Returns}
Thread\+Pool\+Running ? Thread\+Count \+: 0 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_encryption_thread_pool_8c_a461a5a13d91d6fb689e91a37a3b67c72_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_encryption_thread_pool_8c_a8293bdd71665ebbf9860276b6fbb2760}\label{_encryption_thread_pool_8c_a8293bdd71665ebbf9860276b6fbb2760}} 
\index{Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}!Get\+Max\+Encryption\+Thread\+Count@{Get\+Max\+Encryption\+Thread\+Count}}
\index{Get\+Max\+Encryption\+Thread\+Count@{Get\+Max\+Encryption\+Thread\+Count}!Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}}
\subsubsection{\texorpdfstring{Get\+Max\+Encryption\+Thread\+Count()}{GetMaxEncryptionThreadCount()}}
{\footnotesize\ttfamily size\+\_\+t Get\+Max\+Encryption\+Thread\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Getter for the maximum Thread count define (half useless) 

\begin{DoxyReturn}{Returns}
G\+S\+T\+\_\+\+E\+N\+C\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+P\+O\+O\+L\+\_\+\+M\+A\+X\+\_\+\+T\+H\+R\+E\+A\+D\+\_\+\+C\+O\+U\+NT 
\end{DoxyReturn}
\mbox{\Hypertarget{_encryption_thread_pool_8c_a1396afc46dc30af3a48bdb3a1d450041}\label{_encryption_thread_pool_8c_a1396afc46dc30af3a48bdb3a1d450041}} 
\index{Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}!Is\+Encryption\+Thread\+Pool\+Running@{Is\+Encryption\+Thread\+Pool\+Running}}
\index{Is\+Encryption\+Thread\+Pool\+Running@{Is\+Encryption\+Thread\+Pool\+Running}!Encryption\+Thread\+Pool.\+c@{Encryption\+Thread\+Pool.\+c}}
\subsubsection{\texorpdfstring{Is\+Encryption\+Thread\+Pool\+Running()}{IsEncryptionThreadPoolRunning()}}
{\footnotesize\ttfamily B\+O\+OL Is\+Encryption\+Thread\+Pool\+Running (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Getter to know if the thread pool is running. 

\begin{DoxyReturn}{Returns}
Thread\+Pool\+Running 
\end{DoxyReturn}
