\hypertarget{_ntdriver_8c}{}\section{Driver/\+Ntdriver.c File Reference}
\label{_ntdriver_8c}\index{Driver/\+Ntdriver.\+c@{Driver/\+Ntdriver.\+c}}


The driver main functionsthat will open / mount / unload / add devices / dump memory ...  


{\ttfamily \#include \char`\"{}Gstdefs.\+h\char`\"{}}\newline
{\ttfamily \#include $<$ntddk.\+h$>$}\newline
{\ttfamily \#include \char`\"{}Crypto.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Fat.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Tests.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Endian.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Apidrvr.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Boot/\+Windows/\+Boot\+Defs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Encrypted\+Io\+Queue.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Encryption\+Thread\+Pool.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Ntdriver.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Ntvol.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Drive\+Filter.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Dump\+Filter.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Cache.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Volumes.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Volume\+Filter.\+h\char`\"{}}\newline
{\ttfamily \#include $<$tchar.\+h$>$}\newline
{\ttfamily \#include $<$initguid.\+h$>$}\newline
{\ttfamily \#include $<$mountmgr.\+h$>$}\newline
{\ttfamily \#include $<$mountdev.\+h$>$}\newline
{\ttfamily \#include $<$ntddvol.\+h$>$}\newline
Include dependency graph for Ntdriver.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_send_device_io_control_request_work_item_args}{Send\+Device\+Io\+Control\+Request\+Work\+Item\+Args}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_ntdriver_8c_a7d7e50cad024414620afc3b179e54421}\label{_ntdriver_8c_a7d7e50cad024414620afc3b179e54421}} 
\#define {\bfseries I\+O\+C\+T\+L\+\_\+\+V\+O\+L\+U\+M\+E\+\_\+\+I\+S\+\_\+\+D\+Y\+N\+A\+M\+IC}~C\+T\+L\+\_\+\+C\+O\+DE(I\+O\+C\+T\+L\+\_\+\+V\+O\+L\+U\+M\+E\+\_\+\+B\+A\+SE, 18, M\+E\+T\+H\+O\+D\+\_\+\+B\+U\+F\+F\+E\+R\+ED, F\+I\+L\+E\+\_\+\+A\+N\+Y\+\_\+\+A\+C\+C\+E\+SS)
\item 
\mbox{\Hypertarget{_ntdriver_8c_ada3df0c0ebf4234efc276ecfa144e840}\label{_ntdriver_8c_ada3df0c0ebf4234efc276ecfa144e840}} 
\#define {\bfseries Ps\+Dereference\+Primary\+Token}
\item 
\mbox{\Hypertarget{_ntdriver_8c_af425957afb384370fdc53f769fceceb8}\label{_ntdriver_8c_af425957afb384370fdc53f769fceceb8}} 
\#define {\bfseries Ps\+Dereference\+Impersonation\+Token}~Ps\+Dereference\+Impersonation\+TokenD
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a4ed7faf004ab5dee6ce9d9b019cda097}{Driver\+Entry} (P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT Driver\+Object, P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG Registry\+Path)
\begin{DoxyCompactList}\small\item\em Load dump filter if the main driver is already loaded Enable device class filters and load boot arguments if the driver is set to start at system boot. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a294446bb36d4fe3b532c65195ee4fa95}{Driver\+Add\+Device} (P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT driver\+Object, P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT pdo)
\begin{DoxyCompactList}\small\item\em Add a device to the driver object. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a7643fab9897b1c1c68b150aa5ec00adf}{Dump\+Memory} (void $\ast$mem, int size)
\begin{DoxyCompactList}\small\item\em Dumps a memory region to debug output. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_a931a50c701d04fe4afe0cebfc37ad49b}{Validate\+I\+O\+Buffer\+Size} (P\+I\+RP irp, size\+\_\+t required\+Buffer\+Size, Validate\+I\+O\+Buffer\+Size\+Type type)
\begin{DoxyCompactList}\small\item\em Validate the buffer size and return T\+R\+UE if the required\+Buffer\+Size argument is good. \end{DoxyCompactList}\item 
P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT \hyperlink{_ntdriver_8c_ae4ed6e3434035783b9b9ad1e48b2666c}{Get\+Virtual\+Volume\+Device\+Object} (int drive\+Number)
\begin{DoxyCompactList}\small\item\em Getter for Virtual\+Volume\+Device\+Objects\mbox{[}drive\+Number\mbox{]}. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_aa2ad3d74581504a31273a0903d590a4f}{G\+S\+T\+Dispatch\+Queue\+I\+RP} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Device\+Object, P\+I\+RP Irp)
\begin{DoxyCompactList}\small\item\em G\+S\+T\+Dispatch\+Queue\+I\+RP queues any I\+RP\textquotesingle{}s so that they can be processed later by the thread -- or in some cases handles them immediately! \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_aa10b14164f1d0712291fe8259abe7183}{G\+S\+T\+Create\+Root\+Device\+Object} (P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT Driver\+Object)
\begin{DoxyCompactList}\small\item\em Create the root Device Object that will contain. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a6b5e439a815cfb0c2d8378cd33bddf29}{G\+S\+T\+Create\+Device\+Object} (P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT Driver\+Object, P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT $\ast$pp\+Device\+Object, M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$mount)
\begin{DoxyCompactList}\small\item\em Create device object and return success. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_af78b98aec8aa38fc4dd9d4a70a98e956}{Root\+Device\+Control\+Mutex\+Acquire\+No\+Wait} ()
\begin{DoxyCompactList}\small\item\em Control the mutex without waiting (timeout = 0) \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a9ac189e3fd56279212ac4ba91f6a235c}{Root\+Device\+Control\+Mutex\+Release} ()
\begin{DoxyCompactList}\small\item\em Release the control on the mutex. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_ae162ac95122b0275c3e73299278d1eac}{Process\+Volume\+Device\+Control\+Irp} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Device\+Object, \hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON} Extension, P\+I\+RP Irp)
\begin{DoxyCompactList}\small\item\em Depending on the control code of the irp process the associated actions. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_ab5e2d88a5092ae3bea4ba5ff720f9db4}{Process\+Main\+Device\+Control\+Irp} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Device\+Object, \hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON} Extension, P\+I\+RP Irp)
\begin{DoxyCompactList}\small\item\em Process the main actions for the control irp code. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a7a41edc37a5c2d6cb067ac757bbc3d7a}{G\+S\+T\+Start\+Thread} (P\+K\+S\+T\+A\+R\+T\+\_\+\+R\+O\+U\+T\+I\+NE thread\+Proc, P\+V\+O\+ID thread\+Arg, P\+K\+T\+H\+R\+E\+AD $\ast$k\+Thread)
\begin{DoxyCompactList}\small\item\em Start a gst thread. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a7aa081fdeb363607cc2412fd0cf95a50}{G\+S\+T\+Start\+Thread\+In\+Process} (P\+K\+S\+T\+A\+R\+T\+\_\+\+R\+O\+U\+T\+I\+NE thread\+Proc, P\+V\+O\+ID thread\+Arg, P\+K\+T\+H\+R\+E\+AD $\ast$k\+Thread, P\+E\+P\+R\+O\+C\+E\+SS process)
\begin{DoxyCompactList}\small\item\em Start thread in a specified process. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a5ca3f8990dc42845329a2980d52af362}{G\+S\+T\+Stop\+Thread} (P\+K\+T\+H\+R\+E\+AD k\+Thread, P\+K\+E\+V\+E\+NT wake\+Up\+Event)
\begin{DoxyCompactList}\small\item\em If wake up event \+: wake up the thread in argument. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a2080f23f9794d1d0c359bf01ea21cc0f}{G\+S\+T\+Start\+Volume\+Thread} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Device\+Object, \hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON} Extension, M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$mount)
\begin{DoxyCompactList}\small\item\em Start a volume thread. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a246ba71449c5e365c3773d21319935bb}{G\+S\+T\+Stop\+Volume\+Thread} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Device\+Object, \hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON} Extension)
\begin{DoxyCompactList}\small\item\em Stop a voulme thread. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_ac900747ef92b17a76cfa1da73e2713e6}{G\+S\+T\+Sleep} (int milli\+Seconds)
\begin{DoxyCompactList}\small\item\em Suspend current thread for a number of milliseconds. \end{DoxyCompactList}\item 
V\+O\+ID \hyperlink{_ntdriver_8c_af3838e14b1df05975762da5cd4d0d710}{Volume\+Thread\+Proc} (P\+V\+O\+ID Context)
\begin{DoxyCompactList}\small\item\em Volume\+Thread\+Proc does all the work of processing I\+RP\textquotesingle{}s, and dispatching them to either the Read\+Write function or the Device\+Control function. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a44372ad99b9c0e1d1a19dcc619373509}{G\+S\+T\+Get\+N\+T\+Name\+From\+Number} (L\+P\+W\+S\+TR ntname, int n\+Drive\+No)
\begin{DoxyCompactList}\small\item\em Update ntname argument to the name of the drivenumber. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a457a75740ed78809ed29a0c6c00f5ff5}{G\+S\+T\+Get\+Dos\+Name\+From\+Number} (L\+P\+W\+S\+TR dosname, int n\+Drive\+No)
\begin{DoxyCompactList}\small\item\em Update dosname argument to the name of the drivenumber. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_ac0dd1f50927ddd3f2c39151af376ebe8}{G\+S\+T\+Delete\+Device\+Object} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Device\+Object, \hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON} Extension)
\begin{DoxyCompactList}\small\item\em Delete a device object. \end{DoxyCompactList}\item 
V\+O\+ID \hyperlink{_ntdriver_8c_a71ecef9939cec3ebe32b53b0dc2fe16b}{G\+S\+T\+Unload\+Driver} (P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT Driver\+Object)
\begin{DoxyCompactList}\small\item\em Unload a driver. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a02992ce4250a7a592cddf71d4b3b5b74}{On\+Shutdown\+Pending} ()
\begin{DoxyCompactList}\small\item\em Unmount the root device object and ignore open files also unmount hidden volumes. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a80290d94f2e5a3a545843367057a3b91}{G\+S\+T\+Device\+Io\+Control} (P\+W\+S\+TR device\+Name, U\+L\+O\+NG Io\+Control\+Code, void $\ast$Input\+Buffer, U\+L\+O\+NG Input\+Buffer\+Size, void $\ast$Output\+Buffer, U\+L\+O\+NG Output\+Buffer\+Size)
\begin{DoxyCompactList}\small\item\em Build a control request for the device and send it, return the ntstatus to the specified device in argument, wake up the thread for this device. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_ac5f43ed33bcbea31d95845b2822734df}{Send\+Device\+Io\+Control\+Request} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT device\+Object, U\+L\+O\+NG io\+Control\+Code, void $\ast$input\+Buffer, int input\+Buffer\+Size, void $\ast$output\+Buffer, int output\+Buffer\+Size)
\begin{DoxyCompactList}\small\item\em Send the request control device. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a2ddc9368d2ada4f3387124846160e119}{Probe\+Real\+Drive\+Size} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT drive\+Device\+Object, L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER $\ast$drive\+Size)
\begin{DoxyCompactList}\small\item\em Dump the real drive size. Containing the size of the hidden bytes. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a88334e2f980038d4309e8bb87105af6f}{G\+S\+T\+Open\+Fs\+Volume} (\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON} Extension, P\+H\+A\+N\+D\+LE volume\+Handle, P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT $\ast$file\+Object)
\begin{DoxyCompactList}\small\item\em Open file volume object. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a6c5f2639180b30d1232257caacef1153}{G\+S\+T\+Close\+Fs\+Volume} (H\+A\+N\+D\+LE volume\+Handle, P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT file\+Object)
\begin{DoxyCompactList}\small\item\em Close file volume object. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_ac88b9cffd64c55dc13b923f8c883e3c3}{G\+S\+T\+Read\+Device} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT device\+Object, P\+V\+O\+ID buffer, L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER offset, U\+L\+O\+NG length)
\begin{DoxyCompactList}\small\item\em Read device. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a0e6e8a07fc51935727cfd065baf7011b}{G\+S\+T\+Write\+Device} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT device\+Object, P\+V\+O\+ID buffer, L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER offset, U\+L\+O\+NG length)
\begin{DoxyCompactList}\small\item\em Write device. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_ae8462f71827de8d7e4db488202009064}{G\+S\+T\+Fsctl\+Call} (P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT file\+Object, L\+O\+NG Io\+Control\+Code, void $\ast$Input\+Buffer, int Input\+Buffer\+Size, void $\ast$Output\+Buffer, int Output\+Buffer\+Size)
\begin{DoxyCompactList}\small\item\em call the driver with a file\+Object \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a0cc5f231e8ace68008d917ef12509f05}{Create\+Drive\+Link} (int n\+Dos\+Drive\+No)
\begin{DoxyCompactList}\small\item\em Create a link to the drive. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_aa82b230002079a711b7807bec1a53d87}{Remove\+Drive\+Link} (int n\+Dos\+Drive\+No)
\begin{DoxyCompactList}\small\item\em Remove the link from the drive. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a5ea310c4e6c8670b8d43b7d819a5bdc9}{Mount\+Manager\+Mount} (M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$mount)
\begin{DoxyCompactList}\small\item\em Mount the manager to mount. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a5dde1082ce2a10e5ec09516821ef27d0}{Mount\+Manager\+Unmount} (int n\+Dos\+Drive\+No)
\begin{DoxyCompactList}\small\item\em Mount the manager to unmount. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a8affa3709b2c9bf448aaf809aa3a75d9}{Mount\+Device} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Device\+Object, M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$mount)
\begin{DoxyCompactList}\small\item\em Mount device. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a07fe905c311e84114ef385d85716f32b}{Unmount\+Device} (U\+N\+M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$unmount\+Request, P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT device\+Object, B\+O\+OL ignore\+Open\+Files)
\begin{DoxyCompactList}\small\item\em Unmount Device. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_ac32fde7dd1db3e74e7c18b51f6dbb2f7}{Unmount\+All\+Devices} (U\+N\+M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$unmount\+Request, B\+O\+OL ignore\+Open\+Files)
\begin{DoxyCompactList}\small\item\em Unmount all devices. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_ab5329d229213fca85c85e1b48b4811b6}{Symbolic\+Link\+To\+Target} (P\+W\+S\+TR symlink\+Name, P\+W\+S\+TR target\+Name, U\+S\+H\+O\+RT max\+Target\+Name\+Length)
\begin{DoxyCompactList}\small\item\em Resolves symbolic link name to its target name. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_ab9ed204547ed274601b7f4cbfe68c018}{Regions\+Overlap} (unsigned \+\_\+\+\_\+int64 start1, unsigned \+\_\+\+\_\+int64 end1, unsigned \+\_\+\+\_\+int64 start2, unsigned \+\_\+\+\_\+int64 end2)
\begin{DoxyCompactList}\small\item\em Checks if two regions overlap (borders are parts of regions) \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a1109bc2da0b19c7df466ba9c5a5e7ccf}{Get\+Intersection} (\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} start1, uint32 length1, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} start2, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} end2, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} $\ast$intersect\+Start, uint32 $\ast$intersect\+Length)
\begin{DoxyCompactList}\small\item\em Getter for the intersection start address and length. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_a37f8ca946421a5904a1bcf51eb665e3b}{Is\+Accessible\+By\+User} (P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG object\+File\+Name, B\+O\+OL read\+Only)
\begin{DoxyCompactList}\small\item\em Getter to know if the user can access the object. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_a0d693c57a6024c2a6c51c74c04acf374}{User\+Can\+Access\+Drive\+Device} ()
\begin{DoxyCompactList}\small\item\em Getter to know if the drive is accessible. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_a67d70d84dbb62dc6593fcab5b4256a38}{Is\+Drive\+Letter\+Available} (int n\+Dos\+Drive\+No)
\begin{DoxyCompactList}\small\item\em Getter to know if the letter can be taken (for the drive number) \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_aa501df752c2bdc9201d5bdad232f1022}{G\+S\+T\+Complete\+Irp} (P\+I\+RP irp, N\+T\+S\+T\+A\+T\+US status, U\+L\+O\+N\+G\+\_\+\+P\+TR information)
\begin{DoxyCompactList}\small\item\em Complete the irp packet. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a56a4eeed0b0ce7d4d77ff4cdd72679a3}{G\+S\+T\+Complete\+Disk\+Irp} (P\+I\+RP irp, N\+T\+S\+T\+A\+T\+US status, U\+L\+O\+N\+G\+\_\+\+P\+TR information)
\begin{DoxyCompactList}\small\item\em Complete a drisk irp packet. \end{DoxyCompactList}\item 
size\+\_\+t \hyperlink{_ntdriver_8c_ab4a5cff40068f455046178c665b3d517}{Get\+Cpu\+Count} ()
\begin{DoxyCompactList}\small\item\em Get the cpu count. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_a09c83e1ee8adc9940416478009d57116}{Ensure\+Null\+Terminated\+String} (wchar\+\_\+t $\ast$str, size\+\_\+t max\+Size\+In\+Bytes)
\begin{DoxyCompactList}\small\item\em Complete a string with 0. \end{DoxyCompactList}\item 
void $\ast$ \hyperlink{_ntdriver_8c_a67efc8a73141cd2c410e29e021a23176}{Allocate\+Memory\+With\+Timeout} (size\+\_\+t size, int retry\+Delay, int timeout)
\begin{DoxyCompactList}\small\item\em allocate memory with a life time \char`\"{}timeout\char`\"{} specififed \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_aabfc9cc30ca383e6ccbf12a9ff341e03}{G\+S\+T\+Read\+Registry\+Key} (P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG key\+Path, wchar\+\_\+t $\ast$key\+Value\+Name, P\+K\+E\+Y\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+A\+R\+T\+I\+A\+L\+\_\+\+I\+N\+F\+O\+R\+M\+A\+T\+I\+ON $\ast$key\+Data)
\begin{DoxyCompactList}\small\item\em Read a windows registry key. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a134aef1f40d68d99218fe2648215c79e}{G\+S\+T\+Write\+Registry\+Key} (P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG key\+Path, wchar\+\_\+t $\ast$key\+Value\+Name, U\+L\+O\+NG key\+Value\+Type, void $\ast$value\+Data, U\+L\+O\+NG value\+Size)
\begin{DoxyCompactList}\small\item\em Write (for) a windows registry key. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_a21cb8aa6d59015a21ad0dc44bf0d8eed}{Is\+Volume\+Class\+Filter\+Registered} ()
\begin{DoxyCompactList}\small\item\em Check if the volume class exists. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_ae38cc37a46c511120730110455d222f7}{Read\+Registry\+Config\+Flags} (B\+O\+OL driver\+Entry)
\begin{DoxyCompactList}\small\item\em Read registry configuration flags. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a80eda945e51eb334e259093d5f8927c4}{Write\+Registry\+Config\+Flags} (uint32 flags)
\begin{DoxyCompactList}\small\item\em Write the registry conig flags. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a0833d491275e43dd1669efc77565bba6}{Get\+Device\+Sector\+Size} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT device\+Object, U\+L\+O\+NG $\ast$bytes\+Per\+Sector)
\begin{DoxyCompactList}\small\item\em Get the device sector sizes. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_aa95e0ea1d500cdd5c7195ab9faf6cb79}{Zero\+Unreadable\+Sectors} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT device\+Object, L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER start\+Offset, U\+L\+O\+NG size, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} $\ast$zeroed\+Sector\+Count)
\begin{DoxyCompactList}\small\item\em Return the number of sectors unreadable in zeroed\+Sector\+Count. \end{DoxyCompactList}\item 
N\+T\+S\+T\+A\+T\+US \hyperlink{_ntdriver_8c_a1299bf2a3dce07e3282c31419ec9f044}{Read\+Device\+Skip\+Unreadable\+Sectors} (P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT device\+Object, byte $\ast$buffer, L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER start\+Offset, U\+L\+O\+NG size, \hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} $\ast$bad\+Sector\+Count)
\begin{DoxyCompactList}\small\item\em Read a device and skip unreadable sectors so the read doesn\textquotesingle{}t stop at the first unreadable sector but still continue. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_abf10fc1ae5d4df3a894e883073dde32c}{Is\+Volume\+Accessible\+By\+Current\+User} (\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON} volume\+Device\+Extension)
\begin{DoxyCompactList}\small\item\em Getter to know if the user can access the volume. \end{DoxyCompactList}\item 
void \hyperlink{_ntdriver_8c_ad418e5099af5d333fdd1933b796a1b2a}{Get\+Elapsed\+Time\+Init} (L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER $\ast$last\+Perf\+Counter)
\begin{DoxyCompactList}\small\item\em Getter for the time initialisation to know how many time passed. \end{DoxyCompactList}\item 
int64 \hyperlink{_ntdriver_8c_a711c6dc81aaafd64a4e3a23fb5760c2f}{Get\+Elapsed\+Time} (L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER $\ast$last\+Perf\+Counter)
\begin{DoxyCompactList}\small\item\em Returns elapsed time in microseconds since last call. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_ntdriver_8c_afc9ef476cf0475d4fbcd18be407842ff}{Is\+O\+S\+At\+Least} (O\+S\+Version\+Enum req\+Min\+OS)
\begin{DoxyCompactList}\small\item\em Check if the os is at least req\+Min\+OS. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT \hyperlink{_ntdriver_8c_af72aebf193624c80200cf120be3adf4e}{G\+S\+T\+Driver\+Object}
\item 
\mbox{\Hypertarget{_ntdriver_8c_a4a340e0a2c40f934ff3a43d08b0ab37d}\label{_ntdriver_8c_a4a340e0a2c40f934ff3a43d08b0ab37d}} 
P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT {\bfseries Root\+Device\+Object} = N\+U\+LL
\item 
\mbox{\Hypertarget{_ntdriver_8c_a49dd4fcb203001f87271c5503a0a3199}\label{_ntdriver_8c_a49dd4fcb203001f87271c5503a0a3199}} 
B\+O\+OL {\bfseries Driver\+Shutting\+Down} = F\+A\+L\+SE
\item 
\mbox{\Hypertarget{_ntdriver_8c_a526c5a274be4dc33beed5ff5c4d53266}\label{_ntdriver_8c_a526c5a274be4dc33beed5ff5c4d53266}} 
B\+O\+OL {\bfseries Self\+Tests\+Passed}
\item 
\mbox{\Hypertarget{_ntdriver_8c_ac5ba6d99f0363ef5e1e1f1ca79c756fe}\label{_ntdriver_8c_ac5ba6d99f0363ef5e1e1f1ca79c756fe}} 
int {\bfseries Last\+Unique\+Volume\+Id}
\item 
\mbox{\Hypertarget{_ntdriver_8c_ab17729f882796770e3d2273ac5cc675a}\label{_ntdriver_8c_ab17729f882796770e3d2273ac5cc675a}} 
U\+L\+O\+NG {\bfseries Os\+Major\+Version} = 0
\item 
\mbox{\Hypertarget{_ntdriver_8c_ad116784d12a9d08af3c5b8ad0c9ba571}\label{_ntdriver_8c_ad116784d12a9d08af3c5b8ad0c9ba571}} 
U\+L\+O\+NG {\bfseries Os\+Minor\+Version}
\item 
\mbox{\Hypertarget{_ntdriver_8c_a6308c573e0588a8e2c5039c5d90c3e2a}\label{_ntdriver_8c_a6308c573e0588a8e2c5039c5d90c3e2a}} 
B\+O\+OL {\bfseries Driver\+Unload\+Disabled} = F\+A\+L\+SE
\item 
\mbox{\Hypertarget{_ntdriver_8c_a6dfe4388cba596ff9b86f15295711ed2}\label{_ntdriver_8c_a6dfe4388cba596ff9b86f15295711ed2}} 
B\+O\+OL {\bfseries Portable\+Mode} = F\+A\+L\+SE
\item 
\mbox{\Hypertarget{_ntdriver_8c_a2be4a26b9bdc77d59935e686d90ad70a}\label{_ntdriver_8c_a2be4a26b9bdc77d59935e686d90ad70a}} 
B\+O\+OL {\bfseries Volume\+Class\+Filter\+Registered} = F\+A\+L\+SE
\item 
\mbox{\Hypertarget{_ntdriver_8c_abc395c089b93d766e9193329b6b7c7e6}\label{_ntdriver_8c_abc395c089b93d766e9193329b6b7c7e6}} 
B\+O\+OL {\bfseries Cache\+Boot\+Password} = F\+A\+L\+SE
\item 
\mbox{\Hypertarget{_ntdriver_8c_ab99412f2847ea9899266ba3cc721317c}\label{_ntdriver_8c_ab99412f2847ea9899266ba3cc721317c}} 
B\+O\+OL {\bfseries Non\+Admin\+System\+Favorites\+Access\+Disabled} = F\+A\+L\+SE
\item 
\mbox{\Hypertarget{_ntdriver_8c_ad85558e89cb824986d3661fe21aaaa43}\label{_ntdriver_8c_ad85558e89cb824986d3661fe21aaaa43}} 
P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT {\bfseries Virtual\+Volume\+Device\+Objects} \mbox{[}M\+A\+X\+\_\+\+M\+O\+U\+N\+T\+E\+D\+\_\+\+V\+O\+L\+U\+M\+E\+\_\+\+D\+R\+I\+V\+E\+\_\+\+N\+U\+M\+B\+ER+1\mbox{]}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The driver main functionsthat will open / mount / unload / add devices / dump memory ... 

\begin{DoxyVersion}{Version}
1.\+3.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
13/12/2016 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{_ntdriver_8c_a67efc8a73141cd2c410e29e021a23176}\label{_ntdriver_8c_a67efc8a73141cd2c410e29e021a23176}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Allocate\+Memory\+With\+Timeout@{Allocate\+Memory\+With\+Timeout}}
\index{Allocate\+Memory\+With\+Timeout@{Allocate\+Memory\+With\+Timeout}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Allocate\+Memory\+With\+Timeout()}{AllocateMemoryWithTimeout()}}
{\footnotesize\ttfamily void $\ast$ Allocate\+Memory\+With\+Timeout (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{size,  }\item[{int}]{retry\+Delay,  }\item[{int}]{timeout }\end{DoxyParamCaption})}



allocate memory with a life time \char`\"{}timeout\char`\"{} specififed 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & timeout \\
\hline
\mbox{\tt in}  & {\em int} & retry\+Delay \\
\hline
\mbox{\tt in}  & {\em size\+\_\+t} & size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void $\ast$ 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a0cc5f231e8ace68008d917ef12509f05}\label{_ntdriver_8c_a0cc5f231e8ace68008d917ef12509f05}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Create\+Drive\+Link@{Create\+Drive\+Link}}
\index{Create\+Drive\+Link@{Create\+Drive\+Link}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Create\+Drive\+Link()}{CreateDriveLink()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Create\+Drive\+Link (\begin{DoxyParamCaption}\item[{int}]{n\+Dos\+Drive\+No }\end{DoxyParamCaption})}



Create a link to the drive. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n\+Dos\+Drive\+No \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US nt\+Status 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a0cc5f231e8ace68008d917ef12509f05_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a294446bb36d4fe3b532c65195ee4fa95}\label{_ntdriver_8c_a294446bb36d4fe3b532c65195ee4fa95}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Driver\+Add\+Device@{Driver\+Add\+Device}}
\index{Driver\+Add\+Device@{Driver\+Add\+Device}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Driver\+Add\+Device()}{DriverAddDevice()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Driver\+Add\+Device (\begin{DoxyParamCaption}\item[{P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT}]{driver\+Object,  }\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{pdo }\end{DoxyParamCaption})}



Add a device to the driver object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & pdo \\
\hline
\mbox{\tt in}  & {\em P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT} & driver\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US Drive\+Filter\+Add\+Device (driver\+Object, pdo) 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a294446bb36d4fe3b532c65195ee4fa95_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a4ed7faf004ab5dee6ce9d9b019cda097}\label{_ntdriver_8c_a4ed7faf004ab5dee6ce9d9b019cda097}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Driver\+Entry@{Driver\+Entry}}
\index{Driver\+Entry@{Driver\+Entry}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Driver\+Entry()}{DriverEntry()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Driver\+Entry (\begin{DoxyParamCaption}\item[{P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT}]{Driver\+Object,  }\item[{P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG}]{Registry\+Path }\end{DoxyParamCaption})}



Load dump filter if the main driver is already loaded Enable device class filters and load boot arguments if the driver is set to start at system boot. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG} & Registry\+Path \\
\hline
\mbox{\tt in}  & {\em P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT} & Driver\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US G\+S\+T\+Create\+Root\+Device\+Object (Driver\+Object) 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a7643fab9897b1c1c68b150aa5ec00adf}\label{_ntdriver_8c_a7643fab9897b1c1c68b150aa5ec00adf}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Dump\+Memory@{Dump\+Memory}}
\index{Dump\+Memory@{Dump\+Memory}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Dump\+Memory()}{DumpMemory()}}
{\footnotesize\ttfamily void Dump\+Memory (\begin{DoxyParamCaption}\item[{void $\ast$}]{mem,  }\item[{int}]{size }\end{DoxyParamCaption})}



Dumps a memory region to debug output. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & size \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ mem \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a09c83e1ee8adc9940416478009d57116}\label{_ntdriver_8c_a09c83e1ee8adc9940416478009d57116}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Ensure\+Null\+Terminated\+String@{Ensure\+Null\+Terminated\+String}}
\index{Ensure\+Null\+Terminated\+String@{Ensure\+Null\+Terminated\+String}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Ensure\+Null\+Terminated\+String()}{EnsureNullTerminatedString()}}
{\footnotesize\ttfamily void Ensure\+Null\+Terminated\+String (\begin{DoxyParamCaption}\item[{wchar\+\_\+t $\ast$}]{str,  }\item[{size\+\_\+t}]{max\+Size\+In\+Bytes }\end{DoxyParamCaption})}



Complete a string with 0. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em size\+\_\+t} & max\+Size\+In\+Bytes \\
\hline
\mbox{\tt in}  & {\em wchar\+\_\+t} & $\ast$ str \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_ab4a5cff40068f455046178c665b3d517}\label{_ntdriver_8c_ab4a5cff40068f455046178c665b3d517}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Get\+Cpu\+Count@{Get\+Cpu\+Count}}
\index{Get\+Cpu\+Count@{Get\+Cpu\+Count}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Get\+Cpu\+Count()}{GetCpuCount()}}
{\footnotesize\ttfamily size\+\_\+t Get\+Cpu\+Count (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Get the cpu count. 

\begin{DoxyReturn}{Returns}
1 if cpu\+Count == 0, cpu\+Count else 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a0833d491275e43dd1669efc77565bba6}\label{_ntdriver_8c_a0833d491275e43dd1669efc77565bba6}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Get\+Device\+Sector\+Size@{Get\+Device\+Sector\+Size}}
\index{Get\+Device\+Sector\+Size@{Get\+Device\+Sector\+Size}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Get\+Device\+Sector\+Size()}{GetDeviceSectorSize()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Get\+Device\+Sector\+Size (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{device\+Object,  }\item[{U\+L\+O\+NG $\ast$}]{bytes\+Per\+Sector }\end{DoxyParamCaption})}



Get the device sector sizes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em U\+L\+O\+NG} & $\ast$ bytes\+Per\+Sector \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+S\+U\+C\+C\+E\+SS if success status otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a0833d491275e43dd1669efc77565bba6_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=343pt]{_ntdriver_8c_a0833d491275e43dd1669efc77565bba6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a711c6dc81aaafd64a4e3a23fb5760c2f}\label{_ntdriver_8c_a711c6dc81aaafd64a4e3a23fb5760c2f}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Get\+Elapsed\+Time@{Get\+Elapsed\+Time}}
\index{Get\+Elapsed\+Time@{Get\+Elapsed\+Time}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Get\+Elapsed\+Time()}{GetElapsedTime()}}
{\footnotesize\ttfamily int64 Get\+Elapsed\+Time (\begin{DoxyParamCaption}\item[{L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER $\ast$}]{last\+Perf\+Counter }\end{DoxyParamCaption})}



Returns elapsed time in microseconds since last call. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER} & $\ast$ last\+Perf\+Counter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
int64 elapsed 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a711c6dc81aaafd64a4e3a23fb5760c2f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_ad418e5099af5d333fdd1933b796a1b2a}\label{_ntdriver_8c_ad418e5099af5d333fdd1933b796a1b2a}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Get\+Elapsed\+Time\+Init@{Get\+Elapsed\+Time\+Init}}
\index{Get\+Elapsed\+Time\+Init@{Get\+Elapsed\+Time\+Init}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Get\+Elapsed\+Time\+Init()}{GetElapsedTimeInit()}}
{\footnotesize\ttfamily void Get\+Elapsed\+Time\+Init (\begin{DoxyParamCaption}\item[{L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER $\ast$}]{last\+Perf\+Counter }\end{DoxyParamCaption})}



Getter for the time initialisation to know how many time passed. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER} & $\ast$ last\+Perf\+Counter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a1109bc2da0b19c7df466ba9c5a5e7ccf}\label{_ntdriver_8c_a1109bc2da0b19c7df466ba9c5a5e7ccf}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Get\+Intersection@{Get\+Intersection}}
\index{Get\+Intersection@{Get\+Intersection}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Get\+Intersection()}{GetIntersection()}}
{\footnotesize\ttfamily void Get\+Intersection (\begin{DoxyParamCaption}\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64}}]{start1,  }\item[{uint32}]{length1,  }\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64}}]{start2,  }\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64}}]{end2,  }\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} $\ast$}]{intersect\+Start,  }\item[{uint32 $\ast$}]{intersect\+Length }\end{DoxyParamCaption})}



Getter for the intersection start address and length. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uint32} & $\ast$ intersect\+Length \\
\hline
\mbox{\tt in}  & {\em uint64} & $\ast$ intersect\+Start \\
\hline
\mbox{\tt in}  & {\em uint64} & end2 \\
\hline
\mbox{\tt in}  & {\em uint64} & start2 \\
\hline
\mbox{\tt in}  & {\em uint32} & length1 \\
\hline
\mbox{\tt in}  & {\em uint64} & start1 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_ae4ed6e3434035783b9b9ad1e48b2666c}\label{_ntdriver_8c_ae4ed6e3434035783b9b9ad1e48b2666c}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Get\+Virtual\+Volume\+Device\+Object@{Get\+Virtual\+Volume\+Device\+Object}}
\index{Get\+Virtual\+Volume\+Device\+Object@{Get\+Virtual\+Volume\+Device\+Object}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Get\+Virtual\+Volume\+Device\+Object()}{GetVirtualVolumeDeviceObject()}}
{\footnotesize\ttfamily P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Get\+Virtual\+Volume\+Device\+Object (\begin{DoxyParamCaption}\item[{int}]{drive\+Number }\end{DoxyParamCaption})}



Getter for Virtual\+Volume\+Device\+Objects\mbox{[}drive\+Number\mbox{]}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & drive\+Number \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT Virtual\+Volume\+Device\+Objects\mbox{[}drive\+Number\mbox{]} N\+U\+LL else 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a6c5f2639180b30d1232257caacef1153}\label{_ntdriver_8c_a6c5f2639180b30d1232257caacef1153}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Close\+Fs\+Volume@{G\+S\+T\+Close\+Fs\+Volume}}
\index{G\+S\+T\+Close\+Fs\+Volume@{G\+S\+T\+Close\+Fs\+Volume}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Close\+Fs\+Volume()}{GSTCloseFsVolume()}}
{\footnotesize\ttfamily void G\+S\+T\+Close\+Fs\+Volume (\begin{DoxyParamCaption}\item[{H\+A\+N\+D\+LE}]{volume\+Handle,  }\item[{P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT}]{file\+Object }\end{DoxyParamCaption})}



Close file volume object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT} & file\+Object \\
\hline
\mbox{\tt in}  & {\em H\+A\+N\+D\+LE} & volume\+Handle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a56a4eeed0b0ce7d4d77ff4cdd72679a3}\label{_ntdriver_8c_a56a4eeed0b0ce7d4d77ff4cdd72679a3}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Complete\+Disk\+Irp@{G\+S\+T\+Complete\+Disk\+Irp}}
\index{G\+S\+T\+Complete\+Disk\+Irp@{G\+S\+T\+Complete\+Disk\+Irp}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Complete\+Disk\+Irp()}{GSTCompleteDiskIrp()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Complete\+Disk\+Irp (\begin{DoxyParamCaption}\item[{P\+I\+RP}]{irp,  }\item[{N\+T\+S\+T\+A\+T\+US}]{status,  }\item[{U\+L\+O\+N\+G\+\_\+\+P\+TR}]{information }\end{DoxyParamCaption})}



Complete a drisk irp packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em U\+L\+O\+N\+G\+\_\+\+P\+TR} & information \\
\hline
\mbox{\tt in}  & {\em N\+T\+S\+T\+A\+T\+US} & status \\
\hline
\mbox{\tt in}  & {\em P\+I\+RP} & irp \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US status 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a56a4eeed0b0ce7d4d77ff4cdd72679a3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_aa501df752c2bdc9201d5bdad232f1022}\label{_ntdriver_8c_aa501df752c2bdc9201d5bdad232f1022}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Complete\+Irp@{G\+S\+T\+Complete\+Irp}}
\index{G\+S\+T\+Complete\+Irp@{G\+S\+T\+Complete\+Irp}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Complete\+Irp()}{GSTCompleteIrp()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Complete\+Irp (\begin{DoxyParamCaption}\item[{P\+I\+RP}]{irp,  }\item[{N\+T\+S\+T\+A\+T\+US}]{status,  }\item[{U\+L\+O\+N\+G\+\_\+\+P\+TR}]{information }\end{DoxyParamCaption})}



Complete the irp packet. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em U\+L\+O\+N\+G\+\_\+\+P\+TR} & information \\
\hline
\mbox{\tt in}  & {\em N\+T\+S\+T\+A\+T\+US} & status \\
\hline
\mbox{\tt in}  & {\em P\+I\+RP} & irp \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US status 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a6b5e439a815cfb0c2d8378cd33bddf29}\label{_ntdriver_8c_a6b5e439a815cfb0c2d8378cd33bddf29}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Create\+Device\+Object@{G\+S\+T\+Create\+Device\+Object}}
\index{G\+S\+T\+Create\+Device\+Object@{G\+S\+T\+Create\+Device\+Object}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Create\+Device\+Object()}{GSTCreateDeviceObject()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Create\+Device\+Object (\begin{DoxyParamCaption}\item[{P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT}]{Driver\+Object,  }\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT $\ast$}]{pp\+Device\+Object,  }\item[{M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$}]{mount }\end{DoxyParamCaption})}



Create device object and return success. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT} & Driver\+Object \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & $\ast$ pp\+Device\+Object \\
\hline
\mbox{\tt in}  & {\em M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT} & $\ast$ mount \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+S\+U\+C\+C\+E\+SS if success nt\+Status otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a6b5e439a815cfb0c2d8378cd33bddf29_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_aa10b14164f1d0712291fe8259abe7183}\label{_ntdriver_8c_aa10b14164f1d0712291fe8259abe7183}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Create\+Root\+Device\+Object@{G\+S\+T\+Create\+Root\+Device\+Object}}
\index{G\+S\+T\+Create\+Root\+Device\+Object@{G\+S\+T\+Create\+Root\+Device\+Object}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Create\+Root\+Device\+Object()}{GSTCreateRootDeviceObject()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Create\+Root\+Device\+Object (\begin{DoxyParamCaption}\item[{P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT}]{Driver\+Object }\end{DoxyParamCaption})}



Create the root Device Object that will contain. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT} & Driver\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+S\+U\+C\+C\+E\+SS if success nt\+Status otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_ac0dd1f50927ddd3f2c39151af376ebe8}\label{_ntdriver_8c_ac0dd1f50927ddd3f2c39151af376ebe8}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Delete\+Device\+Object@{G\+S\+T\+Delete\+Device\+Object}}
\index{G\+S\+T\+Delete\+Device\+Object@{G\+S\+T\+Delete\+Device\+Object}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Delete\+Device\+Object()}{GSTDeleteDeviceObject()}}
{\footnotesize\ttfamily void G\+S\+T\+Delete\+Device\+Object (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{Device\+Object,  }\item[{\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON}}]{Extension }\end{DoxyParamCaption})}



Delete a device object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+E\+X\+T\+E\+N\+S\+I\+ON} & Extension \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & Device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=327pt]{_ntdriver_8c_ac0dd1f50927ddd3f2c39151af376ebe8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a80290d94f2e5a3a545843367057a3b91}\label{_ntdriver_8c_a80290d94f2e5a3a545843367057a3b91}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Device\+Io\+Control@{G\+S\+T\+Device\+Io\+Control}}
\index{G\+S\+T\+Device\+Io\+Control@{G\+S\+T\+Device\+Io\+Control}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Device\+Io\+Control()}{GSTDeviceIoControl()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Device\+Io\+Control (\begin{DoxyParamCaption}\item[{P\+W\+S\+TR}]{device\+Name,  }\item[{U\+L\+O\+NG}]{Io\+Control\+Code,  }\item[{void $\ast$}]{Input\+Buffer,  }\item[{U\+L\+O\+NG}]{Input\+Buffer\+Size,  }\item[{void $\ast$}]{Output\+Buffer,  }\item[{U\+L\+O\+NG}]{Output\+Buffer\+Size }\end{DoxyParamCaption})}



Build a control request for the device and send it, return the ntstatus to the specified device in argument, wake up the thread for this device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em U\+L\+O\+NG} & Output\+Buffer\+Size \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ Output\+Buffer \\
\hline
\mbox{\tt in}  & {\em U\+L\+O\+NG} & Input\+Buffer\+Size \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ Input\+Buffer \\
\hline
\mbox{\tt in}  & {\em U\+L\+O\+NG} & Io\+Control\+Code \\
\hline
\mbox{\tt in}  & {\em P\+W\+S\+TR} & device\+Name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US nt\+Status 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=339pt]{_ntdriver_8c_a80290d94f2e5a3a545843367057a3b91_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_aa2ad3d74581504a31273a0903d590a4f}\label{_ntdriver_8c_aa2ad3d74581504a31273a0903d590a4f}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Dispatch\+Queue\+I\+RP@{G\+S\+T\+Dispatch\+Queue\+I\+RP}}
\index{G\+S\+T\+Dispatch\+Queue\+I\+RP@{G\+S\+T\+Dispatch\+Queue\+I\+RP}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Dispatch\+Queue\+I\+R\+P()}{GSTDispatchQueueIRP()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Dispatch\+Queue\+I\+RP (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{Device\+Object,  }\item[{P\+I\+RP}]{Irp }\end{DoxyParamCaption})}



G\+S\+T\+Dispatch\+Queue\+I\+RP queues any I\+RP\textquotesingle{}s so that they can be processed later by the thread -- or in some cases handles them immediately! 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+I\+RP} & Irp \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & Device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US status depending on the irp major function C\+O\+M\+P\+L\+E\+T\+E\+\_\+\+I\+RP (Device\+Object, Irp, S\+T\+A\+T\+U\+S\+\_\+\+S\+U\+C\+C\+E\+SS, 0) G\+S\+T\+Complete\+Irp (Irp, S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+V\+A\+L\+I\+D\+\_\+\+D\+E\+V\+I\+C\+E\+\_\+\+R\+E\+Q\+U\+E\+ST, 0) 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_aa2ad3d74581504a31273a0903d590a4f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_ae8462f71827de8d7e4db488202009064}\label{_ntdriver_8c_ae8462f71827de8d7e4db488202009064}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Fsctl\+Call@{G\+S\+T\+Fsctl\+Call}}
\index{G\+S\+T\+Fsctl\+Call@{G\+S\+T\+Fsctl\+Call}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Fsctl\+Call()}{GSTFsctlCall()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Fsctl\+Call (\begin{DoxyParamCaption}\item[{P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT}]{file\+Object,  }\item[{L\+O\+NG}]{Io\+Control\+Code,  }\item[{void $\ast$}]{Input\+Buffer,  }\item[{int}]{Input\+Buffer\+Size,  }\item[{void $\ast$}]{Output\+Buffer,  }\item[{int}]{Output\+Buffer\+Size }\end{DoxyParamCaption})}



call the driver with a file\+Object 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT} & file\+Object \\
\hline
\mbox{\tt in}  & {\em L\+O\+NG} & Io\+Control\+Code \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ Input\+Buffer \\
\hline
\mbox{\tt in}  & {\em int} & Input\+Buffer\+Size \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ Output\+Buffer \\
\hline
\mbox{\tt in}  & {\em int} & Output\+Buffer\+Size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+S\+U\+F\+F\+I\+C\+I\+E\+N\+T\+\_\+\+R\+E\+S\+O\+U\+R\+C\+ES if irp == N\+U\+LL, nt\+Status else 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{_ntdriver_8c_ae8462f71827de8d7e4db488202009064_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a457a75740ed78809ed29a0c6c00f5ff5}\label{_ntdriver_8c_a457a75740ed78809ed29a0c6c00f5ff5}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Get\+Dos\+Name\+From\+Number@{G\+S\+T\+Get\+Dos\+Name\+From\+Number}}
\index{G\+S\+T\+Get\+Dos\+Name\+From\+Number@{G\+S\+T\+Get\+Dos\+Name\+From\+Number}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Get\+Dos\+Name\+From\+Number()}{GSTGetDosNameFromNumber()}}
{\footnotesize\ttfamily void G\+S\+T\+Get\+Dos\+Name\+From\+Number (\begin{DoxyParamCaption}\item[{L\+P\+W\+S\+TR}]{dosname,  }\item[{int}]{n\+Drive\+No }\end{DoxyParamCaption})}



Update dosname argument to the name of the drivenumber. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n\+Drive\+No \\
\hline
\mbox{\tt in}  & {\em L\+P\+W\+S\+TR} & dosname \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a457a75740ed78809ed29a0c6c00f5ff5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a44372ad99b9c0e1d1a19dcc619373509}\label{_ntdriver_8c_a44372ad99b9c0e1d1a19dcc619373509}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Get\+N\+T\+Name\+From\+Number@{G\+S\+T\+Get\+N\+T\+Name\+From\+Number}}
\index{G\+S\+T\+Get\+N\+T\+Name\+From\+Number@{G\+S\+T\+Get\+N\+T\+Name\+From\+Number}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Get\+N\+T\+Name\+From\+Number()}{GSTGetNTNameFromNumber()}}
{\footnotesize\ttfamily void G\+S\+T\+Get\+N\+T\+Name\+From\+Number (\begin{DoxyParamCaption}\item[{L\+P\+W\+S\+TR}]{ntname,  }\item[{int}]{n\+Drive\+No }\end{DoxyParamCaption})}



Update ntname argument to the name of the drivenumber. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n\+Drive\+No \\
\hline
\mbox{\tt in}  & {\em L\+P\+W\+S\+TR} & ntname \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a44372ad99b9c0e1d1a19dcc619373509_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a88334e2f980038d4309e8bb87105af6f}\label{_ntdriver_8c_a88334e2f980038d4309e8bb87105af6f}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Open\+Fs\+Volume@{G\+S\+T\+Open\+Fs\+Volume}}
\index{G\+S\+T\+Open\+Fs\+Volume@{G\+S\+T\+Open\+Fs\+Volume}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Open\+Fs\+Volume()}{GSTOpenFsVolume()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Open\+Fs\+Volume (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON}}]{Extension,  }\item[{P\+H\+A\+N\+D\+LE}]{volume\+Handle,  }\item[{P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT $\ast$}]{file\+Object }\end{DoxyParamCaption})}



Open file volume object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+F\+I\+L\+E\+\_\+\+O\+B\+J\+E\+CT} & $\ast$ file\+Object \\
\hline
\mbox{\tt in}  & {\em P\+H\+A\+N\+D\+LE} & volume\+Handle \\
\hline
\mbox{\tt in}  & {\em P\+E\+X\+T\+E\+N\+S\+I\+ON} & Extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US nt\+Status 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a88334e2f980038d4309e8bb87105af6f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=304pt]{_ntdriver_8c_a88334e2f980038d4309e8bb87105af6f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_ac88b9cffd64c55dc13b923f8c883e3c3}\label{_ntdriver_8c_ac88b9cffd64c55dc13b923f8c883e3c3}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Read\+Device@{G\+S\+T\+Read\+Device}}
\index{G\+S\+T\+Read\+Device@{G\+S\+T\+Read\+Device}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Read\+Device()}{GSTReadDevice()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Read\+Device (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{device\+Object,  }\item[{P\+V\+O\+ID}]{buffer,  }\item[{L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER}]{offset,  }\item[{U\+L\+O\+NG}]{length }\end{DoxyParamCaption})}



Read device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em U\+L\+O\+NG} & length \\
\hline
\mbox{\tt in}  & {\em L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER} & offset \\
\hline
\mbox{\tt in}  & {\em P\+V\+O\+ID} & buffer \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US G\+S\+T\+Read\+Write\+Device (F\+A\+L\+SE, device\+Object, buffer, offset, length) 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{_ntdriver_8c_ac88b9cffd64c55dc13b923f8c883e3c3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_aabfc9cc30ca383e6ccbf12a9ff341e03}\label{_ntdriver_8c_aabfc9cc30ca383e6ccbf12a9ff341e03}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Read\+Registry\+Key@{G\+S\+T\+Read\+Registry\+Key}}
\index{G\+S\+T\+Read\+Registry\+Key@{G\+S\+T\+Read\+Registry\+Key}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Read\+Registry\+Key()}{GSTReadRegistryKey()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Read\+Registry\+Key (\begin{DoxyParamCaption}\item[{P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG}]{key\+Path,  }\item[{wchar\+\_\+t $\ast$}]{key\+Value\+Name,  }\item[{P\+K\+E\+Y\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+A\+R\+T\+I\+A\+L\+\_\+\+I\+N\+F\+O\+R\+M\+A\+T\+I\+ON $\ast$}]{key\+Data }\end{DoxyParamCaption})}



Read a windows registry key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+K\+E\+Y\+\_\+\+V\+A\+L\+U\+E\+\_\+\+P\+A\+R\+T\+I\+A\+L\+\_\+\+I\+N\+F\+O\+R\+M\+A\+T\+I\+ON} & $\ast$ key\+Data \\
\hline
\mbox{\tt in}  & {\em wchar\+\_\+t} & $\ast$ key\+Value\+Name \\
\hline
\mbox{\tt in}  & {\em P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG} & key\+Path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+N\+O\+\_\+\+D\+A\+T\+A\+\_\+\+D\+E\+T\+E\+C\+T\+ED if no data detected S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+S\+U\+F\+F\+I\+C\+I\+E\+N\+T\+\_\+\+R\+E\+S\+O\+U\+R\+C\+ES if can\textquotesingle{}t allocate variable status otherwise 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_aabfc9cc30ca383e6ccbf12a9ff341e03_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_ac900747ef92b17a76cfa1da73e2713e6}\label{_ntdriver_8c_ac900747ef92b17a76cfa1da73e2713e6}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Sleep@{G\+S\+T\+Sleep}}
\index{G\+S\+T\+Sleep@{G\+S\+T\+Sleep}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Sleep()}{GSTSleep()}}
{\footnotesize\ttfamily void G\+S\+T\+Sleep (\begin{DoxyParamCaption}\item[{int}]{milli\+Seconds }\end{DoxyParamCaption})}



Suspend current thread for a number of milliseconds. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & milli\+Seconds \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{_ntdriver_8c_ac900747ef92b17a76cfa1da73e2713e6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a7a41edc37a5c2d6cb067ac757bbc3d7a}\label{_ntdriver_8c_a7a41edc37a5c2d6cb067ac757bbc3d7a}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Start\+Thread@{G\+S\+T\+Start\+Thread}}
\index{G\+S\+T\+Start\+Thread@{G\+S\+T\+Start\+Thread}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Start\+Thread()}{GSTStartThread()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Start\+Thread (\begin{DoxyParamCaption}\item[{P\+K\+S\+T\+A\+R\+T\+\_\+\+R\+O\+U\+T\+I\+NE}]{thread\+Proc,  }\item[{P\+V\+O\+ID}]{thread\+Arg,  }\item[{P\+K\+T\+H\+R\+E\+AD $\ast$}]{k\+Thread }\end{DoxyParamCaption})}



Start a gst thread. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+K\+T\+H\+R\+E\+AD} & $\ast$ k\+Thread \\
\hline
\mbox{\tt in}  & {\em P\+V\+O\+ID} & thread\+Arg \\
\hline
\mbox{\tt in}  & {\em P\+K\+S\+T\+A\+R\+T\+\_\+\+R\+O\+U\+T\+I\+NE} & thread\+Proc \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US G\+S\+T\+Start\+Thread\+In\+Process (thread\+Proc, thread\+Arg, k\+Thread, N\+U\+LL) 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{_ntdriver_8c_a7a41edc37a5c2d6cb067ac757bbc3d7a_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a7aa081fdeb363607cc2412fd0cf95a50}\label{_ntdriver_8c_a7aa081fdeb363607cc2412fd0cf95a50}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Start\+Thread\+In\+Process@{G\+S\+T\+Start\+Thread\+In\+Process}}
\index{G\+S\+T\+Start\+Thread\+In\+Process@{G\+S\+T\+Start\+Thread\+In\+Process}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Start\+Thread\+In\+Process()}{GSTStartThreadInProcess()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Start\+Thread\+In\+Process (\begin{DoxyParamCaption}\item[{P\+K\+S\+T\+A\+R\+T\+\_\+\+R\+O\+U\+T\+I\+NE}]{thread\+Proc,  }\item[{P\+V\+O\+ID}]{thread\+Arg,  }\item[{P\+K\+T\+H\+R\+E\+AD $\ast$}]{k\+Thread,  }\item[{P\+E\+P\+R\+O\+C\+E\+SS}]{process }\end{DoxyParamCaption})}



Start thread in a specified process. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+E\+P\+R\+O\+C\+E\+SS} & process \\
\hline
\mbox{\tt in}  & {\em P\+K\+T\+H\+R\+E\+AD} & $\ast$ k\+Thread \\
\hline
\mbox{\tt in}  & {\em P\+V\+O\+ID} & thread\+Arg \\
\hline
\mbox{\tt in}  & {\em P\+K\+S\+T\+A\+R\+T\+\_\+\+R\+O\+U\+T\+I\+NE} & thread\+Proc \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+S\+U\+C\+C\+E\+SS if success status otherwise 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{_ntdriver_8c_a7aa081fdeb363607cc2412fd0cf95a50_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a2080f23f9794d1d0c359bf01ea21cc0f}\label{_ntdriver_8c_a2080f23f9794d1d0c359bf01ea21cc0f}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Start\+Volume\+Thread@{G\+S\+T\+Start\+Volume\+Thread}}
\index{G\+S\+T\+Start\+Volume\+Thread@{G\+S\+T\+Start\+Volume\+Thread}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Start\+Volume\+Thread()}{GSTStartVolumeThread()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Start\+Volume\+Thread (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{Device\+Object,  }\item[{\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON}}]{Extension,  }\item[{M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$}]{mount }\end{DoxyParamCaption})}



Start a volume thread. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT} & $\ast$ mount \\
\hline
\mbox{\tt in}  & {\em P\+E\+X\+T\+E\+N\+S\+I\+ON} & Extension \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & Device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US nt\+Status 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{_ntdriver_8c_a2080f23f9794d1d0c359bf01ea21cc0f_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a5ca3f8990dc42845329a2980d52af362}\label{_ntdriver_8c_a5ca3f8990dc42845329a2980d52af362}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Stop\+Thread@{G\+S\+T\+Stop\+Thread}}
\index{G\+S\+T\+Stop\+Thread@{G\+S\+T\+Stop\+Thread}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Stop\+Thread()}{GSTStopThread()}}
{\footnotesize\ttfamily void G\+S\+T\+Stop\+Thread (\begin{DoxyParamCaption}\item[{P\+K\+T\+H\+R\+E\+AD}]{k\+Thread,  }\item[{P\+K\+E\+V\+E\+NT}]{wake\+Up\+Event }\end{DoxyParamCaption})}



If wake up event \+: wake up the thread in argument. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+K\+E\+V\+E\+NT} & wake\+Up\+Event \\
\hline
\mbox{\tt in}  & {\em P\+K\+T\+H\+R\+E\+AD} & k\+Thread \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=319pt]{_ntdriver_8c_a5ca3f8990dc42845329a2980d52af362_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a246ba71449c5e365c3773d21319935bb}\label{_ntdriver_8c_a246ba71449c5e365c3773d21319935bb}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Stop\+Volume\+Thread@{G\+S\+T\+Stop\+Volume\+Thread}}
\index{G\+S\+T\+Stop\+Volume\+Thread@{G\+S\+T\+Stop\+Volume\+Thread}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Stop\+Volume\+Thread()}{GSTStopVolumeThread()}}
{\footnotesize\ttfamily void G\+S\+T\+Stop\+Volume\+Thread (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{Device\+Object,  }\item[{\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON}}]{Extension }\end{DoxyParamCaption})}



Stop a voulme thread. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+E\+X\+T\+E\+N\+S\+I\+ON} & Extension \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & Device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a71ecef9939cec3ebe32b53b0dc2fe16b}\label{_ntdriver_8c_a71ecef9939cec3ebe32b53b0dc2fe16b}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Unload\+Driver@{G\+S\+T\+Unload\+Driver}}
\index{G\+S\+T\+Unload\+Driver@{G\+S\+T\+Unload\+Driver}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Unload\+Driver()}{GSTUnloadDriver()}}
{\footnotesize\ttfamily V\+O\+ID G\+S\+T\+Unload\+Driver (\begin{DoxyParamCaption}\item[{P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT}]{Driver\+Object }\end{DoxyParamCaption})}



Unload a driver. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT} & Driver\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
V\+O\+ID 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a71ecef9939cec3ebe32b53b0dc2fe16b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a0e6e8a07fc51935727cfd065baf7011b}\label{_ntdriver_8c_a0e6e8a07fc51935727cfd065baf7011b}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Write\+Device@{G\+S\+T\+Write\+Device}}
\index{G\+S\+T\+Write\+Device@{G\+S\+T\+Write\+Device}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Write\+Device()}{GSTWriteDevice()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Write\+Device (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{device\+Object,  }\item[{P\+V\+O\+ID}]{buffer,  }\item[{L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER}]{offset,  }\item[{U\+L\+O\+NG}]{length }\end{DoxyParamCaption})}



Write device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em U\+L\+O\+NG} & length \\
\hline
\mbox{\tt in}  & {\em L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER} & offset \\
\hline
\mbox{\tt in}  & {\em P\+V\+O\+ID} & buffer \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US G\+S\+T\+Read\+Write\+Device (T\+R\+UE, device\+Object, buffer, offset, length) 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{_ntdriver_8c_a0e6e8a07fc51935727cfd065baf7011b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a134aef1f40d68d99218fe2648215c79e}\label{_ntdriver_8c_a134aef1f40d68d99218fe2648215c79e}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Write\+Registry\+Key@{G\+S\+T\+Write\+Registry\+Key}}
\index{G\+S\+T\+Write\+Registry\+Key@{G\+S\+T\+Write\+Registry\+Key}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Write\+Registry\+Key()}{GSTWriteRegistryKey()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US G\+S\+T\+Write\+Registry\+Key (\begin{DoxyParamCaption}\item[{P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG}]{key\+Path,  }\item[{wchar\+\_\+t $\ast$}]{key\+Value\+Name,  }\item[{U\+L\+O\+NG}]{key\+Value\+Type,  }\item[{void $\ast$}]{value\+Data,  }\item[{U\+L\+O\+NG}]{value\+Size }\end{DoxyParamCaption})}



Write (for) a windows registry key. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em U\+L\+O\+NG} & value\+Size \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ value\+Data \\
\hline
\mbox{\tt in}  & {\em U\+L\+O\+NG} & key\+Value\+Type \\
\hline
\mbox{\tt in}  & {\em wchar\+\_\+t} & $\ast$ key\+Value\+Name \\
\hline
\mbox{\tt in}  & {\em P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG} & key\+Path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US status 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a134aef1f40d68d99218fe2648215c79e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a37f8ca946421a5904a1bcf51eb665e3b}\label{_ntdriver_8c_a37f8ca946421a5904a1bcf51eb665e3b}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Is\+Accessible\+By\+User@{Is\+Accessible\+By\+User}}
\index{Is\+Accessible\+By\+User@{Is\+Accessible\+By\+User}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Is\+Accessible\+By\+User()}{IsAccessibleByUser()}}
{\footnotesize\ttfamily B\+O\+OL Is\+Accessible\+By\+User (\begin{DoxyParamCaption}\item[{P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG}]{object\+File\+Name,  }\item[{B\+O\+OL}]{read\+Only }\end{DoxyParamCaption})}



Getter to know if the user can access the object. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B\+O\+OL} & read\+Only \\
\hline
\mbox{\tt in}  & {\em P\+U\+N\+I\+C\+O\+D\+E\+\_\+\+S\+T\+R\+I\+NG} & object\+File\+Name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL T\+R\+UE if accessible F\+A\+L\+SE if not 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a37f8ca946421a5904a1bcf51eb665e3b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a67d70d84dbb62dc6593fcab5b4256a38}\label{_ntdriver_8c_a67d70d84dbb62dc6593fcab5b4256a38}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Is\+Drive\+Letter\+Available@{Is\+Drive\+Letter\+Available}}
\index{Is\+Drive\+Letter\+Available@{Is\+Drive\+Letter\+Available}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Is\+Drive\+Letter\+Available()}{IsDriveLetterAvailable()}}
{\footnotesize\ttfamily B\+O\+OL Is\+Drive\+Letter\+Available (\begin{DoxyParamCaption}\item[{int}]{n\+Dos\+Drive\+No }\end{DoxyParamCaption})}



Getter to know if the letter can be taken (for the drive number) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n\+Dos\+Drive\+No \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if not succeed T\+R\+UE otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a67d70d84dbb62dc6593fcab5b4256a38_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{_ntdriver_8c_a67d70d84dbb62dc6593fcab5b4256a38_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_afc9ef476cf0475d4fbcd18be407842ff}\label{_ntdriver_8c_afc9ef476cf0475d4fbcd18be407842ff}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Is\+O\+S\+At\+Least@{Is\+O\+S\+At\+Least}}
\index{Is\+O\+S\+At\+Least@{Is\+O\+S\+At\+Least}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Is\+O\+S\+At\+Least()}{IsOSAtLeast()}}
{\footnotesize\ttfamily B\+O\+OL Is\+O\+S\+At\+Least (\begin{DoxyParamCaption}\item[{O\+S\+Version\+Enum}]{req\+Min\+OS }\end{DoxyParamCaption})}



Check if the os is at least req\+Min\+OS. 

Return the minimum version of the os in argument to run gostcrypt.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em O\+S\+Version\+Enum} & req\+Min\+OS \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL Is\+O\+S\+Version\+At\+Least (req\+Min\+OS, 0)!
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em O\+S\+Version\+Enum} & req\+Min\+OS \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL ((Os\+Major\+Version $<$$<$ 16 $\vert$ Os\+Minor\+Version $<$$<$ 8) $>$= (major $<$$<$ 16 $\vert$ minor $<$$<$ 8)) 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=272pt]{_ntdriver_8c_afc9ef476cf0475d4fbcd18be407842ff_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_abf10fc1ae5d4df3a894e883073dde32c}\label{_ntdriver_8c_abf10fc1ae5d4df3a894e883073dde32c}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Is\+Volume\+Accessible\+By\+Current\+User@{Is\+Volume\+Accessible\+By\+Current\+User}}
\index{Is\+Volume\+Accessible\+By\+Current\+User@{Is\+Volume\+Accessible\+By\+Current\+User}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Is\+Volume\+Accessible\+By\+Current\+User()}{IsVolumeAccessibleByCurrentUser()}}
{\footnotesize\ttfamily B\+O\+OL Is\+Volume\+Accessible\+By\+Current\+User (\begin{DoxyParamCaption}\item[{\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON}}]{volume\+Device\+Extension }\end{DoxyParamCaption})}



Getter to know if the user can access the volume. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+E\+X\+T\+E\+N\+S\+I\+ON} & volume\+Device\+Extension \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL T\+R\+UE if accessible F\+A\+L\+SE otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_abf10fc1ae5d4df3a894e883073dde32c_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a21cb8aa6d59015a21ad0dc44bf0d8eed}\label{_ntdriver_8c_a21cb8aa6d59015a21ad0dc44bf0d8eed}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Is\+Volume\+Class\+Filter\+Registered@{Is\+Volume\+Class\+Filter\+Registered}}
\index{Is\+Volume\+Class\+Filter\+Registered@{Is\+Volume\+Class\+Filter\+Registered}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Is\+Volume\+Class\+Filter\+Registered()}{IsVolumeClassFilterRegistered()}}
{\footnotesize\ttfamily B\+O\+OL Is\+Volume\+Class\+Filter\+Registered (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Check if the volume class exists. 

\begin{DoxyReturn}{Returns}
B\+O\+OL T\+R\+UE if active F\+A\+L\+SE otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a21cb8aa6d59015a21ad0dc44bf0d8eed_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a8affa3709b2c9bf448aaf809aa3a75d9}\label{_ntdriver_8c_a8affa3709b2c9bf448aaf809aa3a75d9}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Mount\+Device@{Mount\+Device}}
\index{Mount\+Device@{Mount\+Device}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Mount\+Device()}{MountDevice()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Mount\+Device (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{Device\+Object,  }\item[{M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$}]{mount }\end{DoxyParamCaption})}



Mount device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT} & $\ast$ mount \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & Device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+S\+U\+C\+C\+E\+SS if success nt\+Status otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a8affa3709b2c9bf448aaf809aa3a75d9_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a5ea310c4e6c8670b8d43b7d819a5bdc9}\label{_ntdriver_8c_a5ea310c4e6c8670b8d43b7d819a5bdc9}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Mount\+Manager\+Mount@{Mount\+Manager\+Mount}}
\index{Mount\+Manager\+Mount@{Mount\+Manager\+Mount}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Mount\+Manager\+Mount()}{MountManagerMount()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Mount\+Manager\+Mount (\begin{DoxyParamCaption}\item[{M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$}]{mount }\end{DoxyParamCaption})}



Mount the manager to mount. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT} & $\ast$ mount \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US nt\+Status 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a5ea310c4e6c8670b8d43b7d819a5bdc9_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a5dde1082ce2a10e5ec09516821ef27d0}\label{_ntdriver_8c_a5dde1082ce2a10e5ec09516821ef27d0}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Mount\+Manager\+Unmount@{Mount\+Manager\+Unmount}}
\index{Mount\+Manager\+Unmount@{Mount\+Manager\+Unmount}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Mount\+Manager\+Unmount()}{MountManagerUnmount()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Mount\+Manager\+Unmount (\begin{DoxyParamCaption}\item[{int}]{n\+Dos\+Drive\+No }\end{DoxyParamCaption})}



Mount the manager to unmount. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n\+Dos\+Drive\+No \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US nt\+Status 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a5dde1082ce2a10e5ec09516821ef27d0_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a02992ce4250a7a592cddf71d4b3b5b74}\label{_ntdriver_8c_a02992ce4250a7a592cddf71d4b3b5b74}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!On\+Shutdown\+Pending@{On\+Shutdown\+Pending}}
\index{On\+Shutdown\+Pending@{On\+Shutdown\+Pending}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{On\+Shutdown\+Pending()}{OnShutdownPending()}}
{\footnotesize\ttfamily void On\+Shutdown\+Pending (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Unmount the root device object and ignore open files also unmount hidden volumes. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a02992ce4250a7a592cddf71d4b3b5b74_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{_ntdriver_8c_a02992ce4250a7a592cddf71d4b3b5b74_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a2ddc9368d2ada4f3387124846160e119}\label{_ntdriver_8c_a2ddc9368d2ada4f3387124846160e119}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Probe\+Real\+Drive\+Size@{Probe\+Real\+Drive\+Size}}
\index{Probe\+Real\+Drive\+Size@{Probe\+Real\+Drive\+Size}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Probe\+Real\+Drive\+Size()}{ProbeRealDriveSize()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Probe\+Real\+Drive\+Size (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{drive\+Device\+Object,  }\item[{L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER $\ast$}]{drive\+Size }\end{DoxyParamCaption})}



Dump the real drive size. Containing the size of the hidden bytes. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER} & $\ast$ drive\+Size \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & drive\+Device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+S\+U\+C\+C\+E\+SS, S\+T\+A\+T\+U\+S\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+D\+E\+N\+I\+ED, S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+S\+U\+F\+F\+I\+C\+I\+E\+N\+T\+\_\+\+R\+E\+S\+O\+U\+R\+C\+ES, S\+T\+A\+T\+U\+S\+\_\+\+T\+I\+M\+E\+O\+UT depending on errors, status else 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_ab5e2d88a5092ae3bea4ba5ff720f9db4}\label{_ntdriver_8c_ab5e2d88a5092ae3bea4ba5ff720f9db4}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Process\+Main\+Device\+Control\+Irp@{Process\+Main\+Device\+Control\+Irp}}
\index{Process\+Main\+Device\+Control\+Irp@{Process\+Main\+Device\+Control\+Irp}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Process\+Main\+Device\+Control\+Irp()}{ProcessMainDeviceControlIrp()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Process\+Main\+Device\+Control\+Irp (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{Device\+Object,  }\item[{\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON}}]{Extension,  }\item[{P\+I\+RP}]{Irp }\end{DoxyParamCaption})}



Process the main actions for the control irp code. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+I\+RP} & Irp \\
\hline
\mbox{\tt in}  & {\em P\+E\+X\+T\+E\+N\+S\+I\+ON} & Extension \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & Device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US G\+S\+T\+Complete\+Irp (Irp, Irp-\/$>$Io\+Status.\+Status, Irp-\/$>$Io\+Status.\+Information) 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_ab5e2d88a5092ae3bea4ba5ff720f9db4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_ae162ac95122b0275c3e73299278d1eac}\label{_ntdriver_8c_ae162ac95122b0275c3e73299278d1eac}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Process\+Volume\+Device\+Control\+Irp@{Process\+Volume\+Device\+Control\+Irp}}
\index{Process\+Volume\+Device\+Control\+Irp@{Process\+Volume\+Device\+Control\+Irp}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Process\+Volume\+Device\+Control\+Irp()}{ProcessVolumeDeviceControlIrp()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Process\+Volume\+Device\+Control\+Irp (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{Device\+Object,  }\item[{\hyperlink{struct_e_x_t_e_n_s_i_o_n}{P\+E\+X\+T\+E\+N\+S\+I\+ON}}]{Extension,  }\item[{P\+I\+RP}]{Irp }\end{DoxyParamCaption})}



Depending on the control code of the irp process the associated actions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+I\+RP} & Irp \\
\hline
\mbox{\tt in}  & {\em P\+E\+X\+T\+E\+N\+S\+I\+ON} & Extension \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & Device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US G\+S\+T\+Complete\+Disk\+Irp (Irp, Irp-\/$>$Io\+Status.\+Status, Irp-\/$>$Io\+Status.\+Information) 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_ae162ac95122b0275c3e73299278d1eac_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a1299bf2a3dce07e3282c31419ec9f044}\label{_ntdriver_8c_a1299bf2a3dce07e3282c31419ec9f044}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Read\+Device\+Skip\+Unreadable\+Sectors@{Read\+Device\+Skip\+Unreadable\+Sectors}}
\index{Read\+Device\+Skip\+Unreadable\+Sectors@{Read\+Device\+Skip\+Unreadable\+Sectors}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Read\+Device\+Skip\+Unreadable\+Sectors()}{ReadDeviceSkipUnreadableSectors()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Read\+Device\+Skip\+Unreadable\+Sectors (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{device\+Object,  }\item[{byte $\ast$}]{buffer,  }\item[{L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER}]{start\+Offset,  }\item[{U\+L\+O\+NG}]{size,  }\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} $\ast$}]{bad\+Sector\+Count }\end{DoxyParamCaption})}



Read a device and skip unreadable sectors so the read doesn\textquotesingle{}t stop at the first unreadable sector but still continue. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uint64} & $\ast$ bad\+Sector\+Count \\
\hline
\mbox{\tt in}  & {\em U\+L\+O\+NG} & size \\
\hline
\mbox{\tt in}  & {\em L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER} & start\+Offset \\
\hline
\mbox{\tt in}  & {\em byte} & $\ast$ buffer \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+S\+U\+C\+C\+E\+SS if success status otherwise 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_ae38cc37a46c511120730110455d222f7}\label{_ntdriver_8c_ae38cc37a46c511120730110455d222f7}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Read\+Registry\+Config\+Flags@{Read\+Registry\+Config\+Flags}}
\index{Read\+Registry\+Config\+Flags@{Read\+Registry\+Config\+Flags}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Read\+Registry\+Config\+Flags()}{ReadRegistryConfigFlags()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Read\+Registry\+Config\+Flags (\begin{DoxyParamCaption}\item[{B\+O\+OL}]{driver\+Entry }\end{DoxyParamCaption})}



Read registry configuration flags. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B\+O\+OL} & driver\+Entry \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US status 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_ae38cc37a46c511120730110455d222f7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_ab9ed204547ed274601b7f4cbfe68c018}\label{_ntdriver_8c_ab9ed204547ed274601b7f4cbfe68c018}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Regions\+Overlap@{Regions\+Overlap}}
\index{Regions\+Overlap@{Regions\+Overlap}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Regions\+Overlap()}{RegionsOverlap()}}
{\footnotesize\ttfamily B\+O\+OL Regions\+Overlap (\begin{DoxyParamCaption}\item[{unsigned \+\_\+\+\_\+int64}]{start1,  }\item[{unsigned \+\_\+\+\_\+int64}]{end1,  }\item[{unsigned \+\_\+\+\_\+int64}]{start2,  }\item[{unsigned \+\_\+\+\_\+int64}]{end2 }\end{DoxyParamCaption})}



Checks if two regions overlap (borders are parts of regions) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int64 end2 \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int64 start2 \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int64 end1 \\
\hline
\mbox{\tt in}  & {\em unsigned} & \+\_\+\+\_\+int64 start1 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL (start1 $<$ start2) ? (end1 $>$= start2) \+: (start1 $<$= end2) 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_aa82b230002079a711b7807bec1a53d87}\label{_ntdriver_8c_aa82b230002079a711b7807bec1a53d87}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Remove\+Drive\+Link@{Remove\+Drive\+Link}}
\index{Remove\+Drive\+Link@{Remove\+Drive\+Link}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Remove\+Drive\+Link()}{RemoveDriveLink()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Remove\+Drive\+Link (\begin{DoxyParamCaption}\item[{int}]{n\+Dos\+Drive\+No }\end{DoxyParamCaption})}



Remove the link from the drive. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & n\+Dos\+Drive\+No \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US nt\+Status 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_aa82b230002079a711b7807bec1a53d87_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_af78b98aec8aa38fc4dd9d4a70a98e956}\label{_ntdriver_8c_af78b98aec8aa38fc4dd9d4a70a98e956}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Root\+Device\+Control\+Mutex\+Acquire\+No\+Wait@{Root\+Device\+Control\+Mutex\+Acquire\+No\+Wait}}
\index{Root\+Device\+Control\+Mutex\+Acquire\+No\+Wait@{Root\+Device\+Control\+Mutex\+Acquire\+No\+Wait}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Root\+Device\+Control\+Mutex\+Acquire\+No\+Wait()}{RootDeviceControlMutexAcquireNoWait()}}
{\footnotesize\ttfamily B\+O\+OL Root\+Device\+Control\+Mutex\+Acquire\+No\+Wait (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Control the mutex without waiting (timeout = 0) 

\begin{DoxyReturn}{Returns}
B\+O\+OL N\+T\+\_\+\+S\+U\+C\+C\+E\+SS (status) \&\& status != S\+T\+A\+T\+U\+S\+\_\+\+T\+I\+M\+E\+O\+UT 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a9ac189e3fd56279212ac4ba91f6a235c}\label{_ntdriver_8c_a9ac189e3fd56279212ac4ba91f6a235c}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Root\+Device\+Control\+Mutex\+Release@{Root\+Device\+Control\+Mutex\+Release}}
\index{Root\+Device\+Control\+Mutex\+Release@{Root\+Device\+Control\+Mutex\+Release}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Root\+Device\+Control\+Mutex\+Release()}{RootDeviceControlMutexRelease()}}
{\footnotesize\ttfamily void Root\+Device\+Control\+Mutex\+Release (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Release the control on the mutex. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_ac5f43ed33bcbea31d95845b2822734df}\label{_ntdriver_8c_ac5f43ed33bcbea31d95845b2822734df}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Send\+Device\+Io\+Control\+Request@{Send\+Device\+Io\+Control\+Request}}
\index{Send\+Device\+Io\+Control\+Request@{Send\+Device\+Io\+Control\+Request}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Send\+Device\+Io\+Control\+Request()}{SendDeviceIoControlRequest()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Send\+Device\+Io\+Control\+Request (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{device\+Object,  }\item[{U\+L\+O\+NG}]{io\+Control\+Code,  }\item[{void $\ast$}]{input\+Buffer,  }\item[{int}]{input\+Buffer\+Size,  }\item[{void $\ast$}]{output\+Buffer,  }\item[{int}]{output\+Buffer\+Size }\end{DoxyParamCaption})}



Send the request control device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em int} & output\+Buffer\+Size \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ output\+Buffer \\
\hline
\mbox{\tt in}  & {\em int} & input\+Buffer\+Size \\
\hline
\mbox{\tt in}  & {\em void} & $\ast$ input\+Buffer \\
\hline
\mbox{\tt in}  & {\em U\+L\+O\+NG} & io\+Control\+Code \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+S\+U\+F\+F\+I\+C\+I\+E\+N\+T\+\_\+\+R\+E\+S\+O\+U\+R\+C\+ES if cannot allocate variable status 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_ac5f43ed33bcbea31d95845b2822734df_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_ab5329d229213fca85c85e1b48b4811b6}\label{_ntdriver_8c_ab5329d229213fca85c85e1b48b4811b6}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Symbolic\+Link\+To\+Target@{Symbolic\+Link\+To\+Target}}
\index{Symbolic\+Link\+To\+Target@{Symbolic\+Link\+To\+Target}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Symbolic\+Link\+To\+Target()}{SymbolicLinkToTarget()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Symbolic\+Link\+To\+Target (\begin{DoxyParamCaption}\item[{P\+W\+S\+TR}]{symlink\+Name,  }\item[{P\+W\+S\+TR}]{target\+Name,  }\item[{U\+S\+H\+O\+RT}]{max\+Target\+Name\+Length }\end{DoxyParamCaption})}



Resolves symbolic link name to its target name. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em U\+S\+H\+O\+RT} & max\+Target\+Name\+Length \\
\hline
\mbox{\tt in}  & {\em P\+W\+S\+TR} & target\+Name \\
\hline
\mbox{\tt in}  & {\em P\+W\+S\+TR} & symlink\+Name \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US nt\+Status 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_ac32fde7dd1db3e74e7c18b51f6dbb2f7}\label{_ntdriver_8c_ac32fde7dd1db3e74e7c18b51f6dbb2f7}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Unmount\+All\+Devices@{Unmount\+All\+Devices}}
\index{Unmount\+All\+Devices@{Unmount\+All\+Devices}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Unmount\+All\+Devices()}{UnmountAllDevices()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Unmount\+All\+Devices (\begin{DoxyParamCaption}\item[{U\+N\+M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$}]{unmount\+Request,  }\item[{B\+O\+OL}]{ignore\+Open\+Files }\end{DoxyParamCaption})}



Unmount all devices. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B\+O\+OL} & ignore\+Open\+Files \\
\hline
\mbox{\tt in}  & {\em U\+N\+M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT} & $\ast$ unmount\+Request \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US status 
\end{DoxyReturn}
\mbox{\Hypertarget{_ntdriver_8c_a07fe905c311e84114ef385d85716f32b}\label{_ntdriver_8c_a07fe905c311e84114ef385d85716f32b}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Unmount\+Device@{Unmount\+Device}}
\index{Unmount\+Device@{Unmount\+Device}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Unmount\+Device()}{UnmountDevice()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Unmount\+Device (\begin{DoxyParamCaption}\item[{U\+N\+M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT $\ast$}]{unmount\+Request,  }\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{device\+Object,  }\item[{B\+O\+OL}]{ignore\+Open\+Files }\end{DoxyParamCaption})}



Unmount Device. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em B\+O\+OL} & ignore\+Open\+Files \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & device\+Object \\
\hline
\mbox{\tt in}  & {\em U\+N\+M\+O\+U\+N\+T\+\_\+\+S\+T\+R\+U\+CT} & $\ast$ unmount\+Request \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US E\+R\+R\+\_\+\+F\+I\+L\+E\+S\+\_\+\+O\+P\+EN if a file cannot open 0 otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a07fe905c311e84114ef385d85716f32b_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a0d693c57a6024c2a6c51c74c04acf374}\label{_ntdriver_8c_a0d693c57a6024c2a6c51c74c04acf374}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!User\+Can\+Access\+Drive\+Device@{User\+Can\+Access\+Drive\+Device}}
\index{User\+Can\+Access\+Drive\+Device@{User\+Can\+Access\+Drive\+Device}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{User\+Can\+Access\+Drive\+Device()}{UserCanAccessDriveDevice()}}
{\footnotesize\ttfamily B\+O\+OL User\+Can\+Access\+Drive\+Device (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Getter to know if the drive is accessible. 

\begin{DoxyReturn}{Returns}
B\+O\+OL Is\+Accessible\+By\+User (\&name, F\+A\+L\+SE) 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a0d693c57a6024c2a6c51c74c04acf374_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a0d693c57a6024c2a6c51c74c04acf374_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a931a50c701d04fe4afe0cebfc37ad49b}\label{_ntdriver_8c_a931a50c701d04fe4afe0cebfc37ad49b}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Validate\+I\+O\+Buffer\+Size@{Validate\+I\+O\+Buffer\+Size}}
\index{Validate\+I\+O\+Buffer\+Size@{Validate\+I\+O\+Buffer\+Size}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Validate\+I\+O\+Buffer\+Size()}{ValidateIOBufferSize()}}
{\footnotesize\ttfamily B\+O\+OL Validate\+I\+O\+Buffer\+Size (\begin{DoxyParamCaption}\item[{P\+I\+RP}]{irp,  }\item[{size\+\_\+t}]{required\+Buffer\+Size,  }\item[{Validate\+I\+O\+Buffer\+Size\+Type}]{type }\end{DoxyParamCaption})}



Validate the buffer size and return T\+R\+UE if the required\+Buffer\+Size argument is good. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Validate\+I\+O\+Buffer\+Size\+Type} & type \\
\hline
\mbox{\tt in}  & {\em size\+\_\+t} & required\+Buffer\+Size \\
\hline
\mbox{\tt in}  & {\em P\+I\+RP} & irp \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE T\+R\+UE 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a931a50c701d04fe4afe0cebfc37ad49b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_af3838e14b1df05975762da5cd4d0d710}\label{_ntdriver_8c_af3838e14b1df05975762da5cd4d0d710}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Volume\+Thread\+Proc@{Volume\+Thread\+Proc}}
\index{Volume\+Thread\+Proc@{Volume\+Thread\+Proc}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Volume\+Thread\+Proc()}{VolumeThreadProc()}}
{\footnotesize\ttfamily V\+O\+ID Volume\+Thread\+Proc (\begin{DoxyParamCaption}\item[{P\+V\+O\+ID}]{Context }\end{DoxyParamCaption})}



Volume\+Thread\+Proc does all the work of processing I\+RP\textquotesingle{}s, and dispatching them to either the Read\+Write function or the Device\+Control function. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em P\+V\+O\+ID} & Context \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
V\+O\+ID 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{_ntdriver_8c_af3838e14b1df05975762da5cd4d0d710_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_a80eda945e51eb334e259093d5f8927c4}\label{_ntdriver_8c_a80eda945e51eb334e259093d5f8927c4}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Write\+Registry\+Config\+Flags@{Write\+Registry\+Config\+Flags}}
\index{Write\+Registry\+Config\+Flags@{Write\+Registry\+Config\+Flags}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Write\+Registry\+Config\+Flags()}{WriteRegistryConfigFlags()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Write\+Registry\+Config\+Flags (\begin{DoxyParamCaption}\item[{uint32}]{flags }\end{DoxyParamCaption})}



Write the registry conig flags. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uint32} & flags \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US G\+S\+T\+Write\+Registry\+Key (\&name, G\+S\+T\+\_\+\+D\+R\+I\+V\+E\+R\+\_\+\+C\+O\+N\+F\+I\+G\+\_\+\+R\+E\+G\+\_\+\+V\+A\+L\+U\+E\+\_\+\+N\+A\+ME, R\+E\+G\+\_\+\+D\+W\+O\+RD, \&flags, sizeof (flags)) 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_a80eda945e51eb334e259093d5f8927c4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_ntdriver_8c_aa95e0ea1d500cdd5c7195ab9faf6cb79}\label{_ntdriver_8c_aa95e0ea1d500cdd5c7195ab9faf6cb79}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!Zero\+Unreadable\+Sectors@{Zero\+Unreadable\+Sectors}}
\index{Zero\+Unreadable\+Sectors@{Zero\+Unreadable\+Sectors}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{Zero\+Unreadable\+Sectors()}{ZeroUnreadableSectors()}}
{\footnotesize\ttfamily N\+T\+S\+T\+A\+T\+US Zero\+Unreadable\+Sectors (\begin{DoxyParamCaption}\item[{P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT}]{device\+Object,  }\item[{L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER}]{start\+Offset,  }\item[{U\+L\+O\+NG}]{size,  }\item[{\hyperlink{union_u_i_n_t64___s_t_r_u_c_t}{uint64} $\ast$}]{zeroed\+Sector\+Count }\end{DoxyParamCaption})}



Return the number of sectors unreadable in zeroed\+Sector\+Count. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uint64} & $\ast$ zeroed\+Sector\+Count \\
\hline
\mbox{\tt in}  & {\em U\+L\+O\+NG} & size \\
\hline
\mbox{\tt in}  & {\em L\+A\+R\+G\+E\+\_\+\+I\+N\+T\+E\+G\+ER} & start\+Offset \\
\hline
\mbox{\tt in}  & {\em P\+D\+E\+V\+I\+C\+E\+\_\+\+O\+B\+J\+E\+CT} & device\+Object \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
N\+T\+S\+T\+A\+T\+US S\+T\+A\+T\+U\+S\+\_\+\+I\+N\+S\+U\+F\+F\+I\+C\+I\+E\+N\+T\+\_\+\+R\+E\+S\+O\+U\+R\+C\+ES if cannot allocate variable status otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_ntdriver_8c_aa95e0ea1d500cdd5c7195ab9faf6cb79_cgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{_ntdriver_8c_af72aebf193624c80200cf120be3adf4e}\label{_ntdriver_8c_af72aebf193624c80200cf120be3adf4e}} 
\index{Ntdriver.\+c@{Ntdriver.\+c}!G\+S\+T\+Driver\+Object@{G\+S\+T\+Driver\+Object}}
\index{G\+S\+T\+Driver\+Object@{G\+S\+T\+Driver\+Object}!Ntdriver.\+c@{Ntdriver.\+c}}
\subsubsection{\texorpdfstring{G\+S\+T\+Driver\+Object}{GSTDriverObject}}
{\footnotesize\ttfamily P\+D\+R\+I\+V\+E\+R\+\_\+\+O\+B\+J\+E\+CT G\+S\+T\+Driver\+Object}

Legal Notice\+: Some portions of the source code contained in this file were derived from the source code of Encryption for the Masses 2.\+02a, which is Copyright (c) 1998-\/2000 Paul Le Roux and which is governed by the \textquotesingle{}License Agreement for Encryption for the Masses\textquotesingle{}. Modifications and additions to the original source code (contained in this file) and all other portions of this file are Copyright (c) 2003-\/2012 True\+Crypt Developers Association and are governed by the True\+Crypt License 3.\+0 the full text of which is contained in the file License.\+txt included in True\+Crypt binary and source code distribution packages. 