\hypertarget{_keyfiles_8c}{}\section{Common/\+Keyfiles.c File Reference}
\label{_keyfiles_8c}\index{Common/\+Keyfiles.\+c@{Common/\+Keyfiles.\+c}}


Manage a window that allow to create a file a directory or a token file. They will load into a list that can be used to point to the file on the computer. then the file created can be read to load the file parameters.  


{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
{\ttfamily \#include $<$sys/types.\+h$>$}\newline
{\ttfamily \#include \char`\"{}Gstdefs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Keyfiles.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Crc.\+h\char`\"{}}\newline
{\ttfamily \#include $<$io.\+h$>$}\newline
{\ttfamily \#include \char`\"{}Dlgcode.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Language.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Security\+Token.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Common/resource.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Platform/\+Finally.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}Platform/\+For\+Each.\+h\char`\"{}}\newline
Include dependency graph for Keyfiles.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_keyfiles_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_keyfiles_8c_a149da0702b060478da4d59ffe807adac}\label{_keyfiles_8c_a149da0702b060478da4d59ffe807adac}} 
\#define {\bfseries stat}~\+\_\+stat
\item 
\mbox{\Hypertarget{_keyfiles_8c_a11fb0652b963a735f3377eb1c9239f2d}\label{_keyfiles_8c_a11fb0652b963a735f3377eb1c9239f2d}} 
\#define {\bfseries S\+\_\+\+I\+F\+D\+IR}~\+\_\+\+S\+\_\+\+I\+F\+D\+IR
\item 
\mbox{\Hypertarget{_keyfiles_8c_aa367b75c5aed883fef5befbdf04835a4}\label{_keyfiles_8c_aa367b75c5aed883fef5befbdf04835a4}} 
\#define {\bfseries snprintf}~\+\_\+snprintf
\item 
\mbox{\Hypertarget{_keyfiles_8c_a95623feff42c1b42369f72f0b83d26f3}\label{_keyfiles_8c_a95623feff42c1b42369f72f0b83d26f3}} 
\#define {\bfseries I\+D\+M\+\_\+\+K\+E\+Y\+F\+I\+L\+E\+S\+\_\+\+P\+O\+P\+U\+P\+\_\+\+A\+D\+D\+\_\+\+F\+I\+L\+ES}~9001
\item 
\mbox{\Hypertarget{_keyfiles_8c_a1ab61db9c2b0fdbffcb8cd9c56e80a6a}\label{_keyfiles_8c_a1ab61db9c2b0fdbffcb8cd9c56e80a6a}} 
\#define {\bfseries I\+D\+M\+\_\+\+K\+E\+Y\+F\+I\+L\+E\+S\+\_\+\+P\+O\+P\+U\+P\+\_\+\+A\+D\+D\+\_\+\+D\+IR}~9002
\item 
\mbox{\Hypertarget{_keyfiles_8c_a0a24d3247778fb489f5fbb2e2e1bb8f6}\label{_keyfiles_8c_a0a24d3247778fb489f5fbb2e2e1bb8f6}} 
\#define {\bfseries I\+D\+M\+\_\+\+K\+E\+Y\+F\+I\+L\+E\+S\+\_\+\+P\+O\+P\+U\+P\+\_\+\+A\+D\+D\+\_\+\+T\+O\+K\+E\+N\+\_\+\+F\+I\+L\+ES}~9003
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{struct_key_file_struct}{Key\+File} $\ast$ \hyperlink{_keyfiles_8c_a9741db7a05b3e06649c12be2c961d6d2}{Key\+File\+Add} (\hyperlink{struct_key_file_struct}{Key\+File} $\ast$first\+Key\+File, \hyperlink{struct_key_file_struct}{Key\+File} $\ast$key\+File)
\begin{DoxyCompactList}\small\item\em return the last keyfile of the keyfile list or and create the next at N\+U\+LL \end{DoxyCompactList}\item 
void \hyperlink{_keyfiles_8c_a8cac8bf07024dc08e525265dd617f396}{Key\+File\+Remove\+All} (\hyperlink{struct_key_file_struct}{Key\+File} $\ast$$\ast$first\+Key\+File)
\begin{DoxyCompactList}\small\item\em Remove all the keyfiles in the list. \end{DoxyCompactList}\item 
\hyperlink{struct_key_file_struct}{Key\+File} $\ast$ \hyperlink{_keyfiles_8c_ab6950e6171ecddb82ad418423f2ca92b}{Key\+File\+Clone} (\hyperlink{struct_key_file_struct}{Key\+File} $\ast$key\+File)
\begin{DoxyCompactList}\small\item\em Clone the keyfile in parameter. \end{DoxyCompactList}\item 
\hyperlink{struct_key_file_struct}{Key\+File} $\ast$ \hyperlink{_keyfiles_8c_a06cec641664068341e751e640ead9433}{Key\+File\+Clone\+All} (\hyperlink{struct_key_file_struct}{Key\+File} $\ast$first\+Key\+File)
\begin{DoxyCompactList}\small\item\em Clone all the keyfiles of the list. \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_keyfiles_8c_a0a87376f3cb433ffb4123699c168102d}{Key\+Files\+Apply} (\hyperlink{struct_password}{Password} $\ast$password, \hyperlink{struct_key_file_struct}{Key\+File} $\ast$first\+Key\+File)
\begin{DoxyCompactList}\small\item\em apply a security token keyfile, verify if it is a path or a file, If it is a folder, it finds and processes of the keyfile in the directory. the function skip the hidden files. apply keyfile to the pool. Mix the keyfile pool contents into the password \end{DoxyCompactList}\item 
B\+O\+OL C\+A\+L\+L\+B\+A\+CK \hyperlink{_keyfiles_8c_a126a83d7761ba5434270d476f7b0a623}{Key\+Files\+Dlg\+Proc} (H\+W\+ND hwnd\+Dlg, U\+I\+NT msg, W\+P\+A\+R\+AM w\+Param, L\+P\+A\+R\+AM l\+Param)
\begin{DoxyCompactList}\small\item\em manage the\+G\+UI interface for the key\+Files \end{DoxyCompactList}\item 
B\+O\+OL \hyperlink{_keyfiles_8c_a18948c7a0e8d82738ea5c702fbb80124}{Keyfiles\+Popup\+Menu} (H\+W\+ND hwnd\+Dlg, P\+O\+I\+NT popup\+Position, \hyperlink{struct_key_files_dlg_param}{Key\+Files\+Dlg\+Param} $\ast$param)
\begin{DoxyCompactList}\small\item\em Show a popup menu that return True if a action have to be done, False otherwise. The commands are \+: Add file , Add directory, add token files. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{_keyfiles_8c_ad462169a89b1c885e96f281d5b5cda46}\label{_keyfiles_8c_ad462169a89b1c885e96f281d5b5cda46}} 
B\+O\+OL {\bfseries Hidden\+Files\+Present\+In\+Keyfile\+Path} = F\+A\+L\+SE
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Manage a window that allow to create a file a directory or a token file. They will load into a list that can be used to point to the file on the computer. then the file created can be read to load the file parameters. 

\begin{DoxyVersion}{Version}
1.\+3.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
23/01/2017 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{_keyfiles_8c_a9741db7a05b3e06649c12be2c961d6d2}\label{_keyfiles_8c_a9741db7a05b3e06649c12be2c961d6d2}} 
\index{Keyfiles.\+c@{Keyfiles.\+c}!Key\+File\+Add@{Key\+File\+Add}}
\index{Key\+File\+Add@{Key\+File\+Add}!Keyfiles.\+c@{Keyfiles.\+c}}
\subsubsection{\texorpdfstring{Key\+File\+Add()}{KeyFileAdd()}}
{\footnotesize\ttfamily \hyperlink{struct_key_file_struct}{Key\+File} $\ast$ Key\+File\+Add (\begin{DoxyParamCaption}\item[{\hyperlink{struct_key_file_struct}{Key\+File} $\ast$}]{first\+Key\+File,  }\item[{\hyperlink{struct_key_file_struct}{Key\+File} $\ast$}]{key\+File }\end{DoxyParamCaption})}



return the last keyfile of the keyfile list or and create the next at N\+U\+LL 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Key\+File} & $\ast$ key\+File \\
\hline
\mbox{\tt in}  & {\em Key\+File} & $\ast$ first\+Key\+File \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Key\+File first\+Key\+File 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_keyfiles_8c_a9741db7a05b3e06649c12be2c961d6d2_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_keyfiles_8c_ab6950e6171ecddb82ad418423f2ca92b}\label{_keyfiles_8c_ab6950e6171ecddb82ad418423f2ca92b}} 
\index{Keyfiles.\+c@{Keyfiles.\+c}!Key\+File\+Clone@{Key\+File\+Clone}}
\index{Key\+File\+Clone@{Key\+File\+Clone}!Keyfiles.\+c@{Keyfiles.\+c}}
\subsubsection{\texorpdfstring{Key\+File\+Clone()}{KeyFileClone()}}
{\footnotesize\ttfamily \hyperlink{struct_key_file_struct}{Key\+File} $\ast$ Key\+File\+Clone (\begin{DoxyParamCaption}\item[{\hyperlink{struct_key_file_struct}{Key\+File} $\ast$}]{key\+File }\end{DoxyParamCaption})}



Clone the keyfile in parameter. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Key\+File} & $\ast$ key\+File \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Key\+File 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_keyfiles_8c_ab6950e6171ecddb82ad418423f2ca92b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_keyfiles_8c_a06cec641664068341e751e640ead9433}\label{_keyfiles_8c_a06cec641664068341e751e640ead9433}} 
\index{Keyfiles.\+c@{Keyfiles.\+c}!Key\+File\+Clone\+All@{Key\+File\+Clone\+All}}
\index{Key\+File\+Clone\+All@{Key\+File\+Clone\+All}!Keyfiles.\+c@{Keyfiles.\+c}}
\subsubsection{\texorpdfstring{Key\+File\+Clone\+All()}{KeyFileCloneAll()}}
{\footnotesize\ttfamily \hyperlink{struct_key_file_struct}{Key\+File} $\ast$ Key\+File\+Clone\+All (\begin{DoxyParamCaption}\item[{\hyperlink{struct_key_file_struct}{Key\+File} $\ast$}]{first\+Key\+File }\end{DoxyParamCaption})}



Clone all the keyfiles of the list. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Key\+File} & $\ast$ first\+Key\+File \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Key\+File $\ast$ clone\+First\+Key\+File 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=276pt]{_keyfiles_8c_a06cec641664068341e751e640ead9433_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=349pt]{_keyfiles_8c_a06cec641664068341e751e640ead9433_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_keyfiles_8c_a8cac8bf07024dc08e525265dd617f396}\label{_keyfiles_8c_a8cac8bf07024dc08e525265dd617f396}} 
\index{Keyfiles.\+c@{Keyfiles.\+c}!Key\+File\+Remove\+All@{Key\+File\+Remove\+All}}
\index{Key\+File\+Remove\+All@{Key\+File\+Remove\+All}!Keyfiles.\+c@{Keyfiles.\+c}}
\subsubsection{\texorpdfstring{Key\+File\+Remove\+All()}{KeyFileRemoveAll()}}
{\footnotesize\ttfamily void Key\+File\+Remove\+All (\begin{DoxyParamCaption}\item[{\hyperlink{struct_key_file_struct}{Key\+File} $\ast$$\ast$}]{first\+Key\+File }\end{DoxyParamCaption})}



Remove all the keyfiles in the list. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Key\+File} & $\ast$$\ast$ first\+Key\+File \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_keyfiles_8c_a8cac8bf07024dc08e525265dd617f396_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_keyfiles_8c_a0a87376f3cb433ffb4123699c168102d}\label{_keyfiles_8c_a0a87376f3cb433ffb4123699c168102d}} 
\index{Keyfiles.\+c@{Keyfiles.\+c}!Key\+Files\+Apply@{Key\+Files\+Apply}}
\index{Key\+Files\+Apply@{Key\+Files\+Apply}!Keyfiles.\+c@{Keyfiles.\+c}}
\subsubsection{\texorpdfstring{Key\+Files\+Apply()}{KeyFilesApply()}}
{\footnotesize\ttfamily B\+O\+OL Key\+Files\+Apply (\begin{DoxyParamCaption}\item[{\hyperlink{struct_password}{Password} $\ast$}]{password,  }\item[{\hyperlink{struct_key_file_struct}{Key\+File} $\ast$}]{first\+Key\+File }\end{DoxyParamCaption})}



apply a security token keyfile, verify if it is a path or a file, If it is a folder, it finds and processes of the keyfile in the directory. the function skip the hidden files. apply keyfile to the pool. Mix the keyfile pool contents into the password 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Key\+File} & $\ast$ first\+Key\+File \\
\hline
\mbox{\tt in}  & {\em \hyperlink{struct_password}{Password}} & $\ast$ password \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL F\+A\+L\+SE if (keyfile\+Data.\+empty()) F\+A\+L\+SE if (stat (kf-\/$>$File\+Name, \&stat\+Struct) != 0) F\+A\+L\+SE if ((search\+Handle = \+\_\+findfirst(search\+Path, \&f\+Buf)) == -\/1) F\+A\+L\+SE if (!\+Key\+File\+Process(key\+Pool, kf\+Sub)) F\+A\+L\+SE if (keyfile\+Count == 0) F\+A\+L\+SE if (stat(kf\+Sub-\/$>$File\+Name, \&stat\+Struct) != 0) F\+A\+L\+SE else if (!\+Key\+File\+Process (key\+Pool, kf)) T\+R\+UE else 
\end{DoxyReturn}
\mbox{\Hypertarget{_keyfiles_8c_a126a83d7761ba5434270d476f7b0a623}\label{_keyfiles_8c_a126a83d7761ba5434270d476f7b0a623}} 
\index{Keyfiles.\+c@{Keyfiles.\+c}!Key\+Files\+Dlg\+Proc@{Key\+Files\+Dlg\+Proc}}
\index{Key\+Files\+Dlg\+Proc@{Key\+Files\+Dlg\+Proc}!Keyfiles.\+c@{Keyfiles.\+c}}
\subsubsection{\texorpdfstring{Key\+Files\+Dlg\+Proc()}{KeyFilesDlgProc()}}
{\footnotesize\ttfamily B\+O\+OL C\+A\+L\+L\+B\+A\+CK Key\+Files\+Dlg\+Proc (\begin{DoxyParamCaption}\item[{H\+W\+ND}]{hwnd\+Dlg,  }\item[{U\+I\+NT}]{msg,  }\item[{W\+P\+A\+R\+AM}]{w\+Param,  }\item[{L\+P\+A\+R\+AM}]{l\+Param }\end{DoxyParamCaption})}



manage the\+G\+UI interface for the key\+Files 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em L\+P\+A\+R\+AM} & l\+Param \\
\hline
\mbox{\tt in}  & {\em W\+P\+A\+R\+AM} & w\+Param \\
\hline
\mbox{\tt in}  & {\em U\+I\+NT} & msg \\
\hline
\mbox{\tt in}  & {\em H\+W\+ND} & hwnd\+Dlg \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL 1 if a command known is pressed 0 otherwise 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_keyfiles_8c_a126a83d7761ba5434270d476f7b0a623_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{_keyfiles_8c_a18948c7a0e8d82738ea5c702fbb80124}\label{_keyfiles_8c_a18948c7a0e8d82738ea5c702fbb80124}} 
\index{Keyfiles.\+c@{Keyfiles.\+c}!Keyfiles\+Popup\+Menu@{Keyfiles\+Popup\+Menu}}
\index{Keyfiles\+Popup\+Menu@{Keyfiles\+Popup\+Menu}!Keyfiles.\+c@{Keyfiles.\+c}}
\subsubsection{\texorpdfstring{Keyfiles\+Popup\+Menu()}{KeyfilesPopupMenu()}}
{\footnotesize\ttfamily B\+O\+OL Keyfiles\+Popup\+Menu (\begin{DoxyParamCaption}\item[{H\+W\+ND}]{hwnd\+Dlg,  }\item[{P\+O\+I\+NT}]{popup\+Position,  }\item[{\hyperlink{struct_key_files_dlg_param}{Key\+Files\+Dlg\+Param} $\ast$}]{param }\end{DoxyParamCaption})}



Show a popup menu that return True if a action have to be done, False otherwise. The commands are \+: Add file , Add directory, add token files. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \hyperlink{struct_key_files_dlg_param}{Key\+Files\+Dlg\+Param}} & $\ast$ param \\
\hline
\mbox{\tt in}  & {\em P\+O\+I\+NT} & popup\+Position \\
\hline
\mbox{\tt in}  & {\em H\+W\+ND} & hwnd\+Dlg \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
B\+O\+OL switch(sel) case I\+D\+M\+\_\+\+K\+E\+Y\+F\+I\+L\+E\+S\+\_\+\+P\+O\+P\+U\+P\+\_\+\+A\+D\+D\+\_\+\+F\+I\+L\+ES status = T\+R\+UE if (Select\+Multiple\+Files (hwnd\+Dlg, \char`\"{}\+S\+E\+L\+E\+C\+T\+\_\+\+K\+E\+Y\+F\+I\+L\+E\char`\"{}, kf-\/$>$File\+Name, b\+History)) case I\+D\+M\+\_\+\+K\+E\+Y\+F\+I\+L\+E\+S\+\_\+\+P\+O\+P\+U\+P\+\_\+\+A\+D\+D\+\_\+\+D\+IR status = T\+R\+UE if (Browse\+Directories (hwnd\+Dlg,\char`\"{}\+S\+E\+L\+E\+C\+T\+\_\+\+K\+E\+Y\+F\+I\+L\+E\+\_\+\+P\+A\+T\+H\char`\"{}, kf-\/$>$File\+Name)) case I\+D\+M\+\_\+\+K\+E\+Y\+F\+I\+L\+E\+S\+\_\+\+P\+O\+P\+U\+P\+\_\+\+A\+D\+D\+\_\+\+T\+O\+K\+E\+N\+\_\+\+F\+I\+L\+ES status = T\+R\+UE if (Dialog\+Box\+ParamW (h\+Inst, M\+A\+K\+E\+I\+N\+T\+R\+E\+S\+O\+U\+R\+C\+EW (I\+D\+D\+\_\+\+T\+O\+K\+E\+N\+\_\+\+K\+E\+Y\+F\+I\+L\+ES), hwnd\+Dlg, (D\+L\+G\+P\+R\+OC) Security\+Token\+Keyfile\+Dlg\+Proc, (L\+P\+A\+R\+AM) \&selected\+Token\+Keyfiles) == I\+D\+OK) status else 
\end{DoxyReturn}
