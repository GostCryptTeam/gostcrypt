<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gostcrypt: Driver/DriveFilter.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Gostcrypt
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_7151b3cc910409bb744bd274374c738d.html">Driver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">DriveFilter.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manage the link between the application, the driver, and the device.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;Gstdefs.h&quot;</code><br />
<code>#include &lt;ntddk.h&gt;</code><br />
<code>#include &lt;ntddvol.h&gt;</code><br />
<code>#include &quot;Cache.h&quot;</code><br />
<code>#include &quot;Crc.h&quot;</code><br />
<code>#include &quot;Crypto.h&quot;</code><br />
<code>#include &quot;Apidrvr.h&quot;</code><br />
<code>#include &quot;EncryptedIoQueue.h&quot;</code><br />
<code>#include &quot;Common/Endian.h&quot;</code><br />
<code>#include &quot;Ntdriver.h&quot;</code><br />
<code>#include &quot;Ntvol.h&quot;</code><br />
<code>#include &quot;Volumes.h&quot;</code><br />
<code>#include &quot;VolumeFilter.h&quot;</code><br />
<code>#include &quot;Wipe.h&quot;</code><br />
<code>#include &quot;DriveFilter.h&quot;</code><br />
<code>#include &quot;Boot/Windows/BootCommon.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for DriveFilter.c:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c__incl.png" border="0" usemap="#_driver_2_drive_filter_8c" alt=""/></div>
<map name="_driver_2_drive_filter_8c" id="_driver_2_drive_filter_8c">
<area shape="rect" id="node2" href="_gstdefs_8h_source.html" title="Gstdefs.h" alt="" coords="522,528,601,555"/>
<area shape="rect" id="node7" href="_cache_8h_source.html" title="Cache.h" alt="" coords="977,229,1047,256"/>
<area shape="rect" id="node9" href="_crypto_8h_source.html" title="Crypto.h" alt="" coords="1057,379,1127,405"/>
<area shape="rect" id="node17" href="_crc_8h_source.html" title="Crc.h" alt="" coords="5,379,59,405"/>
<area shape="rect" id="node18" href="_apidrvr_8h_source.html" title="Apidrvr.h" alt="" coords="759,229,831,256"/>
<area shape="rect" id="node20" href="_volumes_8h_source.html" title="Volumes.h" alt="" coords="861,304,945,331"/>
<area shape="rect" id="node21" href="_wipe_8h_source.html" title="Wipe.h" alt="" coords="319,304,382,331"/>
<area shape="rect" id="node22" href="_encrypted_io_queue_8h_source.html" title="EncryptedIoQueue.h" alt="" coords="659,155,799,181"/>
<area shape="rect" id="node23" href="_endian_8h_source.html" title="Common/Endian.h" alt="" coords="50,155,179,181"/>
<area shape="rect" id="node24" href="_ntdriver_8h_source.html" title="Ntdriver.h" alt="" coords="767,80,843,107"/>
<area shape="rect" id="node25" href="_ntvol_8h_source.html" title="Ntvol.h" alt="" coords="1288,80,1349,107"/>
<area shape="rect" id="node26" href="_volume_filter_8h_source.html" title="VolumeFilter.h" alt="" coords="203,229,309,256"/>
<area shape="rect" id="node27" href="_drive_filter_8h_source.html" title="DriveFilter.h" alt="" coords="589,80,680,107"/>
<area shape="rect" id="node28" href="_boot_common_8h_source.html" title="Boot/Windows/BootCommon.h" alt="" coords="384,155,584,181"/>
<area shape="rect" id="node8" href="_common_8h_source.html" title="Common.h" alt="" coords="969,304,1055,331"/>
<area shape="rect" id="node10" href="_gost_cipher_8h_source.html" title="GostCipher.h" alt="" coords="987,453,1085,480"/>
<area shape="rect" id="node11" href="_grasshopper_cipher_8h_source.html" title="GrasshopperCipher.h" alt="" coords="1363,453,1507,480"/>
<area shape="rect" id="node12" href="_stribog_8h_source.html" title="Stribog.h" alt="" coords="1531,453,1605,480"/>
<area shape="rect" id="node13" href="_whirlpool_8h_source.html" title="Whirlpool.h" alt="" coords="1251,453,1338,480"/>
<area shape="rect" id="node14" href="_gost_hash_8h_source.html" title="GostHash.h" alt="" coords="872,453,963,480"/>
<area shape="rect" id="node15" href="_gf_mul_8h_source.html" title="GfMul.h" alt="" coords="1109,453,1176,480"/>
<area shape="rect" id="node16" href="_password_8h_source.html" title="Password.h" alt="" coords="757,453,848,480"/>
<area shape="rect" id="node19" href="_boot_defs_8h_source.html" title="Boot/Windows/BootDefs.h" alt="" coords="509,304,683,331"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_hiber_driver_context.html">HiberDriverContext</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_module_table_item.html">ModuleTableItem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5d1289a503f5de446dd24d649c7c93b7"><td class="memItemLeft" align="right" valign="top"><a id="a5d1289a503f5de446dd24d649c7c93b7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>GST_MAX_HIBER_FILTER_COUNT</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a5d1289a503f5de446dd24d649c7c93b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a5f13ce08b1ea478e57103e7b81272e74"><td class="memItemLeft" align="right" valign="top"><a id="a5f13ce08b1ea478e57103e7b81272e74"></a>
typedef NTSTATUS(*&#160;</td><td class="memItemRight" valign="bottom"><b>HiberDriverWriteFunctionA</b>) (ULONG arg0, PLARGE_INTEGER writeOffset, PMDL dataMdl, PVOID arg3)</td></tr>
<tr class="separator:a5f13ce08b1ea478e57103e7b81272e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1408eda9188f5e1b4a7ee493a06229a1"><td class="memItemLeft" align="right" valign="top"><a id="a1408eda9188f5e1b4a7ee493a06229a1"></a>
typedef NTSTATUS(*&#160;</td><td class="memItemRight" valign="bottom"><b>HiberDriverWriteFunctionB</b>) (PLARGE_INTEGER writeOffset, PMDL dataMdl)</td></tr>
<tr class="separator:a1408eda9188f5e1b4a7ee493a06229a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e3580e62442986ed7a4fcee436abad"><td class="memItemLeft" align="right" valign="top"><a id="a30e3580e62442986ed7a4fcee436abad"></a>
typedef NTSTATUS(*&#160;</td><td class="memItemRight" valign="bottom"><b>HiberDriverEntry</b>) (PVOID arg0, <a class="el" href="struct_hiber_driver_context.html">HiberDriverContext</a> *hiberDriverContext)</td></tr>
<tr class="separator:a30e3580e62442986ed7a4fcee436abad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aea2e8fbefa4e00dfc523629905da1a87"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#aea2e8fbefa4e00dfc523629905da1a87">LoadBootArguments</a> ()</td></tr>
<tr class="memdesc:aea2e8fbefa4e00dfc523629905da1a87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the boot part segment by segment and set the parameters for the cryptology, where the partition starts ...  <a href="#aea2e8fbefa4e00dfc523629905da1a87">More...</a><br /></td></tr>
<tr class="separator:aea2e8fbefa4e00dfc523629905da1a87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee250d36a6e99592811951c6ba3613e5"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#aee250d36a6e99592811951c6ba3613e5">DriveFilterAddDevice</a> (PDRIVER_OBJECT driverObject, PDEVICE_OBJECT pdo)</td></tr>
<tr class="memdesc:aee250d36a6e99592811951c6ba3613e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add to the driveFilter a device and initialise it's value of encryptment.  <a href="#aee250d36a6e99592811951c6ba3613e5">More...</a><br /></td></tr>
<tr class="separator:aee250d36a6e99592811951c6ba3613e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76687d443d2ff9f691b7e55750ab2383"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a76687d443d2ff9f691b7e55750ab2383">DriveFilterDispatchIrp</a> (PDEVICE_OBJECT DeviceObject, PIRP Irp)</td></tr>
<tr class="memdesc:a76687d443d2ff9f691b7e55750ab2383"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the irp major function and use the right function to manage the type of irp sent.  <a href="#a76687d443d2ff9f691b7e55750ab2383">More...</a><br /></td></tr>
<tr class="separator:a76687d443d2ff9f691b7e55750ab2383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42833fd28a6390d2b165aaea9ea2ca6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#ad42833fd28a6390d2b165aaea9ea2ca6">ReopenBootVolumeHeader</a> (PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:ad42833fd28a6390d2b165aaea9ea2ca6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a request to open the boot volume header and read if accepted.  <a href="#ad42833fd28a6390d2b165aaea9ea2ca6">More...</a><br /></td></tr>
<tr class="separator:ad42833fd28a6390d2b165aaea9ea2ca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ebd09edb9be16fddaef3e602fa3f38a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a8ebd09edb9be16fddaef3e602fa3f38a">StartLegacyHibernationDriverFilter</a> ()</td></tr>
<tr class="memdesc:a8ebd09edb9be16fddaef3e602fa3f38a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the hibernation of the driver filter.  <a href="#a8ebd09edb9be16fddaef3e602fa3f38a">More...</a><br /></td></tr>
<tr class="separator:a8ebd09edb9be16fddaef3e602fa3f38a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad15951e30bfa20df4b054535755575a1"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#ad15951e30bfa20df4b054535755575a1">StartBootEncryptionSetup</a> (PDEVICE_OBJECT DeviceObject, PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:ad15951e30bfa20df4b054535755575a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send to the device the packet that will ask to encrypt.  <a href="#ad15951e30bfa20df4b054535755575a1">More...</a><br /></td></tr>
<tr class="separator:ad15951e30bfa20df4b054535755575a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a980e6ff2cd34d815a42715b35cbd62a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a980e6ff2cd34d815a42715b35cbd62a9">GetBootDriveVolumeProperties</a> (PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:a980e6ff2cd34d815a42715b35cbd62a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the boot properties of the volume.  <a href="#a980e6ff2cd34d815a42715b35cbd62a9">More...</a><br /></td></tr>
<tr class="separator:a980e6ff2cd34d815a42715b35cbd62a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeecf7fc1f7ef05a5a58c30b4353b822a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#aeecf7fc1f7ef05a5a58c30b4353b822a">GetBootEncryptionStatus</a> (PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:aeecf7fc1f7ef05a5a58c30b4353b822a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the boot encryption status and put into the structure bootEncStatus.  <a href="#aeecf7fc1f7ef05a5a58c30b4353b822a">More...</a><br /></td></tr>
<tr class="separator:aeecf7fc1f7ef05a5a58c30b4353b822a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace107a33c76ea5d3e65f3db54bc0ad11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#ace107a33c76ea5d3e65f3db54bc0ad11">GetBootLoaderVersion</a> (PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:ace107a33c76ea5d3e65f3db54bc0ad11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the boot loader version by sending a packet to the driver.  <a href="#ace107a33c76ea5d3e65f3db54bc0ad11">More...</a><br /></td></tr>
<tr class="separator:ace107a33c76ea5d3e65f3db54bc0ad11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34bfdfb556e32d0efc8f71e1b270e52b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a34bfdfb556e32d0efc8f71e1b270e52b">GetBootEncryptionAlgorithmName</a> (PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:a34bfdfb556e32d0efc8f71e1b270e52b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a packet to the driver to know the algorithm used.  <a href="#a34bfdfb556e32d0efc8f71e1b270e52b">More...</a><br /></td></tr>
<tr class="separator:a34bfdfb556e32d0efc8f71e1b270e52b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a66ec73d373e8c5f922e8d04f78181a"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a7a66ec73d373e8c5f922e8d04f78181a">GetSetupResult</a> ()</td></tr>
<tr class="memdesc:a7a66ec73d373e8c5f922e8d04f78181a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for Setupd Result.  <a href="#a7a66ec73d373e8c5f922e8d04f78181a">More...</a><br /></td></tr>
<tr class="separator:a7a66ec73d373e8c5f922e8d04f78181a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eb5c8d246416f300effd75a49592ce1"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a5eb5c8d246416f300effd75a49592ce1">IsBootDriveMounted</a> ()</td></tr>
<tr class="memdesc:a5eb5c8d246416f300effd75a49592ce1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter to know if a drive is mounted.  <a href="#a5eb5c8d246416f300effd75a49592ce1">More...</a><br /></td></tr>
<tr class="separator:a5eb5c8d246416f300effd75a49592ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5db0013af3d31cf4fb4494a8a40d0794"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a5db0013af3d31cf4fb4494a8a40d0794">IsBootEncryptionSetupInProgress</a> ()</td></tr>
<tr class="memdesc:a5db0013af3d31cf4fb4494a8a40d0794"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for Setud in progress variable.  <a href="#a5db0013af3d31cf4fb4494a8a40d0794">More...</a><br /></td></tr>
<tr class="separator:a5db0013af3d31cf4fb4494a8a40d0794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed90fff4a3656574fe8e1640cfa14abb"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#aed90fff4a3656574fe8e1640cfa14abb">IsHiddenSystemRunning</a> ()</td></tr>
<tr class="memdesc:aed90fff4a3656574fe8e1640cfa14abb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter to know if the system is running.  <a href="#aed90fff4a3656574fe8e1640cfa14abb">More...</a><br /></td></tr>
<tr class="separator:aed90fff4a3656574fe8e1640cfa14abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec7421ddc80e74c0eaf6550400be1492"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct___drive_filter_extension.html">DriveFilterExtension</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#aec7421ddc80e74c0eaf6550400be1492">GetBootDriveFilterExtension</a> ()</td></tr>
<tr class="memdesc:aec7421ddc80e74c0eaf6550400be1492"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the boot drive filter extension.  <a href="#aec7421ddc80e74c0eaf6550400be1492">More...</a><br /></td></tr>
<tr class="separator:aec7421ddc80e74c0eaf6550400be1492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a215c1ab6b69620a1886260386c32499d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_c_r_y_p_t_o___i_n_f_o__t.html">CRYPTO_INFO</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a215c1ab6b69620a1886260386c32499d">GetSystemDriveCryptoInfo</a> ()</td></tr>
<tr class="memdesc:a215c1ab6b69620a1886260386c32499d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the cryptologic information about the system drive.  <a href="#a215c1ab6b69620a1886260386c32499d">More...</a><br /></td></tr>
<tr class="separator:a215c1ab6b69620a1886260386c32499d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89dd2943d023eccaf488a5e75ecbf8c"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#aa89dd2943d023eccaf488a5e75ecbf8c">AbortBootEncryptionSetup</a> ()</td></tr>
<tr class="memdesc:aa89dd2943d023eccaf488a5e75ecbf8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the encryption setup for the boot.  <a href="#aa89dd2943d023eccaf488a5e75ecbf8c">More...</a><br /></td></tr>
<tr class="separator:aa89dd2943d023eccaf488a5e75ecbf8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17e83551909aead4bda4e1c1b87ee0bf"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a17e83551909aead4bda4e1c1b87ee0bf">StartDecoySystemWipe</a> (PDEVICE_OBJECT DeviceObject, PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:a17e83551909aead4bda4e1c1b87ee0bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Launch the abort of the decoy encrypting system.  <a href="#a17e83551909aead4bda4e1c1b87ee0bf">More...</a><br /></td></tr>
<tr class="separator:a17e83551909aead4bda4e1c1b87ee0bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ff40c543ee494742d77389f9bb1ac5c"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a4ff40c543ee494742d77389f9bb1ac5c">IsDecoySystemWipeInProgress</a> ()</td></tr>
<tr class="memdesc:a4ff40c543ee494742d77389f9bb1ac5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the decoy wipe system is running or not.  <a href="#a4ff40c543ee494742d77389f9bb1ac5c">More...</a><br /></td></tr>
<tr class="separator:a4ff40c543ee494742d77389f9bb1ac5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09f3131778c9e760bc08a93000b5f47c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a09f3131778c9e760bc08a93000b5f47c">GetDecoySystemWipeStatus</a> (PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:a09f3131778c9e760bc08a93000b5f47c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the decoy wipe system status.  <a href="#a09f3131778c9e760bc08a93000b5f47c">More...</a><br /></td></tr>
<tr class="separator:a09f3131778c9e760bc08a93000b5f47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e688304a7b5792ea69e0b348599bb18"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a7e688304a7b5792ea69e0b348599bb18">GetDecoySystemWipeResult</a> ()</td></tr>
<tr class="memdesc:a7e688304a7b5792ea69e0b348599bb18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the decoy system wipe result.  <a href="#a7e688304a7b5792ea69e0b348599bb18">More...</a><br /></td></tr>
<tr class="separator:a7e688304a7b5792ea69e0b348599bb18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee33d06a6aba5fade24ece52f631283"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#acee33d06a6aba5fade24ece52f631283">AbortDecoySystemWipe</a> ()</td></tr>
<tr class="memdesc:acee33d06a6aba5fade24ece52f631283"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abort decoy system wipe.  <a href="#acee33d06a6aba5fade24ece52f631283">More...</a><br /></td></tr>
<tr class="separator:acee33d06a6aba5fade24ece52f631283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75bc15010a09649b65079ac5ea651cb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">uint64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a75bc15010a09649b65079ac5ea651cb3">GetBootDriveLength</a> ()</td></tr>
<tr class="memdesc:a75bc15010a09649b65079ac5ea651cb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the boot drive length.  <a href="#a75bc15010a09649b65079ac5ea651cb3">More...</a><br /></td></tr>
<tr class="separator:a75bc15010a09649b65079ac5ea651cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b86125ef582cb2fb62bbe6bfd099c5"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_drive_filter_8c.html#a23b86125ef582cb2fb62bbe6bfd099c5">WriteBootDriveSector</a> (PIRP irp, PIO_STACK_LOCATION irpSp)</td></tr>
<tr class="memdesc:a23b86125ef582cb2fb62bbe6bfd099c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write into a soctor of the boot drive.  <a href="#a23b86125ef582cb2fb62bbe6bfd099c5">More...</a><br /></td></tr>
<tr class="separator:a23b86125ef582cb2fb62bbe6bfd099c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a02c320842179cad6b9deba8cc3d0bf09"><td class="memItemLeft" align="right" valign="top"><a id="a02c320842179cad6b9deba8cc3d0bf09"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><b>BootArgsValid</b> = FALSE</td></tr>
<tr class="separator:a02c320842179cad6b9deba8cc3d0bf09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a241d9e83bf92d99bf1486dff3b733356"><td class="memItemLeft" align="right" valign="top"><a id="a241d9e83bf92d99bf1486dff3b733356"></a>
<a class="el" href="struct_boot_arguments.html">BootArguments</a>&#160;</td><td class="memItemRight" valign="bottom"><b>BootArgs</b></td></tr>
<tr class="separator:a241d9e83bf92d99bf1486dff3b733356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0d6d713cfdf4f60bcd00b89f3c34771"><td class="memItemLeft" align="right" valign="top"><a id="aa0d6d713cfdf4f60bcd00b89f3c34771"></a>
PKTHREAD&#160;</td><td class="memItemRight" valign="bottom"><b>EncryptionSetupThread</b> = NULL</td></tr>
<tr class="separator:aa0d6d713cfdf4f60bcd00b89f3c34771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8e0f11a9003d82179087f54bf1465d6"><td class="memItemLeft" align="right" valign="top"><a id="ad8e0f11a9003d82179087f54bf1465d6"></a>
PKTHREAD&#160;</td><td class="memItemRight" valign="bottom"><b>DecoySystemWipeThread</b> = NULL</td></tr>
<tr class="separator:ad8e0f11a9003d82179087f54bf1465d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manage the link between the application, the driver, and the device. </p>
<dl class="section version"><dt>Version</dt><dd>1.3.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>13/12/2016 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa89dd2943d023eccaf488a5e75ecbf8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89dd2943d023eccaf488a5e75ecbf8c">&#9670;&nbsp;</a></span>AbortBootEncryptionSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS AbortBootEncryptionSetup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the encryption setup for the boot. </p>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS STATUS_SUCCESS if success STATUS_ACCESS_DENIED if not </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_aa89dd2943d023eccaf488a5e75ecbf8c_cgraph.png" border="0" usemap="#_drive_filter_8c_aa89dd2943d023eccaf488a5e75ecbf8c_cgraph" alt=""/></div>
<map name="_drive_filter_8c_aa89dd2943d023eccaf488a5e75ecbf8c_cgraph" id="_drive_filter_8c_aa89dd2943d023eccaf488a5e75ecbf8c_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a0d693c57a6024c2a6c51c74c04acf374" title="Getter to know if the drive is accessible. " alt="" coords="229,31,412,57"/>
<area shape="rect" id="node3" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="510,5,549,32"/>
<area shape="rect" id="node6" href="_ntdriver_8c.html#a37f8ca946421a5904a1bcf51eb665e3b" title="Getter to know if the user can access the object. " alt="" coords="460,56,599,83"/>
<area shape="rect" id="node4" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="647,5,685,32"/>
<area shape="rect" id="node5" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="733,5,772,32"/>
</map>
</div>

</div>
</div>
<a id="acee33d06a6aba5fade24ece52f631283"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acee33d06a6aba5fade24ece52f631283">&#9670;&nbsp;</a></span>AbortDecoySystemWipe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS AbortDecoySystemWipe </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Abort decoy system wipe. </p>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS STATUS_SUCCESS if success STATUS_ACCESS_DENIED if not </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_acee33d06a6aba5fade24ece52f631283_cgraph.png" border="0" usemap="#_drive_filter_8c_acee33d06a6aba5fade24ece52f631283_cgraph" alt=""/></div>
<map name="_drive_filter_8c_acee33d06a6aba5fade24ece52f631283_cgraph" id="_drive_filter_8c_acee33d06a6aba5fade24ece52f631283_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a0d693c57a6024c2a6c51c74c04acf374" title="Getter to know if the drive is accessible. " alt="" coords="219,31,401,57"/>
<area shape="rect" id="node3" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="499,5,538,32"/>
<area shape="rect" id="node6" href="_ntdriver_8c.html#a37f8ca946421a5904a1bcf51eb665e3b" title="Getter to know if the user can access the object. " alt="" coords="449,56,588,83"/>
<area shape="rect" id="node4" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="636,5,675,32"/>
<area shape="rect" id="node5" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="723,5,761,32"/>
</map>
</div>

</div>
</div>
<a id="aee250d36a6e99592811951c6ba3613e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee250d36a6e99592811951c6ba3613e5">&#9670;&nbsp;</a></span>DriveFilterAddDevice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DriveFilterAddDevice </td>
          <td>(</td>
          <td class="paramtype">PDRIVER_OBJECT&#160;</td>
          <td class="paramname"><em>driverObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PDEVICE_OBJECT&#160;</td>
          <td class="paramname"><em>pdo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add to the driveFilter a device and initialise it's value of encryptment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PDEVICE_OBJECT</td><td>pdo </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PDRIVER_OBJECT</td><td>driverObject </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS status </dd></dl>

</div>
</div>
<a id="a76687d443d2ff9f691b7e55750ab2383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76687d443d2ff9f691b7e55750ab2383">&#9670;&nbsp;</a></span>DriveFilterDispatchIrp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DriveFilterDispatchIrp </td>
          <td>(</td>
          <td class="paramtype">PDEVICE_OBJECT&#160;</td>
          <td class="paramname"><em>DeviceObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>Irp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the irp major function and use the right function to manage the type of irp sent. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>Irp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PDEVICE_OBJECT</td><td>DeviceObject </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS status </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a76687d443d2ff9f691b7e55750ab2383_cgraph.png" border="0" usemap="#_drive_filter_8c_a76687d443d2ff9f691b7e55750ab2383_cgraph" alt=""/></div>
<map name="_drive_filter_8c_a76687d443d2ff9f691b7e55750ab2383_cgraph" id="_drive_filter_8c_a76687d443d2ff9f691b7e55750ab2383_cgraph">
<area shape="rect" id="node2" href="_encrypted_io_queue_8c.html#a6ad0720d3b1044c4b1d08a45e24e5399" title="Remove the lock on the queue and add the irp to the main queue then lock it. " alt="" coords="197,5,364,32"/>
<area shape="rect" id="node4" href="_ntdriver_8c.html#a56a4eeed0b0ce7d4d77ff4cdd72679a3" title="Complete a drisk irp packet. " alt="" coords="209,56,352,83"/>
<area shape="rect" id="node3" href="_ntdriver_8c.html#a711c6dc81aaafd64a4e3a23fb5760c2f" title="Returns elapsed time in microseconds since last call. " alt="" coords="412,5,531,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a76687d443d2ff9f691b7e55750ab2383_icgraph.png" border="0" usemap="#_drive_filter_8c_a76687d443d2ff9f691b7e55750ab2383_icgraph" alt=""/></div>
<map name="_drive_filter_8c_a76687d443d2ff9f691b7e55750ab2383_icgraph" id="_drive_filter_8c_a76687d443d2ff9f691b7e55750ab2383_icgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#aa2ad3d74581504a31273a0903d590a4f" title="GSTDispatchQueueIRP queues any IRP&#39;s so that they can be processed later by the thread â€“ or in some ..." alt="" coords="197,5,356,32"/>
</map>
</div>

</div>
</div>
<a id="aec7421ddc80e74c0eaf6550400be1492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec7421ddc80e74c0eaf6550400be1492">&#9670;&nbsp;</a></span>GetBootDriveFilterExtension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct___drive_filter_extension.html">DriveFilterExtension</a> * GetBootDriveFilterExtension </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the boot drive filter extension. </p>
<dl class="section return"><dt>Returns</dt><dd>DriveFilterExtension * BootDriveFilterExtension </dd></dl>

</div>
</div>
<a id="a75bc15010a09649b65079ac5ea651cb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75bc15010a09649b65079ac5ea651cb3">&#9670;&nbsp;</a></span>GetBootDriveLength()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">uint64</a> GetBootDriveLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the boot drive length. </p>
<dl class="section return"><dt>Returns</dt><dd>uint64 BootDriveLength.QuadPart </dd></dl>

</div>
</div>
<a id="a980e6ff2cd34d815a42715b35cbd62a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a980e6ff2cd34d815a42715b35cbd62a9">&#9670;&nbsp;</a></span>GetBootDriveVolumeProperties()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetBootDriveVolumeProperties </td>
          <td>(</td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the boot properties of the volume. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a980e6ff2cd34d815a42715b35cbd62a9_cgraph.png" border="0" usemap="#_drive_filter_8c_a980e6ff2cd34d815a42715b35cbd62a9_cgraph" alt=""/></div>
<map name="_drive_filter_8c_a980e6ff2cd34d815a42715b35cbd62a9_cgraph" id="_drive_filter_8c_a980e6ff2cd34d815a42715b35cbd62a9_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a931a50c701d04fe4afe0cebfc37ad49b" title="Validate the buffer size and return TRUE if the requiredBufferSize argument is good. " alt="" coords="255,5,396,32"/>
</map>
</div>

</div>
</div>
<a id="a34bfdfb556e32d0efc8f71e1b270e52b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34bfdfb556e32d0efc8f71e1b270e52b">&#9670;&nbsp;</a></span>GetBootEncryptionAlgorithmName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetBootEncryptionAlgorithmName </td>
          <td>(</td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a packet to the driver to know the algorithm used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a34bfdfb556e32d0efc8f71e1b270e52b_cgraph.png" border="0" usemap="#_drive_filter_8c_a34bfdfb556e32d0efc8f71e1b270e52b_cgraph" alt=""/></div>
<map name="_drive_filter_8c_a34bfdfb556e32d0efc8f71e1b270e52b_cgraph" id="_drive_filter_8c_a34bfdfb556e32d0efc8f71e1b270e52b_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a931a50c701d04fe4afe0cebfc37ad49b" title="Validate the buffer size and return TRUE if the requiredBufferSize argument is good. " alt="" coords="275,5,416,32"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a6c2ad176a3628fde37e21c5028ddfd40" title="Returns name of EA, cascaded cipher names are separated by hyphens. " alt="" coords="298,56,393,83"/>
<area shape="rect" id="node4" href="_crypto_8c.html#ac51b1aa192c121136917d07e628b3b62" title="Get last EA cipher. " alt="" coords="476,5,599,32"/>
<area shape="rect" id="node5" href="_crypto_8c.html#a6a985803967930df28a2baacc0a3aa92" title="Get the name of a cipher at id. " alt="" coords="480,56,595,83"/>
<area shape="rect" id="node7" href="_crypto_8c.html#a7c61a17a983733f94fa7ec56fed30740" title="Return next cipher if exists. " alt="" coords="464,107,611,133"/>
<area shape="rect" id="node6" href="_crypto_8c.html#a497fc6204c6a611434f38e4ccec909db" title="Get cipher at id, return null if there is no cipher with this id. " alt="" coords="659,56,739,83"/>
</map>
</div>

</div>
</div>
<a id="aeecf7fc1f7ef05a5a58c30b4353b822a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeecf7fc1f7ef05a5a58c30b4353b822a">&#9670;&nbsp;</a></span>GetBootEncryptionStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetBootEncryptionStatus </td>
          <td>(</td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the boot encryption status and put into the structure bootEncStatus. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_aeecf7fc1f7ef05a5a58c30b4353b822a_cgraph.png" border="0" usemap="#_drive_filter_8c_aeecf7fc1f7ef05a5a58c30b4353b822a_cgraph" alt=""/></div>
<map name="_drive_filter_8c_aeecf7fc1f7ef05a5a58c30b4353b822a_cgraph" id="_drive_filter_8c_aeecf7fc1f7ef05a5a58c30b4353b822a_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a931a50c701d04fe4afe0cebfc37ad49b" title="Validate the buffer size and return TRUE if the requiredBufferSize argument is good. " alt="" coords="224,5,365,32"/>
</map>
</div>

</div>
</div>
<a id="ace107a33c76ea5d3e65f3db54bc0ad11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace107a33c76ea5d3e65f3db54bc0ad11">&#9670;&nbsp;</a></span>GetBootLoaderVersion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetBootLoaderVersion </td>
          <td>(</td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the boot loader version by sending a packet to the driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_ace107a33c76ea5d3e65f3db54bc0ad11_cgraph.png" border="0" usemap="#_drive_filter_8c_ace107a33c76ea5d3e65f3db54bc0ad11_cgraph" alt=""/></div>
<map name="_drive_filter_8c_ace107a33c76ea5d3e65f3db54bc0ad11_cgraph" id="_drive_filter_8c_ace107a33c76ea5d3e65f3db54bc0ad11_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a931a50c701d04fe4afe0cebfc37ad49b" title="Validate the buffer size and return TRUE if the requiredBufferSize argument is good. " alt="" coords="207,5,348,32"/>
</map>
</div>

</div>
</div>
<a id="a7e688304a7b5792ea69e0b348599bb18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e688304a7b5792ea69e0b348599bb18">&#9670;&nbsp;</a></span>GetDecoySystemWipeResult()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS GetDecoySystemWipeResult </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the decoy system wipe result. </p>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS DecoySystemWipeResult </dd></dl>

</div>
</div>
<a id="a09f3131778c9e760bc08a93000b5f47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09f3131778c9e760bc08a93000b5f47c">&#9670;&nbsp;</a></span>GetDecoySystemWipeStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetDecoySystemWipeStatus </td>
          <td>(</td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the decoy wipe system status. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a09f3131778c9e760bc08a93000b5f47c_cgraph.png" border="0" usemap="#_drive_filter_8c_a09f3131778c9e760bc08a93000b5f47c_cgraph" alt=""/></div>
<map name="_drive_filter_8c_a09f3131778c9e760bc08a93000b5f47c_cgraph" id="_drive_filter_8c_a09f3131778c9e760bc08a93000b5f47c_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a931a50c701d04fe4afe0cebfc37ad49b" title="Validate the buffer size and return TRUE if the requiredBufferSize argument is good. " alt="" coords="247,5,388,32"/>
</map>
</div>

</div>
</div>
<a id="a7a66ec73d373e8c5f922e8d04f78181a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a66ec73d373e8c5f922e8d04f78181a">&#9670;&nbsp;</a></span>GetSetupResult()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS GetSetupResult </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for Setupd Result. </p>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS SetupResult </dd></dl>

</div>
</div>
<a id="a215c1ab6b69620a1886260386c32499d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a215c1ab6b69620a1886260386c32499d">&#9670;&nbsp;</a></span>GetSystemDriveCryptoInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_c_r_y_p_t_o___i_n_f_o__t.html">CRYPTO_INFO</a> * GetSystemDriveCryptoInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the cryptologic information about the system drive. </p>
<dl class="section return"><dt>Returns</dt><dd>CRYPTO_INFO * BootDriveFilterExtension-&gt;Queue.CryptoInfo </dd></dl>

</div>
</div>
<a id="a5eb5c8d246416f300effd75a49592ce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eb5c8d246416f300effd75a49592ce1">&#9670;&nbsp;</a></span>IsBootDriveMounted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL IsBootDriveMounted </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter to know if a drive is mounted. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL BootDriveFilterExtension &amp;&amp; BootDriveFilterExtension-&gt;DriveMounted </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a5eb5c8d246416f300effd75a49592ce1_icgraph.png" border="0" usemap="#_drive_filter_8c_a5eb5c8d246416f300effd75a49592ce1_icgraph" alt=""/></div>
<map name="_drive_filter_8c_a5eb5c8d246416f300effd75a49592ce1_icgraph" id="_drive_filter_8c_a5eb5c8d246416f300effd75a49592ce1_icgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a71ecef9939cec3ebe32b53b0dc2fe16b" title="Unload a driver. " alt="" coords="191,5,311,32"/>
</map>
</div>

</div>
</div>
<a id="a5db0013af3d31cf4fb4494a8a40d0794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5db0013af3d31cf4fb4494a8a40d0794">&#9670;&nbsp;</a></span>IsBootEncryptionSetupInProgress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL IsBootEncryptionSetupInProgress </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for Setud in progress variable. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL SetupInProgress </dd></dl>

</div>
</div>
<a id="a4ff40c543ee494742d77389f9bb1ac5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ff40c543ee494742d77389f9bb1ac5c">&#9670;&nbsp;</a></span>IsDecoySystemWipeInProgress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL IsDecoySystemWipeInProgress </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the decoy wipe system is running or not. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL DecoySystemWipeInProgress </dd></dl>

</div>
</div>
<a id="aed90fff4a3656574fe8e1640cfa14abb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed90fff4a3656574fe8e1640cfa14abb">&#9670;&nbsp;</a></span>IsHiddenSystemRunning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL IsHiddenSystemRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter to know if the system is running. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL BootDriveFilterExtension &amp;&amp; BootDriveFilterExtension-&gt;HiddenSystem </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_aed90fff4a3656574fe8e1640cfa14abb_icgraph.png" border="0" usemap="#_drive_filter_8c_aed90fff4a3656574fe8e1640cfa14abb_icgraph" alt=""/></div>
<map name="_drive_filter_8c_aed90fff4a3656574fe8e1640cfa14abb_icgraph" id="_drive_filter_8c_aed90fff4a3656574fe8e1640cfa14abb_icgraph">
<area shape="rect" id="node2" href="_drive_filter_8c.html#a17e83551909aead4bda4e1c1b87ee0bf" title="Launch the abort of the decoy encrypting system. " alt="" coords="217,5,380,32"/>
</map>
</div>

</div>
</div>
<a id="aea2e8fbefa4e00dfc523629905da1a87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea2e8fbefa4e00dfc523629905da1a87">&#9670;&nbsp;</a></span>LoadBootArguments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS LoadBootArguments </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the boot part segment by segment and set the parameters for the cryptology, where the partition starts ... </p>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS status </dd></dl>

</div>
</div>
<a id="ad42833fd28a6390d2b165aaea9ea2ca6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad42833fd28a6390d2b165aaea9ea2ca6">&#9670;&nbsp;</a></span>ReopenBootVolumeHeader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReopenBootVolumeHeader </td>
          <td>(</td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a request to open the boot volume header and read if accepted. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="ad15951e30bfa20df4b054535755575a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad15951e30bfa20df4b054535755575a1">&#9670;&nbsp;</a></span>StartBootEncryptionSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS StartBootEncryptionSetup </td>
          <td>(</td>
          <td class="paramtype">PDEVICE_OBJECT&#160;</td>
          <td class="paramname"><em>DeviceObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send to the device the packet that will ask to encrypt. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PDEVICE_OBJECT</td><td>DeviceObject </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS status </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_ad15951e30bfa20df4b054535755575a1_cgraph.png" border="0" usemap="#_drive_filter_8c_ad15951e30bfa20df4b054535755575a1_cgraph" alt=""/></div>
<map name="_drive_filter_8c_ad15951e30bfa20df4b054535755575a1_cgraph" id="_drive_filter_8c_ad15951e30bfa20df4b054535755575a1_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a0d693c57a6024c2a6c51c74c04acf374" title="Getter to know if the drive is accessible. " alt="" coords="227,31,409,57"/>
<area shape="rect" id="node3" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="507,5,546,32"/>
<area shape="rect" id="node6" href="_ntdriver_8c.html#a37f8ca946421a5904a1bcf51eb665e3b" title="Getter to know if the user can access the object. " alt="" coords="457,56,596,83"/>
<area shape="rect" id="node4" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="644,5,683,32"/>
<area shape="rect" id="node5" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="731,5,769,32"/>
</map>
</div>

</div>
</div>
<a id="a17e83551909aead4bda4e1c1b87ee0bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e83551909aead4bda4e1c1b87ee0bf">&#9670;&nbsp;</a></span>StartDecoySystemWipe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS StartDecoySystemWipe </td>
          <td>(</td>
          <td class="paramtype">PDEVICE_OBJECT&#160;</td>
          <td class="paramname"><em>DeviceObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Launch the abort of the decoy encrypting system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PDEVICE_OBJECT</td><td>DeviceObject </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS status </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a17e83551909aead4bda4e1c1b87ee0bf_cgraph.png" border="0" usemap="#_drive_filter_8c_a17e83551909aead4bda4e1c1b87ee0bf_cgraph" alt=""/></div>
<map name="_drive_filter_8c_a17e83551909aead4bda4e1c1b87ee0bf_cgraph" id="_drive_filter_8c_a17e83551909aead4bda4e1c1b87ee0bf_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a0d693c57a6024c2a6c51c74c04acf374" title="Getter to know if the drive is accessible. " alt="" coords="216,31,399,57"/>
<area shape="rect" id="node7" href="_drive_filter_8c.html#aed90fff4a3656574fe8e1640cfa14abb" title="Getter to know if the system is running. " alt="" coords="225,81,389,108"/>
<area shape="rect" id="node3" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="497,5,535,32"/>
<area shape="rect" id="node6" href="_ntdriver_8c.html#a37f8ca946421a5904a1bcf51eb665e3b" title="Getter to know if the user can access the object. " alt="" coords="447,56,585,83"/>
<area shape="rect" id="node4" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="633,5,672,32"/>
<area shape="rect" id="node5" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="720,5,759,32"/>
</map>
</div>

</div>
</div>
<a id="a8ebd09edb9be16fddaef3e602fa3f38a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ebd09edb9be16fddaef3e602fa3f38a">&#9670;&nbsp;</a></span>StartLegacyHibernationDriverFilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StartLegacyHibernationDriverFilter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the hibernation of the driver filter. </p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a8ebd09edb9be16fddaef3e602fa3f38a_cgraph.png" border="0" usemap="#_drive_filter_8c_a8ebd09edb9be16fddaef3e602fa3f38a_cgraph" alt=""/></div>
<map name="_drive_filter_8c_a8ebd09edb9be16fddaef3e602fa3f38a_cgraph" id="_drive_filter_8c_a8ebd09edb9be16fddaef3e602fa3f38a_cgraph">
<area shape="rect" id="node2" href="_dlgcode_8c.html#afc9ef476cf0475d4fbcd18be407842ff" title="Check if the os is at least reqMinOS. " alt="" coords="243,13,339,39"/>
<area shape="rect" id="node3" href="_dlgcode_8c.html#a2268419b7b3915d623fc3e7fed14e20c" title="Check if the os version is a least over the first supported version Returns TRUE if the operating sys..." alt="" coords="387,13,527,39"/>
</map>
</div>

</div>
</div>
<a id="a23b86125ef582cb2fb62bbe6bfd099c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23b86125ef582cb2fb62bbe6bfd099c5">&#9670;&nbsp;</a></span>WriteBootDriveSector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS WriteBootDriveSector </td>
          <td>(</td>
          <td class="paramtype">PIRP&#160;</td>
          <td class="paramname"><em>irp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PIO_STACK_LOCATION&#160;</td>
          <td class="paramname"><em>irpSp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write into a soctor of the boot drive. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PIO_STACK_LOCATION</td><td>irpSp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIRP</td><td>irp </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS STATUS_ACCESS_DENIED STATUS_INVALID_PARAMETER </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_drive_filter_8c_a23b86125ef582cb2fb62bbe6bfd099c5_cgraph.png" border="0" usemap="#_drive_filter_8c_a23b86125ef582cb2fb62bbe6bfd099c5_cgraph" alt=""/></div>
<map name="_drive_filter_8c_a23b86125ef582cb2fb62bbe6bfd099c5_cgraph" id="_drive_filter_8c_a23b86125ef582cb2fb62bbe6bfd099c5_cgraph">
<area shape="rect" id="node2" href="_ntdriver_8c.html#a0d693c57a6024c2a6c51c74c04acf374" title="Getter to know if the drive is accessible. " alt="" coords="200,31,383,57"/>
<area shape="rect" id="node7" href="_ntdriver_8c.html#a0e6e8a07fc51935727cfd065baf7011b" title="Write device. " alt="" coords="233,81,350,108"/>
<area shape="rect" id="node3" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="481,5,519,32"/>
<area shape="rect" id="node6" href="_ntdriver_8c.html#a37f8ca946421a5904a1bcf51eb665e3b" title="Getter to know if the user can access the object. " alt="" coords="431,56,569,83"/>
<area shape="rect" id="node4" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="617,5,656,32"/>
<area shape="rect" id="node5" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="704,5,743,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
