<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gostcrypt: Common/Xts.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Gostcrypt
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4ab6b4cc6a7edbff49100e9123df213f.html">Common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Xts.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manage the XTS encryption which consists of switching bytes in blocks before encrypting them. It covers 32 and 64 bytes platforms. there are optimized function for parallel and non parallel.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;Xts.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Xts.c:</div>
<div class="dyncontent">
<div class="center"><img src="_xts_8c__incl.png" border="0" usemap="#_common_2_xts_8c" alt=""/></div>
<map name="_common_2_xts_8c" id="_common_2_xts_8c">
<area shape="rect" id="node2" href="_xts_8h_source.html" title="Xts.h" alt="" coords="61,80,111,107"/>
<area shape="rect" id="node3" href="_gstdefs_8h_source.html" title="Gstdefs.h" alt="" coords="55,304,133,331"/>
<area shape="rect" id="node6" href="_endian_8h_source.html" title="Common/Endian.h" alt="" coords="21,155,151,181"/>
<area shape="rect" id="node7" href="_crypto_8h_source.html" title="Crypto.h" alt="" coords="339,155,409,181"/>
<area shape="rect" id="node8" href="_gost_cipher_8h_source.html" title="GostCipher.h" alt="" coords="325,229,423,256"/>
<area shape="rect" id="node9" href="_grasshopper_cipher_8h_source.html" title="GrasshopperCipher.h" alt="" coords="447,229,591,256"/>
<area shape="rect" id="node10" href="_stribog_8h_source.html" title="Stribog.h" alt="" coords="615,229,690,256"/>
<area shape="rect" id="node11" href="_whirlpool_8h_source.html" title="Whirlpool.h" alt="" coords="213,229,300,256"/>
<area shape="rect" id="node12" href="_gost_hash_8h_source.html" title="GostHash.h" alt="" coords="714,229,805,256"/>
<area shape="rect" id="node13" href="_gf_mul_8h_source.html" title="GfMul.h" alt="" coords="122,229,189,256"/>
<area shape="rect" id="node14" href="_password_8h_source.html" title="Password.h" alt="" coords="829,229,919,256"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aad9147213002ffaa3c0450853005e646"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_xts_8c.html#aad9147213002ffaa3c0450853005e646">EncryptBufferXTS</a> (unsigned __int8 *buffer, <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">GST_LARGEST_COMPILER_UINT</a> length, const <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> *startDataUnitNo, unsigned int startCipherBlockNo, unsigned __int8 *ks, unsigned __int8 *ks2, int cipher)</td></tr>
<tr class="memdesc:aad9147213002ffaa3c0450853005e646"><td class="mdescLeft">&#160;</td><td class="mdescRight">length: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cipher block size ks: the primary key schedule ks2: the secondary key schedule startDataUnitNo: The sequential number of the data unit with which the buffer starts. startCipherBlockNo: The sequential number of the first plaintext block to encrypt inside the data unit startDataUnitNo. When encrypting the data unit from its first block, startCipherBlockNo is 0. The startCipherBlockNo value applies only to the first data unit in the buffer; each successive data unit is encrypted from its first block. The start of the buffer does not have to be aligned with the start of a data unit. If it is aligned, startCipherBlockNo must be 0; if it is not aligned, startCipherBlockNo must reflect the misalignment accordingly.  <a href="#aad9147213002ffaa3c0450853005e646">More...</a><br /></td></tr>
<tr class="separator:aad9147213002ffaa3c0450853005e646"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9db6f7d5ac83732ee40cfdf0ca69e16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_xts_8c.html#af9db6f7d5ac83732ee40cfdf0ca69e16">EncryptBufferXTS8Byte</a> (unsigned __int8 *buffer, <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">GST_LARGEST_COMPILER_UINT</a> length, const <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> *startDataUnitNo, unsigned int startCipherBlockNo, unsigned __int8 *ks, unsigned __int8 *ks2, int cipher)</td></tr>
<tr class="memdesc:af9db6f7d5ac83732ee40cfdf0ca69e16"><td class="mdescLeft">&#160;</td><td class="mdescRight">The goal is to switch some byte of a encrypted data with the next encrypted data. This doesn't hurt the algorithm security and add a switching parameter to the encryption. On a 32-byte data it switches data with another block of data Then encrypt it.  <a href="#af9db6f7d5ac83732ee40cfdf0ca69e16">More...</a><br /></td></tr>
<tr class="separator:af9db6f7d5ac83732ee40cfdf0ca69e16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf61facb05a3ea253498a379275f48a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_xts_8c.html#acf61facb05a3ea253498a379275f48a6">DecryptBufferXTS</a> (unsigned __int8 *buffer, <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">GST_LARGEST_COMPILER_UINT</a> length, const <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> *startDataUnitNo, unsigned int startCipherBlockNo, unsigned __int8 *ks, unsigned __int8 *ks2, int cipher)</td></tr>
<tr class="memdesc:acf61facb05a3ea253498a379275f48a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">For descriptions of the input parameters, see <a class="el" href="_xts_8c.html#aad9147213002ffaa3c0450853005e646" title="length: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cip...">EncryptBufferXTS()</a>. Decrypt before switching back the data.  <a href="#acf61facb05a3ea253498a379275f48a6">More...</a><br /></td></tr>
<tr class="separator:acf61facb05a3ea253498a379275f48a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b750322cc8c20d6c3fab26e0c5553d1"><td class="memItemLeft" align="right" valign="top"><a id="a0b750322cc8c20d6c3fab26e0c5553d1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>DecryptBufferXTS8Byte</b> (unsigned __int8 *buffer, <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">GST_LARGEST_COMPILER_UINT</a> length, const <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> *startDataUnitNo, unsigned int startCipherBlockNo, unsigned __int8 *ks, unsigned __int8 *ks2, int cipher)</td></tr>
<tr class="separator:a0b750322cc8c20d6c3fab26e0c5553d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manage the XTS encryption which consists of switching bytes in blocks before encrypting them. It covers 32 and 64 bytes platforms. there are optimized function for parallel and non parallel. </p>
<dl class="section version"><dt>Version</dt><dd>1.3.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>23/01/2017 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="acf61facb05a3ea253498a379275f48a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf61facb05a3ea253498a379275f48a6">&#9670;&nbsp;</a></span>DecryptBufferXTS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DecryptBufferXTS </td>
          <td>(</td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">GST_LARGEST_COMPILER_UINT</a>&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> *&#160;</td>
          <td class="paramname"><em>startDataUnitNo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>startCipherBlockNo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>ks2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For descriptions of the input parameters, see <a class="el" href="_xts_8c.html#aad9147213002ffaa3c0450853005e646" title="length: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cip...">EncryptBufferXTS()</a>. Decrypt before switching back the data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GST_LARGEST_COMPILER_UINT</td><td>length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">const</td><td><a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> * startDataUnitNo </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>int startCipherBlockNo </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * ks </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * ks2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>cipher </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_xts_8c_acf61facb05a3ea253498a379275f48a6_icgraph.png" border="0" usemap="#_xts_8c_acf61facb05a3ea253498a379275f48a6_icgraph" alt=""/></div>
<map name="_xts_8c_acf61facb05a3ea253498a379275f48a6_icgraph" id="_xts_8c_acf61facb05a3ea253498a379275f48a6_icgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#adf61d3050038714fbf5f958453f4c68a" title="buf: data to be decrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="229,201,329,228"/>
<area shape="rect" id="node3" href="_crypto_8c.html#aaed9b2d5a4b22439e8646cda3f0db1aa" title="Returns the maximum number of bytes necessary to be generated by the PBKDF2 (PKCS #5) ..." alt="" coords="457,150,609,177"/>
<area shape="rect" id="node13" href="_crypto_8c.html#a457c1dba3b86de8a3ae8f9de4c9ba385" title="buf: data to be decrypted unitNo: sequential number of the data unit with which the buffer starts nbr..." alt="" coords="176,252,381,278"/>
<area shape="rect" id="node9" href="_volumes_8c.html#afa713bf1fa27171e0cc0aa16218fe10e" title="Read the volume header using getter from 16 to 64 bits. It permits to load the volume with its parame..." alt="" coords="700,201,837,228"/>
<area shape="rect" id="node11" href="_tests_8c.html#a56d230d77b34ccd318135fbaeee388f1" title="Test the legacy mode for boot encryption. " alt="" coords="429,252,637,278"/>
<area shape="rect" id="node4" href="_random_8c.html#a4c51a11fb671c29c6f9c22e3db140618" title="Init the random number generator, setup the hooks, and start the thread. " alt="" coords="734,100,803,126"/>
<area shape="rect" id="node5" href="class_gost_crypt_1_1_boot_encryption.html#ae96eefda4ed624bd336f89b4a261b2c1" title="Start the decoy OS wipe. " alt="" coords="1151,27,1329,68"/>
<area shape="rect" id="node6" href="class_gost_crypt_1_1_boot_encryption.html#ab87016e42d7f7826282297e50db00742" title="Wipe the fidden OS creation on configuration. " alt="" coords="900,34,1103,75"/>
<area shape="rect" id="node7" href="class_gost_crypt_1_1_boot_encryption.html#a9cce66955923f808f4dd297c7041ac5b" title="Change the password. " alt="" coords="1151,143,1329,184"/>
<area shape="rect" id="node8" href="_dlgcode_8c.html#a9baeca25d1e47e9f4068efe8bff24c3c" title="User enrichement a random pool. " alt="" coords="921,100,1081,126"/>
<area shape="rect" id="node10" href="_cache_8c.html#adf059051b371da0777591dc451201226" title="Attempt to recognize volume using the mount password. " alt="" coords="908,252,1095,278"/>
<area shape="rect" id="node12" href="_tests_8c.html#a9f2eb67594414b8bea27e345fc69fdef" title="Encrypt same value of data to test if the encryption algorithm woks well. " alt="" coords="685,252,852,278"/>
</map>
</div>

</div>
</div>
<a id="aad9147213002ffaa3c0450853005e646"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad9147213002ffaa3c0450853005e646">&#9670;&nbsp;</a></span>EncryptBufferXTS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EncryptBufferXTS </td>
          <td>(</td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">GST_LARGEST_COMPILER_UINT</a>&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> *&#160;</td>
          <td class="paramname"><em>startDataUnitNo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>startCipherBlockNo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>ks2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>length: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cipher block size ks: the primary key schedule ks2: the secondary key schedule startDataUnitNo: The sequential number of the data unit with which the buffer starts. startCipherBlockNo: The sequential number of the first plaintext block to encrypt inside the data unit startDataUnitNo. When encrypting the data unit from its first block, startCipherBlockNo is 0. The startCipherBlockNo value applies only to the first data unit in the buffer; each successive data unit is encrypted from its first block. The start of the buffer does not have to be aligned with the start of a data unit. If it is aligned, startCipherBlockNo must be 0; if it is not aligned, startCipherBlockNo must reflect the misalignment accordingly. </p>
<p>Copyright (c) 2008-2010 TrueCrypt Developers Association. All rights reserved.</p>
<p>Governed by the TrueCrypt License 3.0 the full text of which is contained in the file License.txt included in TrueCrypt binary and source code distribution packages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GST_LARGEST_COMPILER_UINT</td><td>length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">const</td><td><a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> * startDataUnitNo </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>int startCipherBlockNo </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * ks </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * ks2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>cipher </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_xts_8c_aad9147213002ffaa3c0450853005e646_icgraph.png" border="0" usemap="#_xts_8c_aad9147213002ffaa3c0450853005e646_icgraph" alt=""/></div>
<map name="_xts_8c_aad9147213002ffaa3c0450853005e646_icgraph" id="_xts_8c_aad9147213002ffaa3c0450853005e646_icgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#aae913410eb90f16a1ca4021032880ead" title="buf: data to be encrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="229,252,329,278"/>
<area shape="rect" id="node3" href="_crypto_8c.html#aaed9b2d5a4b22439e8646cda3f0db1aa" title="Returns the maximum number of bytes necessary to be generated by the PBKDF2 (PKCS #5) ..." alt="" coords="457,201,609,228"/>
<area shape="rect" id="node14" href="_crypto_8c.html#a1bc4abcc8daf0185a981e6ec53c65d1a" title="Encryt data of current thread. " alt="" coords="176,302,381,329"/>
<area shape="rect" id="node11" href="_tests_8c.html#a56d230d77b34ccd318135fbaeee388f1" title="Test the legacy mode for boot encryption. " alt="" coords="429,252,637,278"/>
<area shape="rect" id="node13" href="_volumes_8c.html#a31bc369dec32aaee5793685da60c640b" title="Writes randomly generated data to unused/reserved header areas. When bPrimaryOnly is TRUE..." alt="" coords="436,303,631,344"/>
<area shape="rect" id="node4" href="_random_8c.html#a4c51a11fb671c29c6f9c22e3db140618" title="Init the random number generator, setup the hooks, and start the thread. " alt="" coords="734,100,803,126"/>
<area shape="rect" id="node9" href="_volumes_8c.html#afa713bf1fa27171e0cc0aa16218fe10e" title="Read the volume header using getter from 16 to 64 bits. It permits to load the volume with its parame..." alt="" coords="700,201,837,228"/>
<area shape="rect" id="node5" href="class_gost_crypt_1_1_boot_encryption.html#ae96eefda4ed624bd336f89b4a261b2c1" title="Start the decoy OS wipe. " alt="" coords="1151,27,1329,68"/>
<area shape="rect" id="node6" href="class_gost_crypt_1_1_boot_encryption.html#ab87016e42d7f7826282297e50db00742" title="Wipe the fidden OS creation on configuration. " alt="" coords="900,34,1103,75"/>
<area shape="rect" id="node7" href="class_gost_crypt_1_1_boot_encryption.html#a9cce66955923f808f4dd297c7041ac5b" title="Change the password. " alt="" coords="1151,143,1329,184"/>
<area shape="rect" id="node8" href="_dlgcode_8c.html#a9baeca25d1e47e9f4068efe8bff24c3c" title="User enrichement a random pool. " alt="" coords="921,100,1081,126"/>
<area shape="rect" id="node10" href="_cache_8c.html#adf059051b371da0777591dc451201226" title="Attempt to recognize volume using the mount password. " alt="" coords="908,252,1095,278"/>
<area shape="rect" id="node12" href="_tests_8c.html#a9f2eb67594414b8bea27e345fc69fdef" title="Encrypt same value of data to test if the encryption algorithm woks well. " alt="" coords="685,252,852,278"/>
</map>
</div>

</div>
</div>
<a id="af9db6f7d5ac83732ee40cfdf0ca69e16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9db6f7d5ac83732ee40cfdf0ca69e16">&#9670;&nbsp;</a></span>EncryptBufferXTS8Byte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EncryptBufferXTS8Byte </td>
          <td>(</td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">GST_LARGEST_COMPILER_UINT</a>&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> *&#160;</td>
          <td class="paramname"><em>startDataUnitNo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>startCipherBlockNo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned __int8 *&#160;</td>
          <td class="paramname"><em>ks2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cipher</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The goal is to switch some byte of a encrypted data with the next encrypted data. This doesn't hurt the algorithm security and add a switching parameter to the encryption. On a 32-byte data it switches data with another block of data Then encrypt it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GST_LARGEST_COMPILER_UINT</td><td>length </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">const</td><td><a class="el" href="union_u_i_n_t64___s_t_r_u_c_t.html">UINT64_STRUCT</a> * startDataUnitNo </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>int startCipherBlockNo </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * ks </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int8 * ks2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>cipher </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_xts_8c_af9db6f7d5ac83732ee40cfdf0ca69e16_icgraph.png" border="0" usemap="#_xts_8c_af9db6f7d5ac83732ee40cfdf0ca69e16_icgraph" alt=""/></div>
<map name="_xts_8c_af9db6f7d5ac83732ee40cfdf0ca69e16_icgraph" id="_xts_8c_af9db6f7d5ac83732ee40cfdf0ca69e16_icgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#aae913410eb90f16a1ca4021032880ead" title="buf: data to be encrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="263,252,363,278"/>
<area shape="rect" id="node3" href="_crypto_8c.html#aaed9b2d5a4b22439e8646cda3f0db1aa" title="Returns the maximum number of bytes necessary to be generated by the PBKDF2 (PKCS #5) ..." alt="" coords="492,201,644,228"/>
<area shape="rect" id="node14" href="_crypto_8c.html#a1bc4abcc8daf0185a981e6ec53c65d1a" title="Encryt data of current thread. " alt="" coords="211,302,416,329"/>
<area shape="rect" id="node11" href="_tests_8c.html#a56d230d77b34ccd318135fbaeee388f1" title="Test the legacy mode for boot encryption. " alt="" coords="464,252,672,278"/>
<area shape="rect" id="node13" href="_volumes_8c.html#a31bc369dec32aaee5793685da60c640b" title="Writes randomly generated data to unused/reserved header areas. When bPrimaryOnly is TRUE..." alt="" coords="471,303,665,344"/>
<area shape="rect" id="node4" href="_random_8c.html#a4c51a11fb671c29c6f9c22e3db140618" title="Init the random number generator, setup the hooks, and start the thread. " alt="" coords="769,100,838,126"/>
<area shape="rect" id="node9" href="_volumes_8c.html#afa713bf1fa27171e0cc0aa16218fe10e" title="Read the volume header using getter from 16 to 64 bits. It permits to load the volume with its parame..." alt="" coords="735,201,872,228"/>
<area shape="rect" id="node5" href="class_gost_crypt_1_1_boot_encryption.html#ae96eefda4ed624bd336f89b4a261b2c1" title="Start the decoy OS wipe. " alt="" coords="1185,27,1364,68"/>
<area shape="rect" id="node6" href="class_gost_crypt_1_1_boot_encryption.html#ab87016e42d7f7826282297e50db00742" title="Wipe the fidden OS creation on configuration. " alt="" coords="935,34,1137,75"/>
<area shape="rect" id="node7" href="class_gost_crypt_1_1_boot_encryption.html#a9cce66955923f808f4dd297c7041ac5b" title="Change the password. " alt="" coords="1185,143,1364,184"/>
<area shape="rect" id="node8" href="_dlgcode_8c.html#a9baeca25d1e47e9f4068efe8bff24c3c" title="User enrichement a random pool. " alt="" coords="956,100,1116,126"/>
<area shape="rect" id="node10" href="_cache_8c.html#adf059051b371da0777591dc451201226" title="Attempt to recognize volume using the mount password. " alt="" coords="943,252,1129,278"/>
<area shape="rect" id="node12" href="_tests_8c.html#a9f2eb67594414b8bea27e345fc69fdef" title="Encrypt same value of data to test if the encryption algorithm woks well. " alt="" coords="720,252,887,278"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
