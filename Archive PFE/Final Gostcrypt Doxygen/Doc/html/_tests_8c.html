<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gostcrypt: Common/Tests.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Gostcrypt
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4ab6b4cc6a7edbff49100e9123df213f.html">Common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Tests.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Define some fake data to encrypt where we know the results then encrypt them to test all the algorithm on the installed machine. The file defines the function that will test.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;Gstdefs.h&quot;</code><br />
<code>#include &quot;Crc.h&quot;</code><br />
<code>#include &quot;Crypto.h&quot;</code><br />
<code>#include &quot;Common/Endian.h&quot;</code><br />
<code>#include &quot;Tests.h&quot;</code><br />
<code>#include &quot;Xts.h&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;Pkcs5.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Tests.c:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c__incl.png" border="0" usemap="#_common_2_tests_8c" alt=""/></div>
<map name="_common_2_tests_8c" id="_common_2_tests_8c">
<area shape="rect" id="node2" href="_gstdefs_8h_source.html" title="Gstdefs.h" alt="" coords="345,304,424,331"/>
<area shape="rect" id="node5" href="_crc_8h_source.html" title="Crc.h" alt="" coords="330,155,383,181"/>
<area shape="rect" id="node6" href="_crypto_8h_source.html" title="Crypto.h" alt="" coords="725,155,796,181"/>
<area shape="rect" id="node14" href="_endian_8h_source.html" title="Common/Endian.h" alt="" coords="152,155,281,181"/>
<area shape="rect" id="node15" href="_tests_8h_source.html" title="Tests.h" alt="" coords="497,80,563,107"/>
<area shape="rect" id="node16" href="_xts_8h_source.html" title="Xts.h" alt="" coords="371,80,422,107"/>
<area shape="rect" id="node18" href="_pkcs5_8h_source.html" title="Pkcs5.h" alt="" coords="5,155,76,181"/>
<area shape="rect" id="node7" href="_gost_cipher_8h_source.html" title="GostCipher.h" alt="" coords="422,229,521,256"/>
<area shape="rect" id="node8" href="_grasshopper_cipher_8h_source.html" title="GrasshopperCipher.h" alt="" coords="545,229,689,256"/>
<area shape="rect" id="node9" href="_stribog_8h_source.html" title="Stribog.h" alt="" coords="854,229,929,256"/>
<area shape="rect" id="node10" href="_whirlpool_8h_source.html" title="Whirlpool.h" alt="" coords="1183,229,1269,256"/>
<area shape="rect" id="node11" href="_gost_hash_8h_source.html" title="GostHash.h" alt="" coords="953,229,1043,256"/>
<area shape="rect" id="node12" href="_gf_mul_8h_source.html" title="GfMul.h" alt="" coords="763,229,830,256"/>
<area shape="rect" id="node13" href="_password_8h_source.html" title="Password.h" alt="" coords="1067,229,1158,256"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_x_t_s___t_e_s_t.html">XTS_TEST</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad5f017aff0060a12802d71b7dfb7a376"><td class="memItemLeft" align="right" valign="top"><a id="ad5f017aff0060a12802d71b7dfb7a376"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>XTS_TEST_COUNT</b>&#160;&#160;&#160;5</td></tr>
<tr class="separator:ad5f017aff0060a12802d71b7dfb7a376"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad617523ccc7cb2ef8df5cbeefd26b68c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#ad617523ccc7cb2ef8df5cbeefd26b68c">CipherInit2</a> (int cipher, void *key, void *ks, int key_len)</td></tr>
<tr class="memdesc:ad617523ccc7cb2ef8df5cbeefd26b68c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init the key and ciphers depending the cipher value.  <a href="#ad617523ccc7cb2ef8df5cbeefd26b68c">More...</a><br /></td></tr>
<tr class="separator:ad617523ccc7cb2ef8df5cbeefd26b68c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ce3754a4463f9d2281cfabafb0b779"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#a84ce3754a4463f9d2281cfabafb0b779">TestCRCs</a> (char *buf)</td></tr>
<tr class="memdesc:a84ce3754a4463f9d2281cfabafb0b779"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the stribog algorithm.  <a href="#a84ce3754a4463f9d2281cfabafb0b779">More...</a><br /></td></tr>
<tr class="separator:a84ce3754a4463f9d2281cfabafb0b779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f2eb67594414b8bea27e345fc69fdef"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#a9f2eb67594414b8bea27e345fc69fdef">TestSectorBufEncryption</a> (<a class="el" href="struct_c_r_y_p_t_o___i_n_f_o__t.html">PCRYPTO_INFO</a> ci)</td></tr>
<tr class="memdesc:a9f2eb67594414b8bea27e345fc69fdef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt same value of data to test if the encryption algorithm woks well.  <a href="#a9f2eb67594414b8bea27e345fc69fdef">More...</a><br /></td></tr>
<tr class="separator:a9f2eb67594414b8bea27e345fc69fdef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d230d77b34ccd318135fbaeee388f1"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#a56d230d77b34ccd318135fbaeee388f1">TestLegacySectorBufEncryption</a> (<a class="el" href="struct_c_r_y_p_t_o___i_n_f_o__t.html">PCRYPTO_INFO</a> ci)</td></tr>
<tr class="memdesc:a56d230d77b34ccd318135fbaeee388f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the legacy mode for boot encryption.  <a href="#a56d230d77b34ccd318135fbaeee388f1">More...</a><br /></td></tr>
<tr class="separator:a56d230d77b34ccd318135fbaeee388f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3419657af70c95047111e21b37a484b7"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#a3419657af70c95047111e21b37a484b7">AutoTestAlgorithms</a> (void)</td></tr>
<tr class="memdesc:a3419657af70c95047111e21b37a484b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Launch the auto test algorithm before EnableHwEncryption and after setting it.  <a href="#a3419657af70c95047111e21b37a484b7">More...</a><br /></td></tr>
<tr class="separator:a3419657af70c95047111e21b37a484b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af13a8c116ddf948cb0a505ffe5d84657"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#af13a8c116ddf948cb0a505ffe5d84657">test_hmac_whirlpool</a> ()</td></tr>
<tr class="memdesc:af13a8c116ddf948cb0a505ffe5d84657"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the whirpool with algorithm.  <a href="#af13a8c116ddf948cb0a505ffe5d84657">More...</a><br /></td></tr>
<tr class="separator:af13a8c116ddf948cb0a505ffe5d84657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae410069dfc9af368167a9b60860e68c5"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#ae410069dfc9af368167a9b60860e68c5">test_hmac_gosthash</a> ()</td></tr>
<tr class="memdesc:ae410069dfc9af368167a9b60860e68c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the gosthash.  <a href="#ae410069dfc9af368167a9b60860e68c5">More...</a><br /></td></tr>
<tr class="separator:ae410069dfc9af368167a9b60860e68c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404584bd0f9ebbd806d2012b00d543b0"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#a404584bd0f9ebbd806d2012b00d543b0">test_hmac_stribog</a> ()</td></tr>
<tr class="memdesc:a404584bd0f9ebbd806d2012b00d543b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the stribog algorithm.  <a href="#a404584bd0f9ebbd806d2012b00d543b0">More...</a><br /></td></tr>
<tr class="separator:a404584bd0f9ebbd806d2012b00d543b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dca7b0d4c13132eeef1cccbc09cd9e3"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_tests_8c.html#a7dca7b0d4c13132eeef1cccbc09cd9e3">test_pkcs5</a> ()</td></tr>
<tr class="memdesc:a7dca7b0d4c13132eeef1cccbc09cd9e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the whole pkcs5.  <a href="#a7dca7b0d4c13132eeef1cccbc09cd9e3">More...</a><br /></td></tr>
<tr class="separator:a7dca7b0d4c13132eeef1cccbc09cd9e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1faa20c31c7bdc0a34ad1f5c07b22cc8"><td class="memItemLeft" align="right" valign="top"><a id="a1faa20c31c7bdc0a34ad1f5c07b22cc8"></a>
<a class="el" href="struct_x_t_s___t_e_s_t.html">XTS_TEST</a>&#160;</td><td class="memItemRight" valign="bottom"><b>XTS_vectors</b> [XTS_TEST_COUNT]</td></tr>
<tr class="separator:a1faa20c31c7bdc0a34ad1f5c07b22cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a865ecd2f8e4cfcb4a49e422097ac494e"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_whirlpool_test_key</b></td></tr>
<tr class="separator:a865ecd2f8e4cfcb4a49e422097ac494e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845192a8755185349a6afd1aa5142cc2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_whirlpool_test_data</b></td></tr>
<tr class="separator:a845192a8755185349a6afd1aa5142cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8469e44c5aa501e8a1be310685f27b29"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_whirlpool_test_vectors</b></td></tr>
<tr class="separator:a8469e44c5aa501e8a1be310685f27b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac77596640668b0c0890b99ef15924f04"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_gosthash_test_key</b></td></tr>
<tr class="separator:ac77596640668b0c0890b99ef15924f04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b88dcf8e71277fea9baec941511ee14"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_gosthash_test_data</b></td></tr>
<tr class="separator:a3b88dcf8e71277fea9baec941511ee14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba879dbba59727a77a6e5b43cb8a690c"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_gosthash_test_vectors</b></td></tr>
<tr class="separator:aba879dbba59727a77a6e5b43cb8a690c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30ff4e64859229aa28cb73fb13a69d75"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_stribog_test_key</b></td></tr>
<tr class="separator:a30ff4e64859229aa28cb73fb13a69d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e4a4d015489f4e28ae426670238f2d2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_stribog_test_data</b></td></tr>
<tr class="separator:a6e4a4d015489f4e28ae426670238f2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5136b9069100f9dee7b10ea1fcf15f7"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><b>hmac_stribog_test_vectors</b></td></tr>
<tr class="separator:ac5136b9069100f9dee7b10ea1fcf15f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6719c16548a84ab3a861dfc0aeb5d898"><td class="memItemLeft" align="right" valign="top"><a id="a6719c16548a84ab3a861dfc0aeb5d898"></a>
unsigned char&#160;</td><td class="memItemRight" valign="bottom"><b>ks_tmp</b> [MAX_EXPANDED_KEY]</td></tr>
<tr class="separator:a6719c16548a84ab3a861dfc0aeb5d898"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Define some fake data to encrypt where we know the results then encrypt them to test all the algorithm on the installed machine. The file defines the function that will test. </p>
<dl class="section version"><dt>Version</dt><dd>1.3.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>16/12/2016 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3419657af70c95047111e21b37a484b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3419657af70c95047111e21b37a484b7">&#9670;&nbsp;</a></span>AutoTestAlgorithms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL AutoTestAlgorithms </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Launch the auto test algorithm before EnableHwEncryption and after setting it. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL result </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a3419657af70c95047111e21b37a484b7_cgraph.png" border="0" usemap="#_tests_8c_a3419657af70c95047111e21b37a484b7_cgraph" alt=""/></div>
<map name="_tests_8c_a3419657af70c95047111e21b37a484b7_cgraph" id="_tests_8c_a3419657af70c95047111e21b37a484b7_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#a19902ebd9dff0b82738b690a966b501b" title="Is Hardware encryption enabled. " alt="" coords="189,5,348,32"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a2ed7a4e1da14e3a1855fb83b7fcb4270" title="Deprecated useless. " alt="" coords="197,56,340,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a3419657af70c95047111e21b37a484b7_icgraph.png" border="0" usemap="#_tests_8c_a3419657af70c95047111e21b37a484b7_icgraph" alt=""/></div>
<map name="_tests_8c_a3419657af70c95047111e21b37a484b7_icgraph" id="_tests_8c_a3419657af70c95047111e21b37a484b7_icgraph">
<area shape="rect" id="node2" href="_dump_filter_8c.html#ab65bb80f061946645cf93774b37d53a8" title="Check the driver version of the main device get his dump configuration. Verify that it is located on ..." alt="" coords="189,5,305,32"/>
</map>
</div>

</div>
</div>
<a id="ad617523ccc7cb2ef8df5cbeefd26b68c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad617523ccc7cb2ef8df5cbeefd26b68c">&#9670;&nbsp;</a></span>CipherInit2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CipherInit2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init the key and ciphers depending the cipher value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>cipher </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">void</td><td>* key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">void</td><td>* ks </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>key_len </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_ad617523ccc7cb2ef8df5cbeefd26b68c_cgraph.png" border="0" usemap="#_tests_8c_ad617523ccc7cb2ef8df5cbeefd26b68c_cgraph" alt=""/></div>
<map name="_tests_8c_ad617523ccc7cb2ef8df5cbeefd26b68c_cgraph" id="_tests_8c_ad617523ccc7cb2ef8df5cbeefd26b68c_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#aa38ecf7977d369eb9f080b1498e48738" title="Initialise cipher Return values: 0 = success, ERR_CIPHER_INIT_FAILURE (fatal), ERR_CIPHER_INIT_WEAK_K..." alt="" coords="136,31,212,57"/>
<area shape="rect" id="node3" href="_gost_cipher_8c.html#a894c8f0e07a5614968fca09f7ae1f24b" title="Set the gost key Generate a pseudo random data (based on the key) and set the key. " alt="" coords="283,5,383,32"/>
<area shape="rect" id="node4" href="_grasshopper_cipher_8c.html#a6b136aade799131cab66db1d5d4df8b0" title="Key setup procedure. " alt="" coords="260,56,407,83"/>
<area shape="rect" id="node5" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="607,31,645,57"/>
<area shape="rect" id="node8" href="_grasshopper_cipher_8c.html#a6107e1c52141eb86bb87182173247783" title="Switch opposed bytes (lower byte to upper byte, ...) of unsigned long. " alt="" coords="455,56,559,83"/>
<area shape="rect" id="node9" href="_grasshopper_cipher_8c.html#acea73ea2211a8c6ff219e586d742d99f" title="F conversion (used in key setup) " alt="" coords="487,107,526,133"/>
<area shape="rect" id="node6" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="693,31,732,57"/>
<area shape="rect" id="node7" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="780,31,819,57"/>
</map>
</div>

</div>
</div>
<a id="ae410069dfc9af368167a9b60860e68c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae410069dfc9af368167a9b60860e68c5">&#9670;&nbsp;</a></span>test_hmac_gosthash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL test_hmac_gosthash </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test the gosthash. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL FALSE if (memcmp (digest, hmac_gosthash_test_vectors, GOSTHASH_DIGESTSIZE) != 0) TRUE otherwise </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_ae410069dfc9af368167a9b60860e68c5_cgraph.png" border="0" usemap="#_tests_8c_ae410069dfc9af368167a9b60860e68c5_cgraph" alt=""/></div>
<map name="_tests_8c_ae410069dfc9af368167a9b60860e68c5_cgraph" id="_tests_8c_ae410069dfc9af368167a9b60860e68c5_cgraph">
<area shape="rect" id="node2" href="_pkcs5_8c.html#a28c13a2daed07c552b96258521cfa359" title="Gost hash : encrypt the data thanks to the key with gost algorithm. " alt="" coords="196,56,311,83"/>
<area shape="rect" id="node3" href="_gost_hash_8c.html#a2522137f128b93d83f8e60e98649fbb7" title="initialize GOSTHASH (set blocks) " alt="" coords="370,5,489,32"/>
<area shape="rect" id="node4" href="_gost_hash_8c.html#a85ebb98a64431b2eac86f8a5f3ba721f" title="add a gost hash " alt="" coords="368,56,491,83"/>
<area shape="rect" id="node5" href="_gost_hash_8c.html#afdcf3fdde11b1abe034ad3a020dbc51d" title="Finalization of the gost hash. " alt="" coords="359,107,500,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_ae410069dfc9af368167a9b60860e68c5_icgraph.png" border="0" usemap="#_tests_8c_ae410069dfc9af368167a9b60860e68c5_icgraph" alt=""/></div>
<map name="_tests_8c_ae410069dfc9af368167a9b60860e68c5_icgraph" id="_tests_8c_ae410069dfc9af368167a9b60860e68c5_icgraph">
<area shape="rect" id="node2" href="_tests_8c.html#a7dca7b0d4c13132eeef1cccbc09cd9e3" title="Test the whole pkcs5. " alt="" coords="196,5,283,32"/>
</map>
</div>

</div>
</div>
<a id="a404584bd0f9ebbd806d2012b00d543b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404584bd0f9ebbd806d2012b00d543b0">&#9670;&nbsp;</a></span>test_hmac_stribog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL test_hmac_stribog </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test the stribog algorithm. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL FALSE if (memcmp (digest, hmac_stribog_test_vectors, STRIBOG_DIGESTSIZE) != 0) TRUE otherwise </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_cgraph.png" border="0" usemap="#_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_cgraph" alt=""/></div>
<map name="_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_cgraph" id="_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_cgraph">
<area shape="rect" id="node2" href="_pkcs5_8c.html#a7e5365dc742aa6f9caa5b6bf29ef79e2" title="Make the derivative of the stribog key (iterate and change bits in it) " alt="" coords="183,56,283,83"/>
<area shape="rect" id="node3" href="_stribog_8c.html#a35dd8d9b4aa0af02ddb28c60bb3c3877" title="Initialize ctx variable (v512 = 0x200 or 512 in decimal) " alt="" coords="343,5,445,32"/>
<area shape="rect" id="node4" href="_stribog_8c.html#a0ff21cd42b69ce40de0e62e9b7e3b7fb" title="Perform a round on the now 512&#45;bit large remainder While there is more than 64 bytes available..." alt="" coords="341,56,447,83"/>
<area shape="rect" id="node5" href="_stribog_8c.html#a5845b664f371f429107cb502511e9c0e" title="Hash the last (padded) message block Add ctx&#45;&gt;left (max value represented by bitmask 0x3FF) to N This..." alt="" coords="331,107,457,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_icgraph.png" border="0" usemap="#_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_icgraph" alt=""/></div>
<map name="_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_icgraph" id="_tests_8c_a404584bd0f9ebbd806d2012b00d543b0_icgraph">
<area shape="rect" id="node2" href="_tests_8c.html#a7dca7b0d4c13132eeef1cccbc09cd9e3" title="Test the whole pkcs5. " alt="" coords="183,5,269,32"/>
</map>
</div>

</div>
</div>
<a id="af13a8c116ddf948cb0a505ffe5d84657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af13a8c116ddf948cb0a505ffe5d84657">&#9670;&nbsp;</a></span>test_hmac_whirlpool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL test_hmac_whirlpool </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test the whirpool with algorithm. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL FALSE if (memcmp (digest, hmac_whirlpool_test_vectors, WHIRLPOOL_DIGESTSIZE) != 0) TRUE otherwise </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_cgraph.png" border="0" usemap="#_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_cgraph" alt=""/></div>
<map name="_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_cgraph" id="_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_cgraph">
<area shape="rect" id="node2" href="_pkcs5_8c.html#a7b91e9a8cdacd74fa540bc2644be7cc7" title="Encrypt the data thanks to the secret key k, truncate data if bigger than algorithm block size..." alt="" coords="193,5,304,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_icgraph.png" border="0" usemap="#_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_icgraph" alt=""/></div>
<map name="_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_icgraph" id="_tests_8c_af13a8c116ddf948cb0a505ffe5d84657_icgraph">
<area shape="rect" id="node2" href="_tests_8c.html#a7dca7b0d4c13132eeef1cccbc09cd9e3" title="Test the whole pkcs5. " alt="" coords="193,5,280,32"/>
</map>
</div>

</div>
</div>
<a id="a7dca7b0d4c13132eeef1cccbc09cd9e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dca7b0d4c13132eeef1cccbc09cd9e3">&#9670;&nbsp;</a></span>test_pkcs5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL test_pkcs5 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test the whole pkcs5. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL FALSE if (<a class="el" href="_tests_8c.html#af13a8c116ddf948cb0a505ffe5d84657" title="Test the whirpool with algorithm. ">test_hmac_whirlpool()</a> == FALSE) FALSE if (<a class="el" href="_tests_8c.html#ae410069dfc9af368167a9b60860e68c5" title="Test the gosthash. ">test_hmac_gosthash()</a> == FALSE) FALSE if (<a class="el" href="_tests_8c.html#a404584bd0f9ebbd806d2012b00d543b0" title="Test the stribog algorithm. ">test_hmac_stribog()</a> == FALSE) FALSE if (memcmp (dk, "\x50\x7c\x36\x6f", 4) != 0) FALSE if if (memcmp (dk, "\x50\x7c\x36\x6f\xee\x10\x2e\x9a\xe2\x8a\xd5\x82\x72\x7d\x27\x0f\xe8\x4d\x7f\x68\x7a\xcf\xb5\xe7\x43\x67\xaa\x98\x93\x52\x2b\x09\x6e\x42\xdf\x2c\x59\x4a\x91\x6d\x7e\x10\xae\xb2\x1a\x89\x8f\xb9\x8f\xe6\x31\xa9\xd8\x9f\x98\x26\xf4\xda\xcd\x7d\x65\x65\xde\x10\x95\x91\xb4\x84\x26\xae\x43\xa1\x00\x5b\x1e\xb8\x38\x97\xa4\x1e\x4b\xd2\x65\x64\xbc\xfa\x1f\x35\x85\xdb\x4f\x97\x65\x6f\xbd\x24", 96) != 0) FALSE if (memcmp (dk, "\x7d\x53\xe0\x7e", 4) != 0) FALSE if (memcmp (dk, "\xc7\x13\x56\xb6", 4) != 0) TRUE otherwise </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a7dca7b0d4c13132eeef1cccbc09cd9e3_cgraph.png" border="0" usemap="#_tests_8c_a7dca7b0d4c13132eeef1cccbc09cd9e3_cgraph" alt=""/></div>
<map name="_tests_8c_a7dca7b0d4c13132eeef1cccbc09cd9e3_cgraph" id="_tests_8c_a7dca7b0d4c13132eeef1cccbc09cd9e3_cgraph">
<area shape="rect" id="node2" href="_tests_8c.html#af13a8c116ddf948cb0a505ffe5d84657" title="Test the whirpool with algorithm. " alt="" coords="141,31,281,57"/>
<area shape="rect" id="node4" href="_tests_8c.html#ae410069dfc9af368167a9b60860e68c5" title="Test the gosthash. " alt="" coords="140,81,283,108"/>
<area shape="rect" id="node9" href="_tests_8c.html#a404584bd0f9ebbd806d2012b00d543b0" title="Test the stribog algorithm. " alt="" coords="147,132,276,159"/>
<area shape="rect" id="node14" href="_pkcs5_8c.html#a8ff824bd676357439142d52ce0283c65" title="Change the blocks of the key iteratively. " alt="" coords="141,183,281,209"/>
<area shape="rect" id="node15" href="_pkcs5_8c.html#a4fdd0af868701442216b4c99cc127087" title="Make the derivative of the key (iterate and change bits in it) " alt="" coords="140,233,283,260"/>
<area shape="rect" id="node16" href="_pkcs5_8c.html#aac1e0891a72ae792abca9529fbf9ef28" title="Derive the stribog key (cahnge the bits iteratively) " alt="" coords="147,284,276,311"/>
<area shape="rect" id="node3" href="_pkcs5_8c.html#a7b91e9a8cdacd74fa540bc2644be7cc7" title="Encrypt the data thanks to the secret key k, truncate data if bigger than algorithm block size..." alt="" coords="333,31,443,57"/>
<area shape="rect" id="node5" href="_pkcs5_8c.html#a28c13a2daed07c552b96258521cfa359" title="Gost hash : encrypt the data thanks to the key with gost algorithm. " alt="" coords="331,81,445,108"/>
<area shape="rect" id="node6" href="_gost_hash_8c.html#a2522137f128b93d83f8e60e98649fbb7" title="initialize GOSTHASH (set blocks) " alt="" coords="505,5,623,32"/>
<area shape="rect" id="node7" href="_gost_hash_8c.html#a85ebb98a64431b2eac86f8a5f3ba721f" title="add a gost hash " alt="" coords="503,56,625,83"/>
<area shape="rect" id="node8" href="_gost_hash_8c.html#afdcf3fdde11b1abe034ad3a020dbc51d" title="Finalization of the gost hash. " alt="" coords="493,107,635,133"/>
<area shape="rect" id="node10" href="_pkcs5_8c.html#a7e5365dc742aa6f9caa5b6bf29ef79e2" title="Make the derivative of the stribog key (iterate and change bits in it) " alt="" coords="338,183,438,209"/>
<area shape="rect" id="node11" href="_stribog_8c.html#a35dd8d9b4aa0af02ddb28c60bb3c3877" title="Initialize ctx variable (v512 = 0x200 or 512 in decimal) " alt="" coords="513,157,615,184"/>
<area shape="rect" id="node12" href="_stribog_8c.html#a0ff21cd42b69ce40de0e62e9b7e3b7fb" title="Perform a round on the now 512&#45;bit large remainder While there is more than 64 bytes available..." alt="" coords="511,208,617,235"/>
<area shape="rect" id="node13" href="_stribog_8c.html#a5845b664f371f429107cb502511e9c0e" title="Hash the last (padded) message block Add ctx&#45;&gt;left (max value represented by bitmask 0x3FF) to N This..." alt="" coords="501,259,627,285"/>
</map>
</div>

</div>
</div>
<a id="a84ce3754a4463f9d2281cfabafb0b779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84ce3754a4463f9d2281cfabafb0b779">&#9670;&nbsp;</a></span>TestCRCs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TestCRCs </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test the stribog algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">char</td><td>* buf </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a84ce3754a4463f9d2281cfabafb0b779_cgraph.png" border="0" usemap="#_tests_8c_a84ce3754a4463f9d2281cfabafb0b779_cgraph" alt=""/></div>
<map name="_tests_8c_a84ce3754a4463f9d2281cfabafb0b779_cgraph" id="_tests_8c_a84ce3754a4463f9d2281cfabafb0b779_cgraph">
<area shape="rect" id="node2" href="_pkcs5_8c.html#a7e5365dc742aa6f9caa5b6bf29ef79e2" title="Make the derivative of the stribog key (iterate and change bits in it) " alt="" coords="135,56,235,83"/>
<area shape="rect" id="node3" href="_stribog_8c.html#a35dd8d9b4aa0af02ddb28c60bb3c3877" title="Initialize ctx variable (v512 = 0x200 or 512 in decimal) " alt="" coords="295,5,397,32"/>
<area shape="rect" id="node4" href="_stribog_8c.html#a0ff21cd42b69ce40de0e62e9b7e3b7fb" title="Perform a round on the now 512&#45;bit large remainder While there is more than 64 bytes available..." alt="" coords="293,56,399,83"/>
<area shape="rect" id="node5" href="_stribog_8c.html#a5845b664f371f429107cb502511e9c0e" title="Hash the last (padded) message block Add ctx&#45;&gt;left (max value represented by bitmask 0x3FF) to N This..." alt="" coords="283,107,409,133"/>
</map>
</div>

</div>
</div>
<a id="a56d230d77b34ccd318135fbaeee388f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56d230d77b34ccd318135fbaeee388f1">&#9670;&nbsp;</a></span>TestLegacySectorBufEncryption()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL TestLegacySectorBufEncryption </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_p_t_o___i_n_f_o__t.html">PCRYPTO_INFO</a>&#160;</td>
          <td class="paramname"><em>ci</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test the legacy mode for boot encryption. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PCRYPTO_INFO</td><td>ci </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOL FALSE if (crc == 0xb70b4c26) FALSE if (EAInit (ci-&gt;ea, (unsigned char *)buf, ci-&gt;ks) == ERR_CIPHER_INIT_FAILURE) FALSE if (GetCrc32 (buf, sizeof (buf)) != 0xb70b4c26) FALSE if (crc == 0xb70b4c26) 1 otherwise </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a56d230d77b34ccd318135fbaeee388f1_cgraph.png" border="0" usemap="#_tests_8c_a56d230d77b34ccd318135fbaeee388f1_cgraph" alt=""/></div>
<map name="_tests_8c_a56d230d77b34ccd318135fbaeee388f1_cgraph" id="_tests_8c_a56d230d77b34ccd318135fbaeee388f1_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#a0b429fab7dfd8ef48d2ab835596004f0" title="Get first EA (half useless) " alt="" coords="280,17,367,44"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a0746793b59acd1220c830d926d2b9e37" title="Get the next EA. " alt="" coords="279,68,367,95"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a6c2ad176a3628fde37e21c5028ddfd40" title="Returns name of EA, cascaded cipher names are separated by hyphens. " alt="" coords="276,169,371,196"/>
<area shape="rect" id="node9" href="_crypto_8c.html#a794038e7ead3d5533e3134ce20e93a39" title="Get the block size of a cipher at id. " alt="" coords="462,5,601,32"/>
<area shape="rect" id="node10" href="_crypto_8c.html#abfc3043d94e0df6ce41e98025352b885" title="Return the first EA. " alt="" coords="707,411,831,437"/>
<area shape="rect" id="node11" href="_crypto_8c.html#a3616fd7fa35d83ea0e0cb8140e0f306a" title="Return values: 0 = success, ERR_CIPHER_INIT_FAILURE (fatal), ERR_CIPHER_INIT_WEAK_KEY (non&#45;fatal) ..." alt="" coords="503,309,560,336"/>
<area shape="rect" id="node23" href="_crypto_8c.html#a025ad0c316d421faf3c7da14c8f7bbe6" title="Returns the first mode of operation of EA. " alt="" coords="264,461,383,488"/>
<area shape="rect" id="node24" href="_crypto_8c.html#a51911377a64d62b76e475122060406fd" title="Returns the next mode of operation of EA. " alt="" coords="263,512,383,539"/>
<area shape="rect" id="node25" href="_crypto_8c.html#a143fe9aa7d1bc0533f4262974e9fa984" title="buf: data to be encrypted unitNo: sequential number of the data unit with which the buffer starts nbr..." alt="" coords="261,613,385,640"/>
<area shape="rect" id="node27" href="_crc_8c.html#a359742950ae18a48e43f92753970c936" title="Get the Crc, there are bit shift in a while loop. " alt="" coords="285,664,362,691"/>
<area shape="rect" id="node28" href="_crypto_8c.html#a00707faa92283e4909ebd1fbb1d6c136" title="buf: data to be decrypted unitNo: sequential number of the data unit with which the buffer starts nbr..." alt="" coords="261,563,385,589"/>
<area shape="rect" id="node29" href="_crypto_8c.html#aae913410eb90f16a1ca4021032880ead" title="buf: data to be encrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="481,461,581,488"/>
<area shape="rect" id="node32" href="_crypto_8c.html#adf61d3050038714fbf5f958453f4c68a" title="buf: data to be decrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="273,233,373,260"/>
<area shape="rect" id="node5" href="_crypto_8c.html#ac51b1aa192c121136917d07e628b3b62" title="Get last EA cipher. " alt="" coords="470,107,593,133"/>
<area shape="rect" id="node6" href="_crypto_8c.html#a6a985803967930df28a2baacc0a3aa92" title="Get the name of a cipher at id. " alt="" coords="711,81,826,108"/>
<area shape="rect" id="node8" href="_crypto_8c.html#a7c61a17a983733f94fa7ec56fed30740" title="Return next cipher if exists. " alt="" coords="458,157,605,184"/>
<area shape="rect" id="node7" href="_crypto_8c.html#a497fc6204c6a611434f38e4ccec909db" title="Get cipher at id, return null if there is no cipher with this id. " alt="" coords="941,120,1021,147"/>
<area shape="rect" id="node12" href="_crypto_8c.html#a162e231ed99c4a3fa4caa50d66703d28" title="Return next cipher if exists. " alt="" coords="706,360,831,387"/>
<area shape="rect" id="node13" href="_crypto_8c.html#aa38ecf7977d369eb9f080b1498e48738" title="Initialise cipher Return values: 0 = success, ERR_CIPHER_INIT_FAILURE (fatal), ERR_CIPHER_INIT_WEAK_K..." alt="" coords="731,309,807,336"/>
<area shape="rect" id="node21" href="_crypto_8c.html#ad395a0b04fac58cda3188c2559ae46dd" title="Get the key size of a cipher at id. " alt="" coords="704,157,833,184"/>
<area shape="rect" id="node22" href="_crypto_8c.html#a3dd093c42e7b7351c23317efacc57221" title="Get the key schedule size of a cipher at id. " alt="" coords="677,259,860,285"/>
<area shape="rect" id="node14" href="_gost_cipher_8c.html#a894c8f0e07a5614968fca09f7ae1f24b" title="Set the gost key Generate a pseudo random data (based on the key) and set the key. " alt="" coords="931,335,1031,361"/>
<area shape="rect" id="node15" href="_grasshopper_cipher_8c.html#a6b136aade799131cab66db1d5d4df8b0" title="Key setup procedure. " alt="" coords="908,284,1055,311"/>
<area shape="rect" id="node16" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="1255,259,1293,285"/>
<area shape="rect" id="node19" href="_grasshopper_cipher_8c.html#a6107e1c52141eb86bb87182173247783" title="Switch opposed bytes (lower byte to upper byte, ...) of unsigned long. " alt="" coords="1103,233,1207,260"/>
<area shape="rect" id="node20" href="_grasshopper_cipher_8c.html#acea73ea2211a8c6ff219e586d742d99f" title="F conversion (used in key setup) " alt="" coords="1135,335,1174,361"/>
<area shape="rect" id="node17" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="1341,259,1380,285"/>
<area shape="rect" id="node18" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="1428,259,1467,285"/>
<area shape="rect" id="node26" href="_encryption_thread_pool_8c.html#abb01516958dcdb87a96eea999242e434" title="Start the encryption key into the thread pool. Each thread encrypt or decrypt small amount of data..." alt="" coords="433,588,629,615"/>
<area shape="rect" id="node30" href="_xts_8c.html#aad9147213002ffaa3c0450853005e646" title="length: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cip..." alt="" coords="707,512,830,539"/>
<area shape="rect" id="node31" href="_xts_8c.html#af9db6f7d5ac83732ee40cfdf0ca69e16" title="The goal is to switch some byte of a encrypted data with the next encrypted data. This doesn&#39;t hurt t..." alt="" coords="690,461,847,488"/>
<area shape="rect" id="node33" href="_crypto_8c.html#aca3647cdf6774c8ce5ba2b0c2f370bd1" title="Returns sum of key schedule sizes of all ciphers of the EA. " alt="" coords="449,360,613,387"/>
<area shape="rect" id="node34" href="_xts_8c.html#acf61facb05a3ea253498a379275f48a6" title="For descriptions of the input parameters, see EncryptBufferXTS(). Decrypt before switching back the d..." alt="" coords="470,259,593,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a56d230d77b34ccd318135fbaeee388f1_icgraph.png" border="0" usemap="#_tests_8c_a56d230d77b34ccd318135fbaeee388f1_icgraph" alt=""/></div>
<map name="_tests_8c_a56d230d77b34ccd318135fbaeee388f1_icgraph" id="_tests_8c_a56d230d77b34ccd318135fbaeee388f1_icgraph">
<area shape="rect" id="node2" href="_tests_8c.html#a9f2eb67594414b8bea27e345fc69fdef" title="Encrypt same value of data to test if the encryption algorithm woks well. " alt="" coords="261,5,428,32"/>
</map>
</div>

</div>
</div>
<a id="a9f2eb67594414b8bea27e345fc69fdef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f2eb67594414b8bea27e345fc69fdef">&#9670;&nbsp;</a></span>TestSectorBufEncryption()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL TestSectorBufEncryption </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_r_y_p_t_o___i_n_f_o__t.html">PCRYPTO_INFO</a>&#160;</td>
          <td class="paramname"><em>ci</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt same value of data to test if the encryption algorithm woks well. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PCRYPTO_INFO</td><td>ci </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOL FALSE if (!TestLegacySectorBufEncryption(ci)) FALSE if (EAInit(ci-&gt;ea, key1, ci-&gt;ks) != ERR_SUCCESS) FALSE if (!EAInitMode(ci)) FALSE if (crc != 0x05eacf7d) FALSE if (crc != 0x5b5926d9) FALSE if (crc != 0xcf0cfdd1) FALSE if (crc != 0xe82865a8) FALSE if (crc == 0x9f5edd58) FALSE if (GetCrc32(buf, sizeof (buf)) != 0x9f5edd58) FALSE if (EAInit(ci-&gt;ea, key1, ci-&gt;ks) != ERR_SUCCESS) FALSE if (!EAInitMode(ci)) FALSE if (crc != 0x5d31eec2) FALSE if (crc == 0x9f5edd58) 1 otherwise </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_tests_8c_a9f2eb67594414b8bea27e345fc69fdef_cgraph.png" border="0" usemap="#_tests_8c_a9f2eb67594414b8bea27e345fc69fdef_cgraph" alt=""/></div>
<map name="_tests_8c_a9f2eb67594414b8bea27e345fc69fdef_cgraph" id="_tests_8c_a9f2eb67594414b8bea27e345fc69fdef_cgraph">
<area shape="rect" id="node2" href="_tests_8c.html#a56d230d77b34ccd318135fbaeee388f1" title="Test the legacy mode for boot encryption. " alt="" coords="220,344,428,371"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a0b429fab7dfd8ef48d2ab835596004f0" title="Get first EA (half useless) " alt="" coords="495,5,581,32"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a0746793b59acd1220c830d926d2b9e37" title="Get the next EA. " alt="" coords="494,56,582,83"/>
<area shape="rect" id="node5" href="_crypto_8c.html#a6c2ad176a3628fde37e21c5028ddfd40" title="Returns name of EA, cascaded cipher names are separated by hyphens. " alt="" coords="491,157,585,184"/>
<area shape="rect" id="node12" href="_crypto_8c.html#a3616fd7fa35d83ea0e0cb8140e0f306a" title="Return values: 0 = success, ERR_CIPHER_INIT_FAILURE (fatal), ERR_CIPHER_INIT_WEAK_KEY (non&#45;fatal) ..." alt="" coords="717,512,775,539"/>
<area shape="rect" id="node24" href="_crypto_8c.html#a025ad0c316d421faf3c7da14c8f7bbe6" title="Returns the first mode of operation of EA. " alt="" coords="479,563,597,589"/>
<area shape="rect" id="node25" href="_crypto_8c.html#a51911377a64d62b76e475122060406fd" title="Returns the next mode of operation of EA. " alt="" coords="478,613,598,640"/>
<area shape="rect" id="node36" href="_crypto_8c.html#a80fb3f1fabf0d3130523f112ae629ca8" title="Returns TRUE if the mode of operation is supported for the encryption algorithm. " alt="" coords="253,715,395,741"/>
<area shape="rect" id="node10" href="_crypto_8c.html#a794038e7ead3d5533e3134ce20e93a39" title="Get the block size of a cipher at id. " alt="" coords="677,5,815,32"/>
<area shape="rect" id="node11" href="_crypto_8c.html#abfc3043d94e0df6ce41e98025352b885" title="Return the first EA. " alt="" coords="921,411,1045,437"/>
<area shape="rect" id="node26" href="_crypto_8c.html#a143fe9aa7d1bc0533f4262974e9fa984" title="buf: data to be encrypted unitNo: sequential number of the data unit with which the buffer starts nbr..." alt="" coords="476,411,600,437"/>
<area shape="rect" id="node28" href="_crc_8c.html#a359742950ae18a48e43f92753970c936" title="Get the Crc, there are bit shift in a while loop. " alt="" coords="499,259,577,285"/>
<area shape="rect" id="node29" href="_crypto_8c.html#a00707faa92283e4909ebd1fbb1d6c136" title="buf: data to be decrypted unitNo: sequential number of the data unit with which the buffer starts nbr..." alt="" coords="476,461,600,488"/>
<area shape="rect" id="node30" href="_crypto_8c.html#aae913410eb90f16a1ca4021032880ead" title="buf: data to be encrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="696,208,796,235"/>
<area shape="rect" id="node33" href="_crypto_8c.html#adf61d3050038714fbf5f958453f4c68a" title="buf: data to be decrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="488,309,588,336"/>
<area shape="rect" id="node6" href="_crypto_8c.html#ac51b1aa192c121136917d07e628b3b62" title="Get last EA cipher. " alt="" coords="685,157,807,184"/>
<area shape="rect" id="node7" href="_crypto_8c.html#a6a985803967930df28a2baacc0a3aa92" title="Get the name of a cipher at id. " alt="" coords="926,95,1041,121"/>
<area shape="rect" id="node9" href="_crypto_8c.html#a7c61a17a983733f94fa7ec56fed30740" title="Return next cipher if exists. " alt="" coords="673,107,819,133"/>
<area shape="rect" id="node8" href="_crypto_8c.html#a497fc6204c6a611434f38e4ccec909db" title="Get cipher at id, return null if there is no cipher with this id. " alt="" coords="1156,203,1236,229"/>
<area shape="rect" id="node13" href="_crypto_8c.html#a162e231ed99c4a3fa4caa50d66703d28" title="Return next cipher if exists. " alt="" coords="921,360,1046,387"/>
<area shape="rect" id="node14" href="_crypto_8c.html#aa38ecf7977d369eb9f080b1498e48738" title="Initialise cipher Return values: 0 = success, ERR_CIPHER_INIT_FAILURE (fatal), ERR_CIPHER_INIT_WEAK_K..." alt="" coords="945,512,1021,539"/>
<area shape="rect" id="node22" href="_crypto_8c.html#ad395a0b04fac58cda3188c2559ae46dd" title="Get the key size of a cipher at id. " alt="" coords="919,461,1048,488"/>
<area shape="rect" id="node23" href="_crypto_8c.html#a3dd093c42e7b7351c23317efacc57221" title="Get the key schedule size of a cipher at id. " alt="" coords="892,309,1075,336"/>
<area shape="rect" id="node15" href="_gost_cipher_8c.html#a894c8f0e07a5614968fca09f7ae1f24b" title="Set the gost key Generate a pseudo random data (based on the key) and set the key. " alt="" coords="1146,487,1246,513"/>
<area shape="rect" id="node16" href="_grasshopper_cipher_8c.html#a6b136aade799131cab66db1d5d4df8b0" title="Key setup procedure. " alt="" coords="1123,537,1269,564"/>
<area shape="rect" id="node17" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="1469,512,1508,539"/>
<area shape="rect" id="node20" href="_grasshopper_cipher_8c.html#a6107e1c52141eb86bb87182173247783" title="Switch opposed bytes (lower byte to upper byte, ...) of unsigned long. " alt="" coords="1317,537,1421,564"/>
<area shape="rect" id="node21" href="_grasshopper_cipher_8c.html#acea73ea2211a8c6ff219e586d742d99f" title="F conversion (used in key setup) " alt="" coords="1350,588,1389,615"/>
<area shape="rect" id="node18" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="1556,512,1595,539"/>
<area shape="rect" id="node19" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="1643,512,1681,539"/>
<area shape="rect" id="node27" href="_encryption_thread_pool_8c.html#abb01516958dcdb87a96eea999242e434" title="Start the encryption key into the thread pool. Each thread encrypt or decrypt small amount of data..." alt="" coords="648,461,844,488"/>
<area shape="rect" id="node31" href="_xts_8c.html#aad9147213002ffaa3c0450853005e646" title="length: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cip..." alt="" coords="922,183,1045,209"/>
<area shape="rect" id="node32" href="_xts_8c.html#af9db6f7d5ac83732ee40cfdf0ca69e16" title="The goal is to switch some byte of a encrypted data with the next encrypted data. This doesn&#39;t hurt t..." alt="" coords="905,233,1062,260"/>
<area shape="rect" id="node34" href="_crypto_8c.html#aca3647cdf6774c8ce5ba2b0c2f370bd1" title="Returns sum of key schedule sizes of all ciphers of the EA. " alt="" coords="664,360,828,387"/>
<area shape="rect" id="node35" href="_xts_8c.html#acf61facb05a3ea253498a379275f48a6" title="For descriptions of the input parameters, see EncryptBufferXTS(). Decrypt before switching back the d..." alt="" coords="685,259,807,285"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3b88dcf8e71277fea9baec941511ee14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b88dcf8e71277fea9baec941511ee14">&#9670;&nbsp;</a></span>hmac_gosthash_test_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_gosthash_test_data</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;</span></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="ac77596640668b0c0890b99ef15924f04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac77596640668b0c0890b99ef15924f04">&#9670;&nbsp;</a></span>hmac_gosthash_test_key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_gosthash_test_key</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF\x01\x23\x45\x67\x89\xAB\xCD\xEF\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF\x01\x23\x45\x67\x89\xAB\xCD\xEF\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF&quot;</span></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="aba879dbba59727a77a6e5b43cb8a690c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba879dbba59727a77a6e5b43cb8a690c">&#9670;&nbsp;</a></span>hmac_gosthash_test_vectors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_gosthash_test_vectors</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;\x52\x35\xb7\x17\x56\xb8\x75\x21\xca\xe9\x52\x9b\x21\x97\x3e\x6d\x4e\x54\x12\xfc\x61\x70\x40\xfa\x46\x4c\xf7\x24\x9d\x28\xde\x1d&quot;</span></div><div class="line">    </div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="a6e4a4d015489f4e28ae426670238f2d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e4a4d015489f4e28ae426670238f2d2">&#9670;&nbsp;</a></span>hmac_stribog_test_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_stribog_test_data</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;</span></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="a30ff4e64859229aa28cb73fb13a69d75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30ff4e64859229aa28cb73fb13a69d75">&#9670;&nbsp;</a></span>hmac_stribog_test_key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_stribog_test_key</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF\x01\x23\x45\x67\x89\xAB\xCD\xEF\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF\x01\x23\x45\x67\x89\xAB\xCD\xEF\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF&quot;</span></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="ac5136b9069100f9dee7b10ea1fcf15f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5136b9069100f9dee7b10ea1fcf15f7">&#9670;&nbsp;</a></span>hmac_stribog_test_vectors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_stribog_test_vectors</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;\x74\x8a\x64\x94\xb8\x34\xbd\x72\x95\xa2\x3b\x11\x86\x1d\x46\xe7\x88\x0f\x65\x98\xd3\x54\xe1\xb2\x4a\x35\xc2\xa2\x85\x41\x08\x85\x07\xc8\x52\x51\x36\x26\xd2\x8c\x38\xe5\x55\x9e\xd2\x1b\x88\x2b\x2b\x37\xae\x87\x11\x1a\x37\xe4\xb1\x88\xd3\xd7\x8c\x9f\xef\x1b&quot;</span></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="a845192a8755185349a6afd1aa5142cc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a845192a8755185349a6afd1aa5142cc2">&#9670;&nbsp;</a></span>hmac_whirlpool_test_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_whirlpool_test_data</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq&quot;</span></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="a865ecd2f8e4cfcb4a49e422097ac494e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a865ecd2f8e4cfcb4a49e422097ac494e">&#9670;&nbsp;</a></span>hmac_whirlpool_test_key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_whirlpool_test_key</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF\x01\x23\x45\x67\x89\xAB\xCD\xEF\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF\x01\x23\x45\x67\x89\xAB\xCD\xEF\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF&quot;</span></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="a8469e44c5aa501e8a1be310685f27b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8469e44c5aa501e8a1be310685f27b29">&#9670;&nbsp;</a></span>hmac_whirlpool_test_vectors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* hmac_whirlpool_test_vectors</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div><div class="line">{</div><div class="line">    <span class="stringliteral">&quot;\x03\x91\xd2\x80\x00\xb6\x62\xbb\xb8\xe6\x23\x3e\xe8\x6c\xf2\xb2\x84\x74\x4c\x73&quot;</span></div><div class="line">    <span class="stringliteral">&quot;\x8b\x58\x00\xba\x28\x12\xed\x52\x6f\xe3\x15\x3a\xb1\xba\xe7\xe2\x36\xbe\x96\x54&quot;</span></div><div class="line">    <span class="stringliteral">&quot;\x49\x3f\x19\xfa\xce\xa6\x44\x1f\x60\xf5\xf0\x18\x93\x09\x11\xa5\xe5\xce\xd8\xf2&quot;</span></div><div class="line">    <span class="stringliteral">&quot;\x6a\xbf\xa4\x02&quot;</span></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
