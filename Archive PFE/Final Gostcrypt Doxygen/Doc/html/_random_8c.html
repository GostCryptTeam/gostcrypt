<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Gostcrypt: Common/Random.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Gostcrypt
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4ab6b4cc6a7edbff49100e9123df213f.html">Common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Random.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manage the requirements for using the mixPool (defined in this file) function that will add random into the crypting process.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;Gstdefs.h&quot;</code><br />
<code>#include &quot;Crc.h&quot;</code><br />
<code>#include &quot;Random.h&quot;</code><br />
<code>#include &lt;tlhelp32.h&gt;</code><br />
<code>#include &quot;Dlgcode.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Random.c:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c__incl.png" border="0" usemap="#_common_2_random_8c" alt=""/></div>
<map name="_common_2_random_8c" id="_common_2_random_8c">
<area shape="rect" id="node2" href="_gstdefs_8h_source.html" title="Gstdefs.h" alt="" coords="282,453,361,480"/>
<area shape="rect" id="node5" href="_crc_8h_source.html" title="Crc.h" alt="" coords="5,304,59,331"/>
<area shape="rect" id="node6" href="_random_8h_source.html" title="Random.h" alt="" coords="645,155,726,181"/>
<area shape="rect" id="node16" href="_dlgcode_8h_source.html" title="Dlgcode.h" alt="" coords="255,80,335,107"/>
<area shape="rect" id="node7" href="_crypto_8h_source.html" title="Crypto.h" alt="" coords="581,304,651,331"/>
<area shape="rect" id="node8" href="_gost_cipher_8h_source.html" title="GostCipher.h" alt="" coords="735,379,833,405"/>
<area shape="rect" id="node9" href="_grasshopper_cipher_8h_source.html" title="GrasshopperCipher.h" alt="" coords="857,379,1001,405"/>
<area shape="rect" id="node10" href="_stribog_8h_source.html" title="Stribog.h" alt="" coords="380,379,455,405"/>
<area shape="rect" id="node11" href="_whirlpool_8h_source.html" title="Whirlpool.h" alt="" coords="1026,379,1113,405"/>
<area shape="rect" id="node12" href="_gost_hash_8h_source.html" title="GostHash.h" alt="" coords="479,379,569,405"/>
<area shape="rect" id="node13" href="_gf_mul_8h_source.html" title="GfMul.h" alt="" coords="644,379,711,405"/>
<area shape="rect" id="node14" href="_password_8h_source.html" title="Password.h" alt="" coords="265,379,356,405"/>
<area shape="rect" id="node17" href="_common_8h_source.html" title="Common.h" alt="" coords="573,229,659,256"/>
<area shape="rect" id="node18" href="_apidrvr_8h_source.html" title="Apidrvr.h" alt="" coords="259,155,331,181"/>
<area shape="rect" id="node21" href="_wipe_8h_source.html" title="Wipe.h" alt="" coords="134,229,197,256"/>
<area shape="rect" id="node22" href="_keyfiles_8h_source.html" title="Keyfiles.h" alt="" coords="522,155,601,181"/>
<area shape="rect" id="node19" href="_boot_defs_8h_source.html" title="Boot/Windows/BootDefs.h" alt="" coords="323,229,498,256"/>
<area shape="rect" id="node20" href="_volumes_8h_source.html" title="Volumes.h" alt="" coords="269,304,353,331"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a91a2ce1ee1581aec0e782c45745667fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>RandaddByte</b>(x)</td></tr>
<tr class="separator:a91a2ce1ee1581aec0e782c45745667fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b2c2e236e93fc6933405d8aed4bf20c"><td class="memItemLeft" align="right" valign="top"><a id="a5b2c2e236e93fc6933405d8aed4bf20c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RandaddInt32</b>(x)&#160;&#160;&#160;<a class="el" href="_random_8c.html#a986e0406e6679a9dfd267c574aa8ec8d">RandAddInt</a>((unsigned __int32)x);</td></tr>
<tr class="separator:a5b2c2e236e93fc6933405d8aed4bf20c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a50f7f9da1f34b324fb68f9d242ed8509"><td class="memItemLeft" align="right" valign="top"><a id="a50f7f9da1f34b324fb68f9d242ed8509"></a>
typedef DWORD(WINAPI *&#160;</td><td class="memItemRight" valign="bottom"><b>NETSTATISTICSGET</b>) (LPWSTR szServer, LPWSTR szService, DWORD dwLevel, DWORD dwOptions, LPBYTE *lpBuffer)</td></tr>
<tr class="separator:a50f7f9da1f34b324fb68f9d242ed8509"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf58d1059549792cde3c717853dccdb0"><td class="memItemLeft" align="right" valign="top"><a id="acf58d1059549792cde3c717853dccdb0"></a>
typedef DWORD(WINAPI *&#160;</td><td class="memItemRight" valign="bottom"><b>NETAPIBUFFERSIZE</b>) (LPVOID lpBuffer, LPDWORD cbBuffer)</td></tr>
<tr class="separator:acf58d1059549792cde3c717853dccdb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8e43b8b490a096bc31f13524a905fc0"><td class="memItemLeft" align="right" valign="top"><a id="aa8e43b8b490a096bc31f13524a905fc0"></a>
typedef DWORD(WINAPI *&#160;</td><td class="memItemRight" valign="bottom"><b>NETAPIBUFFERFREE</b>) (LPVOID lpBuffer)</td></tr>
<tr class="separator:aa8e43b8b490a096bc31f13524a905fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a986e0406e6679a9dfd267c574aa8ec8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a986e0406e6679a9dfd267c574aa8ec8d">RandAddInt</a> (unsigned __int32 x)</td></tr>
<tr class="memdesc:a986e0406e6679a9dfd267c574aa8ec8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add random byte in all bytes of x value (in argument)  <a href="#a986e0406e6679a9dfd267c574aa8ec8d">More...</a><br /></td></tr>
<tr class="separator:a986e0406e6679a9dfd267c574aa8ec8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c51a11fb671c29c6f9c22e3db140618"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a4c51a11fb671c29c6f9c22e3db140618">Randinit</a> ()</td></tr>
<tr class="memdesc:a4c51a11fb671c29c6f9c22e3db140618"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init the random number generator, setup the hooks, and start the thread.  <a href="#a4c51a11fb671c29c6f9c22e3db140618">More...</a><br /></td></tr>
<tr class="separator:a4c51a11fb671c29c6f9c22e3db140618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a009589ab36ed5eba8dfee41cef19792a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a009589ab36ed5eba8dfee41cef19792a">RandStop</a> (BOOL freePool)</td></tr>
<tr class="memdesc:a009589ab36ed5eba8dfee41cef19792a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close everything down, including the thread which is closed down by setting a flag which eventually causes the thread function to exit.  <a href="#a009589ab36ed5eba8dfee41cef19792a">More...</a><br /></td></tr>
<tr class="separator:a009589ab36ed5eba8dfee41cef19792a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adde1d6fdecdc1df8fbadcb16dc445b4c"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#adde1d6fdecdc1df8fbadcb16dc445b4c">IsRandomNumberGeneratorStarted</a> ()</td></tr>
<tr class="memdesc:adde1d6fdecdc1df8fbadcb16dc445b4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the status of RandomNumberGenerator thread.  <a href="#adde1d6fdecdc1df8fbadcb16dc445b4c">More...</a><br /></td></tr>
<tr class="separator:adde1d6fdecdc1df8fbadcb16dc445b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba80bcfbc12785c63c8bbb16f415c516"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#aba80bcfbc12785c63c8bbb16f415c516">RandSetHashFunction</a> (int hash_algo_id)</td></tr>
<tr class="memdesc:aba80bcfbc12785c63c8bbb16f415c516"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the hash function that will be used by the default one if none was chosen otherwise set it the the hash ID.  <a href="#aba80bcfbc12785c63c8bbb16f415c516">More...</a><br /></td></tr>
<tr class="separator:aba80bcfbc12785c63c8bbb16f415c516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2014fa3d97acda067c9618a43e184e2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a2014fa3d97acda067c9618a43e184e2c">RandGetHashFunction</a> (void)</td></tr>
<tr class="memdesc:a2014fa3d97acda067c9618a43e184e2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the hash function.  <a href="#a2014fa3d97acda067c9618a43e184e2c">More...</a><br /></td></tr>
<tr class="separator:a2014fa3d97acda067c9618a43e184e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dbcb0c1d268cb4fb1736a0565781f61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a0dbcb0c1d268cb4fb1736a0565781f61">SetRandomPoolEnrichedByUserStatus</a> (BOOL enriched)</td></tr>
<tr class="memdesc:a0dbcb0c1d268cb4fb1736a0565781f61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the random pool to enriched.  <a href="#a0dbcb0c1d268cb4fb1736a0565781f61">More...</a><br /></td></tr>
<tr class="separator:a0dbcb0c1d268cb4fb1736a0565781f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f3fbcec0bed8fbb7242084a017fabb"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a31f3fbcec0bed8fbb7242084a017fabb">IsRandomPoolEnrichedByUser</a> ()</td></tr>
<tr class="memdesc:a31f3fbcec0bed8fbb7242084a017fabb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the enriched status of the pool.  <a href="#a31f3fbcec0bed8fbb7242084a017fabb">More...</a><br /></td></tr>
<tr class="separator:a31f3fbcec0bed8fbb7242084a017fabb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a204161668b3568f6d98344329287e95d"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a204161668b3568f6d98344329287e95d">Randmix</a> ()</td></tr>
<tr class="memdesc:a204161668b3568f6d98344329287e95d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The random pool mixing function. Set the digest size according to the hash, compute the digest message with the seleted hash function, mix and delete for avoiding leaks.  <a href="#a204161668b3568f6d98344329287e95d">More...</a><br /></td></tr>
<tr class="separator:a204161668b3568f6d98344329287e95d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc917d62bccdd2bddc5c345b24d20117"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#afc917d62bccdd2bddc5c345b24d20117">RandaddBuf</a> (void *buf, int len)</td></tr>
<tr class="memdesc:afc917d62bccdd2bddc5c345b24d20117"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a buffer to the pool.  <a href="#afc917d62bccdd2bddc5c345b24d20117">More...</a><br /></td></tr>
<tr class="separator:afc917d62bccdd2bddc5c345b24d20117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39824abaa63b4069cd5e4a50d89f5a31"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a39824abaa63b4069cd5e4a50d89f5a31">RandpeekBytes</a> (unsigned char *buf, int len)</td></tr>
<tr class="memdesc:a39824abaa63b4069cd5e4a50d89f5a31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enter the critical section and copy some data of a given length.  <a href="#a39824abaa63b4069cd5e4a50d89f5a31">More...</a><br /></td></tr>
<tr class="separator:a39824abaa63b4069cd5e4a50d89f5a31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f9073a1b47a63a40fed7a2b39ea63d2"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a4f9073a1b47a63a40fed7a2b39ea63d2">RandgetBytes</a> (unsigned char *buf, int len, BOOL forceSlowPoll)</td></tr>
<tr class="memdesc:a4f9073a1b47a63a40fed7a2b39ea63d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get len random bytes from the pool (max. RNG_POOL_SIZE bytes per a single call)  <a href="#a4f9073a1b47a63a40fed7a2b39ea63d2">More...</a><br /></td></tr>
<tr class="separator:a4f9073a1b47a63a40fed7a2b39ea63d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f936ea5a2403f24ff9917e7e6ec7d43"><td class="memItemLeft" align="right" valign="top">LRESULT CALLBACK&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a6f936ea5a2403f24ff9917e7e6ec7d43">MouseProc</a> (int nCode, WPARAM wParam, LPARAM lParam)</td></tr>
<tr class="memdesc:a6f936ea5a2403f24ff9917e7e6ec7d43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capture the mouse, and as long as the event is not the same as the last two events, add the crc of the event, and the crc of the time difference between this event and the last + the current time to the pool. The role of CRC-32 is merely to perform diffusion. Note that the output of CRC-32 is subsequently processed using a cryptographically secure hash algorithm.  <a href="#a6f936ea5a2403f24ff9917e7e6ec7d43">More...</a><br /></td></tr>
<tr class="separator:a6f936ea5a2403f24ff9917e7e6ec7d43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a5a763fbbb5f49194e48600b749c01"><td class="memItemLeft" align="right" valign="top">LRESULT CALLBACK&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a30a5a763fbbb5f49194e48600b749c01">KeyboardProc</a> (int nCode, WPARAM wParam, LPARAM lParam)</td></tr>
<tr class="memdesc:a30a5a763fbbb5f49194e48600b749c01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Capture the keyboard, as long as the event is not the same as the last two events, add the crc of the event to the pool along with the crc of the time difference between this event and the last. The role of CRC-32 is merely to perform diffusion. Note that the output of CRC-32 is subsequently processed using a cryptographically secure hash algorithm.  <a href="#a30a5a763fbbb5f49194e48600b749c01">More...</a><br /></td></tr>
<tr class="separator:a30a5a763fbbb5f49194e48600b749c01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40afdfbd27ad7326c80e1fce5644783c"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a40afdfbd27ad7326c80e1fce5644783c">SlowPoll</a> (void)</td></tr>
<tr class="memdesc:a40afdfbd27ad7326c80e1fce5644783c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the slowpoll function which gathers up network/hard drive. It is only used for NT server like : WinNT, ServerNT, LanmanNT. performance data for the random pool.  <a href="#a40afdfbd27ad7326c80e1fce5644783c">More...</a><br /></td></tr>
<tr class="separator:a40afdfbd27ad7326c80e1fce5644783c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59f86574d41b814045c8b68bdf9e4c6e"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_random_8c.html#a59f86574d41b814045c8b68bdf9e4c6e">FastPoll</a> (void)</td></tr>
<tr class="memdesc:a59f86574d41b814045c8b68bdf9e4c6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the fastpoll function which gathers up info by calling various api's. It gets the system information in order to avoid problem for the processes.  <a href="#a59f86574d41b814045c8b68bdf9e4c6e">More...</a><br /></td></tr>
<tr class="separator:a59f86574d41b814045c8b68bdf9e4c6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8243cfab6e48b9868319bd9da5c1f038"><td class="memItemLeft" align="right" valign="top"><a id="a8243cfab6e48b9868319bd9da5c1f038"></a>
BOOL volatile&#160;</td><td class="memItemRight" valign="bottom"><b>bFastPollEnabled</b> = TRUE</td></tr>
<tr class="separator:a8243cfab6e48b9868319bd9da5c1f038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86ee99e68428f16f711dc531c469a3bd"><td class="memItemLeft" align="right" valign="top"><a id="a86ee99e68428f16f711dc531c469a3bd"></a>
BOOL volatile&#160;</td><td class="memItemRight" valign="bottom"><b>bRandmixEnabled</b> = TRUE</td></tr>
<tr class="separator:a86ee99e68428f16f711dc531c469a3bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e998a20ccc3d302dbcc2e415f7ceba"><td class="memItemLeft" align="right" valign="top"><a id="a90e998a20ccc3d302dbcc2e415f7ceba"></a>
HHOOK&#160;</td><td class="memItemRight" valign="bottom"><b>hMouse</b> = NULL</td></tr>
<tr class="separator:a90e998a20ccc3d302dbcc2e415f7ceba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b3dde75f9f3f5b074b749ef40767de"><td class="memItemLeft" align="right" valign="top"><a id="af2b3dde75f9f3f5b074b749ef40767de"></a>
HHOOK&#160;</td><td class="memItemRight" valign="bottom"><b>hKeyboard</b> = NULL</td></tr>
<tr class="separator:af2b3dde75f9f3f5b074b749ef40767de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe542c34fd5eef605425a615a9a94d94"><td class="memItemLeft" align="right" valign="top"><a id="afe542c34fd5eef605425a615a9a94d94"></a>
CRITICAL_SECTION&#160;</td><td class="memItemRight" valign="bottom"><b>critRandProt</b></td></tr>
<tr class="separator:afe542c34fd5eef605425a615a9a94d94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477ef5686248e139ec392390722f5e22"><td class="memItemLeft" align="right" valign="top"><a id="a477ef5686248e139ec392390722f5e22"></a>
BOOL volatile&#160;</td><td class="memItemRight" valign="bottom"><b>bThreadTerminate</b> = FALSE</td></tr>
<tr class="separator:a477ef5686248e139ec392390722f5e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12a9cba5cb1216bcd1e36f43c935a796"><td class="memItemLeft" align="right" valign="top"><a id="a12a9cba5cb1216bcd1e36f43c935a796"></a>
HANDLE&#160;</td><td class="memItemRight" valign="bottom"><b>hNetAPI32</b> = NULL</td></tr>
<tr class="separator:a12a9cba5cb1216bcd1e36f43c935a796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14581f3926bd0852f775d7df8232b155"><td class="memItemLeft" align="right" valign="top"><a id="a14581f3926bd0852f775d7df8232b155"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><b>CryptoAPIAvailable</b> = FALSE</td></tr>
<tr class="separator:a14581f3926bd0852f775d7df8232b155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ba57d821ca61ef1882f32c140244cf5"><td class="memItemLeft" align="right" valign="top"><a id="a2ba57d821ca61ef1882f32c140244cf5"></a>
HCRYPTPROV&#160;</td><td class="memItemRight" valign="bottom"><b>hCryptProv</b></td></tr>
<tr class="separator:a2ba57d821ca61ef1882f32c140244cf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fd65700c705f1b5b94c1735f53be5d1"><td class="memItemLeft" align="right" valign="top"><a id="a9fd65700c705f1b5b94c1735f53be5d1"></a>
NETSTATISTICSGET&#160;</td><td class="memItemRight" valign="bottom"><b>pNetStatisticsGet</b> = NULL</td></tr>
<tr class="separator:a9fd65700c705f1b5b94c1735f53be5d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a755b688c93f218351ac883629b661476"><td class="memItemLeft" align="right" valign="top"><a id="a755b688c93f218351ac883629b661476"></a>
NETAPIBUFFERSIZE&#160;</td><td class="memItemRight" valign="bottom"><b>pNetApiBufferSize</b> = NULL</td></tr>
<tr class="separator:a755b688c93f218351ac883629b661476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85f0ba532ac2ade27e46b9af9a1bf74d"><td class="memItemLeft" align="right" valign="top"><a id="a85f0ba532ac2ade27e46b9af9a1bf74d"></a>
NETAPIBUFFERFREE&#160;</td><td class="memItemRight" valign="bottom"><b>pNetApiBufferFree</b> = NULL</td></tr>
<tr class="separator:a85f0ba532ac2ade27e46b9af9a1bf74d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manage the requirements for using the mixPool (defined in this file) function that will add random into the crypting process. </p>
<dl class="section version"><dt>Version</dt><dd>1.3.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>20/01/2017 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a91a2ce1ee1581aec0e782c45745667fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91a2ce1ee1581aec0e782c45745667fc">&#9670;&nbsp;</a></span>RandaddByte</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RandaddByte</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{\</div><div class="line">    if (nRandIndex == RNG_POOL_SIZE) nRandIndex = 0;\</div><div class="line">    pRandPool[nRandIndex] = (<span class="keywordtype">unsigned</span> char) ((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)x + pRandPool[nRandIndex]); \</div><div class="line">    if (nRandIndex % RANDMIX_BYTE_INTERVAL == 0) <a class="code" href="_random_8c.html#a204161668b3568f6d98344329287e95d">Randmix</a>();\</div><div class="line">    nRandIndex++; \</div><div class="line">    }</div><div class="ttc" id="_random_8c_html_a204161668b3568f6d98344329287e95d"><div class="ttname"><a href="_random_8c.html#a204161668b3568f6d98344329287e95d">Randmix</a></div><div class="ttdeci">BOOL Randmix()</div><div class="ttdoc">The random pool mixing function. Set the digest size according to the hash, compute the digest messag...</div><div class="ttdef"><b>Definition:</b> Random.c:286</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a59f86574d41b814045c8b68bdf9e4c6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59f86574d41b814045c8b68bdf9e4c6e">&#9670;&nbsp;</a></span>FastPoll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL FastPoll </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the fastpoll function which gathers up info by calling various api's. It gets the system information in order to avoid problem for the processes. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL TRUE </dd></dl>

</div>
</div>
<a id="adde1d6fdecdc1df8fbadcb16dc445b4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adde1d6fdecdc1df8fbadcb16dc445b4c">&#9670;&nbsp;</a></span>IsRandomNumberGeneratorStarted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL IsRandomNumberGeneratorStarted </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the status of RandomNumberGenerator thread. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL bRandDidInit </dd></dl>

</div>
</div>
<a id="a31f3fbcec0bed8fbb7242084a017fabb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31f3fbcec0bed8fbb7242084a017fabb">&#9670;&nbsp;</a></span>IsRandomPoolEnrichedByUser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL IsRandomPoolEnrichedByUser </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the enriched status of the pool. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL RandomPoolEnrichedByUser </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c_a31f3fbcec0bed8fbb7242084a017fabb_icgraph.png" border="0" usemap="#_random_8c_a31f3fbcec0bed8fbb7242084a017fabb_icgraph" alt=""/></div>
<map name="_random_8c_a31f3fbcec0bed8fbb7242084a017fabb_icgraph" id="_random_8c_a31f3fbcec0bed8fbb7242084a017fabb_icgraph">
<area shape="rect" id="node2" href="_dlgcode_8c.html#a9baeca25d1e47e9f4068efe8bff24c3c" title="User enrichement a random pool. " alt="" coords="253,46,413,73"/>
<area shape="rect" id="node3" href="class_gost_crypt_1_1_boot_encryption.html#ae96eefda4ed624bd336f89b4a261b2c1" title="Start the decoy OS wipe. " alt="" coords="461,5,640,47"/>
<area shape="rect" id="node4" href="class_gost_crypt_1_1_boot_encryption.html#a9cce66955923f808f4dd297c7041ac5b" title="Change the password. " alt="" coords="461,71,640,112"/>
</map>
</div>

</div>
</div>
<a id="a30a5a763fbbb5f49194e48600b749c01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a5a763fbbb5f49194e48600b749c01">&#9670;&nbsp;</a></span>KeyboardProc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LRESULT CALLBACK KeyboardProc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WPARAM&#160;</td>
          <td class="paramname"><em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPARAM&#160;</td>
          <td class="paramname"><em>lParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Capture the keyboard, as long as the event is not the same as the last two events, add the crc of the event to the pool along with the crc of the time difference between this event and the last. The role of CRC-32 is merely to perform diffusion. Note that the output of CRC-32 is subsequently processed using a cryptographically secure hash algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">LPARAM</td><td>lParam </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WPARAM</td><td>wParam </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nCode </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>LRESULT CallNextHookEx (hMouse, nCode, wParam, lParam) if (nCode &lt; 0) CallNextHookEx (hMouse, nCode, wParam, lParam) else </dd></dl>

</div>
</div>
<a id="a6f936ea5a2403f24ff9917e7e6ec7d43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f936ea5a2403f24ff9917e7e6ec7d43">&#9670;&nbsp;</a></span>MouseProc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LRESULT CALLBACK MouseProc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nCode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WPARAM&#160;</td>
          <td class="paramname"><em>wParam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPARAM&#160;</td>
          <td class="paramname"><em>lParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Capture the mouse, and as long as the event is not the same as the last two events, add the crc of the event, and the crc of the time difference between this event and the last + the current time to the pool. The role of CRC-32 is merely to perform diffusion. Note that the output of CRC-32 is subsequently processed using a cryptographically secure hash algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">LPARAM</td><td>lParam </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WPARAM</td><td>wParam </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>nCode </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>LRESULT CallNextHookEx (hMouse, nCode, wParam, lParam) if (nCode &lt; 0) 0 else </dd></dl>

</div>
</div>
<a id="afc917d62bccdd2bddc5c345b24d20117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc917d62bccdd2bddc5c345b24d20117">&#9670;&nbsp;</a></span>RandaddBuf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RandaddBuf </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a buffer to the pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>len </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">void</td><td>* buf </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a986e0406e6679a9dfd267c574aa8ec8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a986e0406e6679a9dfd267c574aa8ec8d">&#9670;&nbsp;</a></span>RandAddInt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RandAddInt </td>
          <td>(</td>
          <td class="paramtype">unsigned __int32&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add random byte in all bytes of x value (in argument) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>__int32 x </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a4f9073a1b47a63a40fed7a2b39ea63d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f9073a1b47a63a40fed7a2b39ea63d2">&#9670;&nbsp;</a></span>RandgetBytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL RandgetBytes </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>forceSlowPoll</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get len random bytes from the pool (max. RNG_POOL_SIZE bytes per a single call) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">BOOL</td><td>forceSlowPoll </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>len </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>char * buf </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOL FALSE if (bDidSlowPoll == FALSE || forceSlowPoll &amp;&amp; (!SlowPoll ())) FALSE if (!FastPoll ()) TRUE else </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c_a4f9073a1b47a63a40fed7a2b39ea63d2_icgraph.png" border="0" usemap="#_random_8c_a4f9073a1b47a63a40fed7a2b39ea63d2_icgraph" alt=""/></div>
<map name="_random_8c_a4f9073a1b47a63a40fed7a2b39ea63d2_icgraph" id="_random_8c_a4f9073a1b47a63a40fed7a2b39ea63d2_icgraph">
<area shape="rect" id="node2" href="class_gost_crypt_1_1_boot_encryption.html#ae96eefda4ed624bd336f89b4a261b2c1" title="Start the decoy OS wipe. " alt="" coords="169,5,348,47"/>
<area shape="rect" id="node3" href="class_gost_crypt_1_1_boot_encryption.html#ab87016e42d7f7826282297e50db00742" title="Wipe the fidden OS creation on configuration. " alt="" coords="157,71,360,112"/>
<area shape="rect" id="node4" href="_volumes_8c.html#a31bc369dec32aaee5793685da60c640b" title="Writes randomly generated data to unused/reserved header areas. When bPrimaryOnly is TRUE..." alt="" coords="161,136,356,177"/>
</map>
</div>

</div>
</div>
<a id="a2014fa3d97acda067c9618a43e184e2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2014fa3d97acda067c9618a43e184e2c">&#9670;&nbsp;</a></span>RandGetHashFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RandGetHashFunction </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the hash function. </p>
<dl class="section return"><dt>Returns</dt><dd>int HashFunction </dd></dl>

</div>
</div>
<a id="a4c51a11fb671c29c6f9c22e3db140618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c51a11fb671c29c6f9c22e3db140618">&#9670;&nbsp;</a></span>Randinit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Randinit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init the random number generator, setup the hooks, and start the thread. </p>
<dl class="section return"><dt>Returns</dt><dd>int 0 if (bRandDidInit) 1 if (pRandPool == NULL &amp;&amp; (pRandPool == NULL)) 1 if (hMouse == 0) 1 if (!(PeriodicFastPollThreadHandle = (HANDLE) _beginthreadex (NULL, 0, PeriodicFastPollThreadProc, NULL, 0, NULL))) 0 else </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c_a4c51a11fb671c29c6f9c22e3db140618_cgraph.png" border="0" usemap="#_random_8c_a4c51a11fb671c29c6f9c22e3db140618_cgraph" alt=""/></div>
<map name="_random_8c_a4c51a11fb671c29c6f9c22e3db140618_cgraph" id="_random_8c_a4c51a11fb671c29c6f9c22e3db140618_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#aaed9b2d5a4b22439e8646cda3f0db1aa" title="Returns the maximum number of bytes necessary to be generated by the PBKDF2 (PKCS #5) ..." alt="" coords="123,360,275,387"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a992cf30eac8c4f60ca59f7d08609db88" title="Returns the largest key size needed by an EA for the specified mode of operation. ..." alt="" coords="323,5,501,32"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a31f3ed0da669e630ba1fe809a652c177" title="Encipher one block. " alt="" coords="831,56,938,83"/>
<area shape="rect" id="node12" href="_crypto_8c.html#ac328d60e48a816bf710bbc24abfd3bd6" title="Is Aes Hardware cpu supported. " alt="" coords="335,107,489,133"/>
<area shape="rect" id="node13" href="_crypto_8c.html#a89fad765275f1cf31dcf603157ea77bf" title="Decipher one block. " alt="" coords="594,157,701,184"/>
<area shape="rect" id="node19" href="_crypto_8c.html#a0b429fab7dfd8ef48d2ab835596004f0" title="Get first EA (half useless) " alt="" coords="369,208,455,235"/>
<area shape="rect" id="node20" href="_crypto_8c.html#a0746793b59acd1220c830d926d2b9e37" title="Get the next EA. " alt="" coords="368,259,456,285"/>
<area shape="rect" id="node21" href="_crypto_8c.html#a3616fd7fa35d83ea0e0cb8140e0f306a" title="Return values: 0 = success, ERR_CIPHER_INIT_FAILURE (fatal), ERR_CIPHER_INIT_WEAK_KEY (non&#45;fatal) ..." alt="" coords="619,360,676,387"/>
<area shape="rect" id="node22" href="_crypto_8c.html#abfc3043d94e0df6ce41e98025352b885" title="Return the first EA. " alt="" coords="823,461,947,488"/>
<area shape="rect" id="node31" href="_crypto_8c.html#a716b0bb692231cf71d1f95878e45096c" title="Returns sum of key sizes of all ciphers of the EA (in bytes) " alt="" coords="592,411,703,437"/>
<area shape="rect" id="node32" href="_crypto_8c.html#aae913410eb90f16a1ca4021032880ead" title="buf: data to be encrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="362,537,462,564"/>
<area shape="rect" id="node33" href="_xts_8c.html#aad9147213002ffaa3c0450853005e646" title="length: number of bytes to encrypt; may be larger than one data unit and must be divisible by the cip..." alt="" coords="586,461,709,488"/>
<area shape="rect" id="node34" href="_xts_8c.html#af9db6f7d5ac83732ee40cfdf0ca69e16" title="The goal is to switch some byte of a encrypted data with the next encrypted data. This doesn&#39;t hurt t..." alt="" coords="569,664,726,691"/>
<area shape="rect" id="node35" href="_crypto_8c.html#a143fe9aa7d1bc0533f4262974e9fa984" title="buf: data to be encrypted unitNo: sequential number of the data unit with which the buffer starts nbr..." alt="" coords="350,677,474,704"/>
<area shape="rect" id="node37" href="_crypto_8c.html#adf61d3050038714fbf5f958453f4c68a" title="buf: data to be decrypted; the start of the buffer is assumed to be aligned with the start of a data ..." alt="" coords="362,841,462,868"/>
<area shape="rect" id="node41" href="_xts_8c.html#acf61facb05a3ea253498a379275f48a6" title="For descriptions of the input parameters, see EncryptBufferXTS(). Decrypt before switching back the d..." alt="" coords="586,968,709,995"/>
<area shape="rect" id="node5" href="_gost_cipher_8c.html#a5c4472de500c6aa8f73dd9d0418aa4f0" title="Encrypt with gost algorithm. " alt="" coords="1049,56,1146,83"/>
<area shape="rect" id="node6" href="_grasshopper_cipher_8c.html#a8a03545392da4eb01f3fcd5197d42444" title="Encryption procedure. " alt="" coords="1026,107,1169,133"/>
<area shape="rect" id="node7" href="_grasshopper_cipher_8c.html#a6107e1c52141eb86bb87182173247783" title="Switch opposed bytes (lower byte to upper byte, ...) of unsigned long. " alt="" coords="1219,259,1323,285"/>
<area shape="rect" id="node8" href="_grasshopper_cipher_8c.html#ad7ac77c93d4d2a4f28cf4f053605bef0" title="L conversion (16 iteration of R) " alt="" coords="1371,208,1409,235"/>
<area shape="rect" id="node11" href="_grasshopper_cipher_8c.html#a56efe30edac1e0cce6167cb840c2e470" title="Apply S conversion. " alt="" coords="1251,107,1290,133"/>
<area shape="rect" id="node9" href="_grasshopper_cipher_8c.html#abb3e0356548dd4a7ddefbb57b5255eb6" title="Apply R conversion. " alt="" coords="1457,208,1496,235"/>
<area shape="rect" id="node10" href="_grasshopper_cipher_8c.html#a6cbf3c8e29c4398a3dc1fa13e979da17" title="Get conversion value. " alt="" coords="1544,183,1583,209"/>
<area shape="rect" id="node14" href="_gost_cipher_8c.html#a58ce7997f812d09cdb40f8b5ea448acb" title="Decrypt with gost algorithm. " alt="" coords="836,157,933,184"/>
<area shape="rect" id="node15" href="_grasshopper_cipher_8c.html#aaaba43e85bfee3b0522a31774f6072c5" title="Decryption procedure. " alt="" coords="813,208,956,235"/>
<area shape="rect" id="node16" href="_grasshopper_cipher_8c.html#a6ea6ff18be6c29236c40ab2b0818c18e" title="Inverse of L conversion (16 iteration of R_inv) " alt="" coords="1072,157,1123,184"/>
<area shape="rect" id="node18" href="_grasshopper_cipher_8c.html#a46436dc8b92d9ad643ef443af3392e27" title="Inverse of S conversion. " alt="" coords="1071,208,1124,235"/>
<area shape="rect" id="node17" href="_grasshopper_cipher_8c.html#ae7db41b7c51c2721085637dd810dd257" title="Inverse of R conversion. " alt="" coords="1244,157,1297,184"/>
<area shape="rect" id="node23" href="_crypto_8c.html#a162e231ed99c4a3fa4caa50d66703d28" title="Return next cipher if exists. " alt="" coords="822,537,947,564"/>
<area shape="rect" id="node24" href="_crypto_8c.html#aa38ecf7977d369eb9f080b1498e48738" title="Initialise cipher Return values: 0 = success, ERR_CIPHER_INIT_FAILURE (fatal), ERR_CIPHER_INIT_WEAK_K..." alt="" coords="847,360,923,387"/>
<area shape="rect" id="node28" href="_crypto_8c.html#ad395a0b04fac58cda3188c2559ae46dd" title="Get the key size of a cipher at id. " alt="" coords="820,411,949,437"/>
<area shape="rect" id="node30" href="_crypto_8c.html#a3dd093c42e7b7351c23317efacc57221" title="Get the key schedule size of a cipher at id. " alt="" coords="793,613,976,640"/>
<area shape="rect" id="node25" href="_gost_cipher_8c.html#a894c8f0e07a5614968fca09f7ae1f24b" title="Set the gost key Generate a pseudo random data (based on the key) and set the key. " alt="" coords="1047,360,1147,387"/>
<area shape="rect" id="node26" href="_grasshopper_cipher_8c.html#a6b136aade799131cab66db1d5d4df8b0" title="Key setup procedure. " alt="" coords="1024,309,1171,336"/>
<area shape="rect" id="node27" href="_grasshopper_cipher_8c.html#acea73ea2211a8c6ff219e586d742d99f" title="F conversion (used in key setup) " alt="" coords="1251,360,1290,387"/>
<area shape="rect" id="node29" href="_crypto_8c.html#a497fc6204c6a611434f38e4ccec909db" title="Get cipher at id, return null if there is no cipher with this id. " alt="" coords="1057,512,1137,539"/>
<area shape="rect" id="node36" href="_encryption_thread_pool_8c.html#abb01516958dcdb87a96eea999242e434" title="Start the encryption key into the thread pool. Each thread encrypt or decrypt small amount of data..." alt="" coords="549,715,745,741"/>
<area shape="rect" id="node38" href="_crypto_8c.html#aca3647cdf6774c8ce5ba2b0c2f370bd1" title="Returns sum of key schedule sizes of all ciphers of the EA. " alt="" coords="565,765,729,792"/>
<area shape="rect" id="node39" href="_crypto_8c.html#ac51b1aa192c121136917d07e628b3b62" title="Get last EA cipher. " alt="" coords="586,917,709,944"/>
<area shape="rect" id="node40" href="_crypto_8c.html#a7c61a17a983733f94fa7ec56fed30740" title="Return next cipher if exists. " alt="" coords="574,816,721,843"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c_a4c51a11fb671c29c6f9c22e3db140618_icgraph.png" border="0" usemap="#_random_8c_a4c51a11fb671c29c6f9c22e3db140618_icgraph" alt=""/></div>
<map name="_random_8c_a4c51a11fb671c29c6f9c22e3db140618_icgraph" id="_random_8c_a4c51a11fb671c29c6f9c22e3db140618_icgraph">
<area shape="rect" id="node2" href="class_gost_crypt_1_1_boot_encryption.html#ae96eefda4ed624bd336f89b4a261b2c1" title="Start the decoy OS wipe. " alt="" coords="373,17,552,58"/>
<area shape="rect" id="node3" href="class_gost_crypt_1_1_boot_encryption.html#ab87016e42d7f7826282297e50db00742" title="Wipe the fidden OS creation on configuration. " alt="" coords="123,37,325,78"/>
<area shape="rect" id="node4" href="class_gost_crypt_1_1_boot_encryption.html#a9cce66955923f808f4dd297c7041ac5b" title="Change the password. " alt="" coords="373,121,552,162"/>
<area shape="rect" id="node5" href="_dlgcode_8c.html#a9baeca25d1e47e9f4068efe8bff24c3c" title="User enrichement a random pool. " alt="" coords="144,103,304,129"/>
</map>
</div>

</div>
</div>
<a id="a204161668b3568f6d98344329287e95d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a204161668b3568f6d98344329287e95d">&#9670;&nbsp;</a></span>Randmix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL Randmix </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The random pool mixing function. Set the digest size according to the hash, compute the digest message with the seleted hash function, mix and delete for avoiding leaks. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL TRUE </dd></dl>

</div>
</div>
<a id="a39824abaa63b4069cd5e4a50d89f5a31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39824abaa63b4069cd5e4a50d89f5a31">&#9670;&nbsp;</a></span>RandpeekBytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL RandpeekBytes </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enter the critical section and copy some data of a given length. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>len </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unsigned</td><td>char </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOL FALSE if (!bRandDidInit) TRUE else </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c_a39824abaa63b4069cd5e4a50d89f5a31_icgraph.png" border="0" usemap="#_random_8c_a39824abaa63b4069cd5e4a50d89f5a31_icgraph" alt=""/></div>
<map name="_random_8c_a39824abaa63b4069cd5e4a50d89f5a31_icgraph" id="_random_8c_a39824abaa63b4069cd5e4a50d89f5a31_icgraph">
<area shape="rect" id="node2" href="_gstformat_8c.html#a3370cd23fc994ffd40aeca0bc8abe8c3" title="Display the random nuber for the encryption. " alt="" coords="168,5,289,32"/>
</map>
</div>

</div>
</div>
<a id="aba80bcfbc12785c63c8bbb16f415c516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba80bcfbc12785c63c8bbb16f415c516">&#9670;&nbsp;</a></span>RandSetHashFunction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RandSetHashFunction </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hash_algo_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the hash function that will be used by the default one if none was chosen otherwise set it the the hash ID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">int</td><td>hash_algo_id </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c_aba80bcfbc12785c63c8bbb16f415c516_cgraph.png" border="0" usemap="#_random_8c_aba80bcfbc12785c63c8bbb16f415c516_cgraph" alt=""/></div>
<map name="_random_8c_aba80bcfbc12785c63c8bbb16f415c516_cgraph" id="_random_8c_aba80bcfbc12785c63c8bbb16f415c516_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#a2fa53daf8bdc8724162cee75d0b82e15" title="Returns true if deprecated, false else. " alt="" coords="205,5,333,32"/>
<area shape="rect" id="node3" href="_crypto_8c.html#aa4799ad23aa2061b2b501eb7b88b4e6b" title="Returns hash by id or 0 if no hash. " alt="" coords="381,5,455,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c_aba80bcfbc12785c63c8bbb16f415c516_icgraph.png" border="0" usemap="#_random_8c_aba80bcfbc12785c63c8bbb16f415c516_icgraph" alt=""/></div>
<map name="_random_8c_aba80bcfbc12785c63c8bbb16f415c516_icgraph" id="_random_8c_aba80bcfbc12785c63c8bbb16f415c516_icgraph">
<area shape="rect" id="node2" href="class_gost_crypt_1_1_boot_encryption.html#a9cce66955923f808f4dd297c7041ac5b" title="Change the password. " alt="" coords="205,5,384,47"/>
</map>
</div>

</div>
</div>
<a id="a009589ab36ed5eba8dfee41cef19792a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a009589ab36ed5eba8dfee41cef19792a">&#9670;&nbsp;</a></span>RandStop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RandStop </td>
          <td>(</td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>freePool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close everything down, including the thread which is closed down by setting a flag which eventually causes the thread function to exit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">BOOL</td><td>freePool </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_random_8c_a009589ab36ed5eba8dfee41cef19792a_icgraph.png" border="0" usemap="#_random_8c_a009589ab36ed5eba8dfee41cef19792a_icgraph" alt=""/></div>
<map name="_random_8c_a009589ab36ed5eba8dfee41cef19792a_icgraph" id="_random_8c_a009589ab36ed5eba8dfee41cef19792a_icgraph">
<area shape="rect" id="node2" href="class_gost_crypt_1_1_boot_encryption.html#a9cce66955923f808f4dd297c7041ac5b" title="Change the password. " alt="" coords="132,5,311,47"/>
</map>
</div>

</div>
</div>
<a id="a0dbcb0c1d268cb4fb1736a0565781f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dbcb0c1d268cb4fb1736a0565781f61">&#9670;&nbsp;</a></span>SetRandomPoolEnrichedByUserStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetRandomPoolEnrichedByUserStatus </td>
          <td>(</td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>enriched</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the random pool to enriched. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">BOOL</td><td>enriched </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a40afdfbd27ad7326c80e1fce5644783c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40afdfbd27ad7326c80e1fce5644783c">&#9670;&nbsp;</a></span>SlowPoll()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL SlowPoll </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the slowpoll function which gathers up network/hard drive. It is only used for NT server like : WinNT, ServerNT, LanmanNT. performance data for the random pool. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOL TRUE </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
