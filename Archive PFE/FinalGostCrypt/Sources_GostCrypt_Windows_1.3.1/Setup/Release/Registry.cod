; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.24215.1 

	TITLE	C:\Users\Alexis\Desktop\Sources_GostCrypt_Windows_1.3.1_COMMENTED\Sources_GostCrypt_Windows_1.3.1é\Sources_GostCrypt_Windows_1.3.1\Common\Registry.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	___local_stdio_printf_options
PUBLIC	_sprintf
PUBLIC	_ReadLocalMachineRegistryDword
PUBLIC	_ReadLocalMachineRegistryMultiString
PUBLIC	_ReadLocalMachineRegistryString
PUBLIC	_ReadLocalMachineRegistryStringNonReflected
PUBLIC	_ReadRegistryInt
PUBLIC	_ReadRegistryString
PUBLIC	_ReadRegistryBytes
PUBLIC	_WriteRegistryInt
PUBLIC	_WriteLocalMachineRegistryDword
PUBLIC	_WriteLocalMachineRegistryMultiString
PUBLIC	_WriteLocalMachineRegistryString
PUBLIC	_WriteRegistryString
PUBLIC	_WriteRegistryBytes
PUBLIC	_DeleteLocalMachineRegistryKey
PUBLIC	_DeleteRegistryValue
PUBLIC	_GetStartupRegKeyName
PUBLIC	??_C@_0N@PGJGCAIL@tVersion?2Run?$AA@		; `string'
PUBLIC	??_C@_0CC@HPOBEDNL@Software?2Microsoft?2Windows?2Curre@ ; `string'
PUBLIC	??_C@_04HDOCAJNK@?$CFs?$CFs?$AA@		; `string'
EXTRN	_strncpy:PROC
EXTRN	__imp__SetLastError@4:PROC
EXTRN	__imp__RegCloseKey@4:PROC
EXTRN	__imp__RegCreateKeyExA@36:PROC
EXTRN	__imp__RegDeleteKeyA@8:PROC
EXTRN	__imp__RegDeleteValueA@8:PROC
EXTRN	__imp__RegOpenKeyExA@20:PROC
EXTRN	__imp__RegQueryValueExA@24:PROC
EXTRN	__imp__RegSetValueExA@24:PROC
EXTRN	___stdio_common_vsprintf:PROC
EXTRN	@__security_check_cookie@4:PROC
EXTRN	_memset:PROC
EXTRN	___security_cookie:DWORD
_DATA	SEGMENT
COMM	?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:QWORD							; `__local_stdio_printf_options'::`2'::_OptionsStorage
_DATA	ENDS
;	COMDAT ??_C@_04HDOCAJNK@?$CFs?$CFs?$AA@
CONST	SEGMENT
??_C@_04HDOCAJNK@?$CFs?$CFs?$AA@ DB '%s%s', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0CC@HPOBEDNL@Software?2Microsoft?2Windows?2Curre@
CONST	SEGMENT
??_C@_0CC@HPOBEDNL@Software?2Microsoft?2Windows?2Curre@ DB 'Software\Micr'
	DB	'osoft\Windows\Curren', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0N@PGJGCAIL@tVersion?2Run?$AA@
CONST	SEGMENT
??_C@_0N@PGJGCAIL@tVersion?2Run?$AA@ DB 'tVersion\Run', 00H ; `string'
CONST	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _GetStartupRegKeyName
_TEXT	SEGMENT
_regk$ = 8						; size = 4
_GetStartupRegKeyName PROC				; COMDAT

; 456  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 457  : 	// The string is split in order to prevent some antivirus packages from falsely reporting  
; 458  : 	// GostCrypt.exe to contain a possible Trojan horse because of this string (heuristic scan).
; 459  : 	sprintf (regk, "%s%s", "Software\\Microsoft\\Windows\\Curren", "tVersion\\Run");

  00003	68 00 00 00 00	 push	 OFFSET ??_C@_0N@PGJGCAIL@tVersion?2Run?$AA@
  00008	68 00 00 00 00	 push	 OFFSET ??_C@_0CC@HPOBEDNL@Software?2Microsoft?2Windows?2Curre@
  0000d	68 00 00 00 00	 push	 OFFSET ??_C@_04HDOCAJNK@?$CFs?$CFs?$AA@
  00012	ff 75 08	 push	 DWORD PTR _regk$[ebp]
  00015	e8 00 00 00 00	 call	 _sprintf
  0001a	83 c4 10	 add	 esp, 16			; 00000010H

; 460  : }

  0001d	5d		 pop	 ebp
  0001e	c3		 ret	 0
_GetStartupRegKeyName ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _DeleteRegistryValue
_TEXT	SEGMENT
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_DeleteRegistryValue PROC				; COMDAT

; 436  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx

; 437  : 	HKEY hkey = 0;
; 438  : 
; 439  : 	if (RegOpenKeyEx (HKEY_CURRENT_USER, subKey, 0, KEY_WRITE, &hkey) != ERROR_SUCCESS)

  00004	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00007	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  0000e	50		 push	 eax
  0000f	68 06 00 02 00	 push	 131078			; 00020006H
  00014	6a 00		 push	 0
  00016	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  00019	68 01 00 00 80	 push	 -2147483647		; 80000001H
  0001e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  00024	85 c0		 test	 eax, eax
  00026	75 15		 jne	 SHORT $LN1@DeleteRegi

; 440  : 		return;
; 441  : 
; 442  : 	RegDeleteValue (hkey, name);

  00028	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  0002b	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0002e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegDeleteValueA@8

; 443  : 	RegCloseKey (hkey);

  00034	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00037	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
$LN1@DeleteRegi:

; 444  : }

  0003d	8b e5		 mov	 esp, ebp
  0003f	5d		 pop	 ebp
  00040	c3		 ret	 0
_DeleteRegistryValue ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _DeleteLocalMachineRegistryKey
_TEXT	SEGMENT
_hkey$ = -4						; size = 4
_parentKey$ = 8						; size = 4
_subKeyToDelete$ = 12					; size = 4
_DeleteLocalMachineRegistryKey PROC			; COMDAT

; 405  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx

; 406  : 	LONG status;
; 407  : 	HKEY hkey = 0;
; 408  : 
; 409  : 	if ((status = RegOpenKeyEx (HKEY_LOCAL_MACHINE, parentKey, 0, KEY_WRITE, &hkey)) != ERROR_SUCCESS)

  00004	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00007	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  0000e	50		 push	 eax
  0000f	68 06 00 02 00	 push	 131078			; 00020006H
  00014	6a 00		 push	 0
  00016	ff 75 08	 push	 DWORD PTR _parentKey$[ebp]
  00019	68 02 00 00 80	 push	 -2147483646		; 80000002H
  0001e	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  00024	85 c0		 test	 eax, eax
  00026	74 0d		 je	 SHORT $LN2@DeleteLoca

; 410  : 	{
; 411  : 		SetLastError (status);

  00028	50		 push	 eax
  00029	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 412  : 		return FALSE;

  0002f	33 c0		 xor	 eax, eax

; 424  : }

  00031	8b e5		 mov	 esp, ebp
  00033	5d		 pop	 ebp
  00034	c3		 ret	 0
$LN2@DeleteLoca:
  00035	56		 push	 esi

; 413  : 	}
; 414  : 
; 415  : 	if ((status = RegDeleteKey (hkey, subKeyToDelete)) != ERROR_SUCCESS)

  00036	ff 75 0c	 push	 DWORD PTR _subKeyToDelete$[ebp]
  00039	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0003c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegDeleteKeyA@8

; 416  : 	{
; 417  : 		RegCloseKey (hkey);

  00042	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00045	8b f0		 mov	 esi, eax
  00047	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
  0004d	85 f6		 test	 esi, esi
  0004f	74 0e		 je	 SHORT $LN3@DeleteLoca

; 418  : 		SetLastError (status);

  00051	56		 push	 esi
  00052	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 419  : 		return FALSE;

  00058	33 c0		 xor	 eax, eax
  0005a	5e		 pop	 esi

; 424  : }

  0005b	8b e5		 mov	 esp, ebp
  0005d	5d		 pop	 ebp
  0005e	c3		 ret	 0
$LN3@DeleteLoca:

; 420  : 	}
; 421  : 
; 422  : 	RegCloseKey (hkey);
; 423  : 	return TRUE;

  0005f	b8 01 00 00 00	 mov	 eax, 1
  00064	5e		 pop	 esi

; 424  : }

  00065	8b e5		 mov	 esp, ebp
  00067	5d		 pop	 ebp
  00068	c3		 ret	 0
_DeleteLocalMachineRegistryKey ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _WriteRegistryBytes
_TEXT	SEGMENT
_disp$ = -8						; size = 4
_hkey$ = -4						; size = 4
_path$ = 8						; size = 4
_name$ = 12						; size = 4
_str$ = 16						; size = 4
_size$ = 20						; size = 4
_WriteRegistryBytes PROC				; COMDAT

; 381  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 382  : 	HKEY hkey = 0;
; 383  : 	DWORD disp;
; 384  : 	BOOL res;
; 385  : 
; 386  : 	if (RegCreateKeyEx (HKEY_CURRENT_USER, path,
; 387  : 		0, NULL, REG_OPTION_NON_VOLATILE, KEY_WRITE, NULL, &hkey, &disp) != ERROR_SUCCESS)

  00006	8d 45 f8	 lea	 eax, DWORD PTR _disp$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00014	50		 push	 eax
  00015	6a 00		 push	 0
  00017	68 06 00 02 00	 push	 131078			; 00020006H
  0001c	6a 00		 push	 0
  0001e	6a 00		 push	 0
  00020	6a 00		 push	 0
  00022	ff 75 08	 push	 DWORD PTR _path$[ebp]
  00025	68 01 00 00 80	 push	 -2147483647		; 80000001H
  0002a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCreateKeyExA@36
  00030	85 c0		 test	 eax, eax
  00032	74 06		 je	 SHORT $LN2@WriteRegis

; 388  : 		return FALSE;

  00034	33 c0		 xor	 eax, eax

; 393  : }

  00036	8b e5		 mov	 esp, ebp
  00038	5d		 pop	 ebp
  00039	c3		 ret	 0
$LN2@WriteRegis:
  0003a	56		 push	 esi

; 389  : 
; 390  : 	res = RegSetValueEx (hkey, name, 0, REG_BINARY, (BYTE *) str, size);

  0003b	ff 75 14	 push	 DWORD PTR _size$[ebp]
  0003e	ff 75 10	 push	 DWORD PTR _str$[ebp]
  00041	6a 03		 push	 3
  00043	6a 00		 push	 0
  00045	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00048	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0004b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegSetValueExA@24

; 391  : 	RegCloseKey (hkey);

  00051	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00054	8b f0		 mov	 esi, eax
  00056	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4

; 392  : 	return res == ERROR_SUCCESS;

  0005c	33 c0		 xor	 eax, eax
  0005e	85 f6		 test	 esi, esi
  00060	5e		 pop	 esi
  00061	0f 94 c0	 sete	 al

; 393  : }

  00064	8b e5		 mov	 esp, ebp
  00066	5d		 pop	 ebp
  00067	c3		 ret	 0
_WriteRegistryBytes ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _WriteRegistryString
_TEXT	SEGMENT
_disp$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_str$ = 16						; size = 4
_WriteRegistryString PROC				; COMDAT

; 357  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 358  : 	HKEY hkey = 0;
; 359  : 	DWORD disp;
; 360  : 
; 361  : 	if (RegCreateKeyEx (HKEY_CURRENT_USER, subKey,
; 362  : 		0, NULL, REG_OPTION_NON_VOLATILE, KEY_WRITE, NULL, &hkey, &disp) != ERROR_SUCCESS)

  00006	8d 45 f8	 lea	 eax, DWORD PTR _disp$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00014	50		 push	 eax
  00015	6a 00		 push	 0
  00017	68 06 00 02 00	 push	 131078			; 00020006H
  0001c	6a 00		 push	 0
  0001e	6a 00		 push	 0
  00020	6a 00		 push	 0
  00022	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  00025	68 01 00 00 80	 push	 -2147483647		; 80000001H
  0002a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCreateKeyExA@36
  00030	85 c0		 test	 eax, eax
  00032	75 34		 jne	 SHORT $LN1@WriteRegis

; 363  : 		return;
; 364  : 
; 365  : 	RegSetValueEx (hkey, name, 0, REG_SZ, (BYTE *) str, strlen (str) + 1);

  00034	8b 55 10	 mov	 edx, DWORD PTR _str$[ebp]
  00037	8b ca		 mov	 ecx, edx
  00039	56		 push	 esi
  0003a	8d 71 01	 lea	 esi, DWORD PTR [ecx+1]
  0003d	0f 1f 00	 npad	 3
$LL4@WriteRegis:
  00040	8a 01		 mov	 al, BYTE PTR [ecx]
  00042	41		 inc	 ecx
  00043	84 c0		 test	 al, al
  00045	75 f9		 jne	 SHORT $LL4@WriteRegis
  00047	2b ce		 sub	 ecx, esi
  00049	8d 41 01	 lea	 eax, DWORD PTR [ecx+1]
  0004c	50		 push	 eax
  0004d	52		 push	 edx
  0004e	6a 01		 push	 1
  00050	6a 00		 push	 0
  00052	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00055	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00058	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegSetValueExA@24

; 366  : 	RegCloseKey (hkey);

  0005e	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00061	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
  00067	5e		 pop	 esi
$LN1@WriteRegis:

; 367  : }

  00068	8b e5		 mov	 esp, ebp
  0006a	5d		 pop	 ebp
  0006b	c3		 ret	 0
_WriteRegistryString ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _WriteLocalMachineRegistryString
_TEXT	SEGMENT
_disp$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_str$ = 16						; size = 4
_expandable$ = 20					; size = 4
_WriteLocalMachineRegistryString PROC			; COMDAT

; 323  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 324  : 	HKEY hkey = 0;
; 325  : 	DWORD disp;
; 326  : 	LONG status;
; 327  : 
; 328  : 	if ((status = RegCreateKeyEx (HKEY_LOCAL_MACHINE, subKey,
; 329  : 		0, NULL, REG_OPTION_NON_VOLATILE, KEY_WRITE, NULL, &hkey, &disp)) != ERROR_SUCCESS)

  00006	8d 45 f8	 lea	 eax, DWORD PTR _disp$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00014	50		 push	 eax
  00015	6a 00		 push	 0
  00017	68 06 00 02 00	 push	 131078			; 00020006H
  0001c	6a 00		 push	 0
  0001e	6a 00		 push	 0
  00020	6a 00		 push	 0
  00022	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  00025	68 02 00 00 80	 push	 -2147483646		; 80000002H
  0002a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCreateKeyExA@36
  00030	85 c0		 test	 eax, eax
  00032	74 0d		 je	 SHORT $LN2@WriteLocal

; 330  : 	{
; 331  : 		SetLastError (status);

  00034	50		 push	 eax
  00035	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 332  : 		return FALSE;

  0003b	33 c0		 xor	 eax, eax

; 344  : }

  0003d	8b e5		 mov	 esp, ebp
  0003f	5d		 pop	 ebp
  00040	c3		 ret	 0
$LN2@WriteLocal:

; 333  : 	}
; 334  : 
; 335  : 	if ((status = RegSetValueEx (hkey, name, 0, expandable ? REG_EXPAND_SZ : REG_SZ, (BYTE *) str, strlen (str) + 1)) != ERROR_SUCCESS)

  00041	8b 55 10	 mov	 edx, DWORD PTR _str$[ebp]
  00044	8b ca		 mov	 ecx, edx
  00046	56		 push	 esi
  00047	8d 71 01	 lea	 esi, DWORD PTR [ecx+1]
  0004a	66 0f 1f 44 00
	00		 npad	 6
$LL5@WriteLocal:
  00050	8a 01		 mov	 al, BYTE PTR [ecx]
  00052	41		 inc	 ecx
  00053	84 c0		 test	 al, al
  00055	75 f9		 jne	 SHORT $LL5@WriteLocal
  00057	2b ce		 sub	 ecx, esi
  00059	8d 41 01	 lea	 eax, DWORD PTR [ecx+1]
  0005c	50		 push	 eax
  0005d	33 c0		 xor	 eax, eax
  0005f	39 45 14	 cmp	 DWORD PTR _expandable$[ebp], eax
  00062	52		 push	 edx
  00063	0f 95 c0	 setne	 al
  00066	40		 inc	 eax
  00067	50		 push	 eax
  00068	6a 00		 push	 0
  0006a	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  0006d	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00070	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegSetValueExA@24

; 336  : 	{
; 337  : 		RegCloseKey (hkey);

  00076	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00079	8b f0		 mov	 esi, eax
  0007b	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
  00081	85 f6		 test	 esi, esi
  00083	74 0e		 je	 SHORT $LN3@WriteLocal

; 338  : 		SetLastError (status);

  00085	56		 push	 esi
  00086	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 339  : 		return FALSE;

  0008c	33 c0		 xor	 eax, eax
  0008e	5e		 pop	 esi

; 344  : }

  0008f	8b e5		 mov	 esp, ebp
  00091	5d		 pop	 ebp
  00092	c3		 ret	 0
$LN3@WriteLocal:

; 340  : 	}
; 341  : 
; 342  : 	RegCloseKey (hkey);
; 343  : 	return TRUE;

  00093	b8 01 00 00 00	 mov	 eax, 1
  00098	5e		 pop	 esi

; 344  : }

  00099	8b e5		 mov	 esp, ebp
  0009b	5d		 pop	 ebp
  0009c	c3		 ret	 0
_WriteLocalMachineRegistryString ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _WriteLocalMachineRegistryMultiString
_TEXT	SEGMENT
_disp$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_multiString$ = 16					; size = 4
_size$ = 20						; size = 4
_WriteLocalMachineRegistryMultiString PROC		; COMDAT

; 288  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 289  : 	HKEY hkey = 0;
; 290  : 	DWORD disp;
; 291  : 	LONG status;
; 292  : 
; 293  : 	if ((status = RegCreateKeyEx (HKEY_LOCAL_MACHINE, subKey,
; 294  : 		0, NULL, REG_OPTION_NON_VOLATILE, KEY_WRITE, NULL, &hkey, &disp)) != ERROR_SUCCESS)

  00006	8d 45 f8	 lea	 eax, DWORD PTR _disp$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00014	50		 push	 eax
  00015	6a 00		 push	 0
  00017	68 06 00 02 00	 push	 131078			; 00020006H
  0001c	6a 00		 push	 0
  0001e	6a 00		 push	 0
  00020	6a 00		 push	 0
  00022	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  00025	68 02 00 00 80	 push	 -2147483646		; 80000002H
  0002a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCreateKeyExA@36
  00030	85 c0		 test	 eax, eax
  00032	74 0d		 je	 SHORT $LN2@WriteLocal

; 295  : 	{
; 296  : 		SetLastError (status);

  00034	50		 push	 eax
  00035	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 297  : 		return FALSE;

  0003b	33 c0		 xor	 eax, eax

; 309  : }

  0003d	8b e5		 mov	 esp, ebp
  0003f	5d		 pop	 ebp
  00040	c3		 ret	 0
$LN2@WriteLocal:
  00041	56		 push	 esi

; 298  : 	}
; 299  : 
; 300  : 	if ((status = RegSetValueEx (hkey, name, 0, REG_MULTI_SZ, (BYTE *) multiString, size)) != ERROR_SUCCESS)

  00042	ff 75 14	 push	 DWORD PTR _size$[ebp]
  00045	ff 75 10	 push	 DWORD PTR _multiString$[ebp]
  00048	6a 07		 push	 7
  0004a	6a 00		 push	 0
  0004c	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  0004f	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00052	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegSetValueExA@24

; 301  : 	{
; 302  : 		RegCloseKey (hkey);

  00058	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0005b	8b f0		 mov	 esi, eax
  0005d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
  00063	85 f6		 test	 esi, esi
  00065	74 0e		 je	 SHORT $LN3@WriteLocal

; 303  : 		SetLastError (status);

  00067	56		 push	 esi
  00068	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 304  : 		return FALSE;

  0006e	33 c0		 xor	 eax, eax
  00070	5e		 pop	 esi

; 309  : }

  00071	8b e5		 mov	 esp, ebp
  00073	5d		 pop	 ebp
  00074	c3		 ret	 0
$LN3@WriteLocal:

; 305  : 	}
; 306  : 
; 307  : 	RegCloseKey (hkey);
; 308  : 	return TRUE;

  00075	b8 01 00 00 00	 mov	 eax, 1
  0007a	5e		 pop	 esi

; 309  : }

  0007b	8b e5		 mov	 esp, ebp
  0007d	5d		 pop	 ebp
  0007e	c3		 ret	 0
_WriteLocalMachineRegistryMultiString ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _WriteLocalMachineRegistryDword
_TEXT	SEGMENT
_disp$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_value$ = 16						; size = 4
_WriteLocalMachineRegistryDword PROC			; COMDAT

; 253  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 254  : 	HKEY hkey = 0;
; 255  : 	DWORD disp;
; 256  : 	LONG status;
; 257  : 
; 258  : 	if ((status = RegCreateKeyEx (HKEY_LOCAL_MACHINE, subKey,
; 259  : 		0, NULL, REG_OPTION_NON_VOLATILE, KEY_WRITE, NULL, &hkey, &disp)) != ERROR_SUCCESS)

  00006	8d 45 f8	 lea	 eax, DWORD PTR _disp$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00014	50		 push	 eax
  00015	6a 00		 push	 0
  00017	68 06 00 02 00	 push	 131078			; 00020006H
  0001c	6a 00		 push	 0
  0001e	6a 00		 push	 0
  00020	6a 00		 push	 0
  00022	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  00025	68 02 00 00 80	 push	 -2147483646		; 80000002H
  0002a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCreateKeyExA@36
  00030	85 c0		 test	 eax, eax
  00032	74 0d		 je	 SHORT $LN2@WriteLocal

; 260  : 	{
; 261  : 		SetLastError (status);

  00034	50		 push	 eax
  00035	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 262  : 		return FALSE;

  0003b	33 c0		 xor	 eax, eax

; 274  : }

  0003d	8b e5		 mov	 esp, ebp
  0003f	5d		 pop	 ebp
  00040	c3		 ret	 0
$LN2@WriteLocal:
  00041	56		 push	 esi

; 263  : 	}
; 264  : 
; 265  : 	if ((status = RegSetValueEx (hkey, name, 0, REG_DWORD, (BYTE *) &value, sizeof value)) != ERROR_SUCCESS)

  00042	6a 04		 push	 4
  00044	8d 45 10	 lea	 eax, DWORD PTR _value$[ebp]
  00047	50		 push	 eax
  00048	6a 04		 push	 4
  0004a	6a 00		 push	 0
  0004c	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  0004f	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00052	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegSetValueExA@24

; 266  : 	{
; 267  : 		RegCloseKey (hkey);

  00058	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0005b	8b f0		 mov	 esi, eax
  0005d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
  00063	85 f6		 test	 esi, esi
  00065	74 0e		 je	 SHORT $LN3@WriteLocal

; 268  : 		SetLastError (status);

  00067	56		 push	 esi
  00068	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__SetLastError@4

; 269  : 		return FALSE;

  0006e	33 c0		 xor	 eax, eax
  00070	5e		 pop	 esi

; 274  : }

  00071	8b e5		 mov	 esp, ebp
  00073	5d		 pop	 ebp
  00074	c3		 ret	 0
$LN3@WriteLocal:

; 270  : 	}
; 271  : 
; 272  : 	RegCloseKey (hkey);
; 273  : 	return TRUE;

  00075	b8 01 00 00 00	 mov	 eax, 1
  0007a	5e		 pop	 esi

; 274  : }

  0007b	8b e5		 mov	 esp, ebp
  0007d	5d		 pop	 ebp
  0007e	c3		 ret	 0
_WriteLocalMachineRegistryDword ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _WriteRegistryInt
_TEXT	SEGMENT
_disp$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_value$ = 16						; size = 4
_WriteRegistryInt PROC					; COMDAT

; 230  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 231  : 	HKEY hkey = 0;
; 232  : 	DWORD disp;
; 233  : 
; 234  : 	if (RegCreateKeyEx (HKEY_CURRENT_USER, subKey,
; 235  : 		0, NULL, REG_OPTION_NON_VOLATILE, KEY_WRITE, NULL, &hkey, &disp) != ERROR_SUCCESS)

  00006	8d 45 f8	 lea	 eax, DWORD PTR _disp$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00014	50		 push	 eax
  00015	6a 00		 push	 0
  00017	68 06 00 02 00	 push	 131078			; 00020006H
  0001c	6a 00		 push	 0
  0001e	6a 00		 push	 0
  00020	6a 00		 push	 0
  00022	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  00025	68 01 00 00 80	 push	 -2147483647		; 80000001H
  0002a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCreateKeyExA@36
  00030	85 c0		 test	 eax, eax
  00032	75 1f		 jne	 SHORT $LN1@WriteRegis

; 236  : 		return;
; 237  : 
; 238  : 	RegSetValueEx (hkey, name, 0, REG_DWORD, (BYTE *) &value, sizeof value);

  00034	6a 04		 push	 4
  00036	8d 45 10	 lea	 eax, DWORD PTR _value$[ebp]
  00039	50		 push	 eax
  0003a	6a 04		 push	 4
  0003c	6a 00		 push	 0
  0003e	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00041	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00044	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegSetValueExA@24

; 239  : 	RegCloseKey (hkey);

  0004a	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0004d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
$LN1@WriteRegis:

; 240  : }

  00053	8b e5		 mov	 esp, ebp
  00055	5d		 pop	 ebp
  00056	c3		 ret	 0
_WriteRegistryInt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _ReadRegistryBytes
_TEXT	SEGMENT
_hkey$ = -4						; size = 4
_path$ = 8						; size = 4
_name$ = 12						; size = 4
_value$ = 16						; size = 4
_size$ = 20						; size = 4
_maxLen$ = 20						; size = 4
_ReadRegistryBytes PROC					; COMDAT

; 205  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx

; 206  : 	HKEY hkey = 0;
; 207  : 	DWORD size = maxLen;

  00004	8b 45 14	 mov	 eax, DWORD PTR _maxLen$[ebp]
  00007	89 45 14	 mov	 DWORD PTR _size$[ebp], eax

; 208  : 	BOOL success = FALSE;
; 209  : 
; 210  : 	if (RegOpenKeyEx (HKEY_CURRENT_USER, path, 0, KEY_READ, &hkey) != ERROR_SUCCESS)

  0000a	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  0000d	50		 push	 eax
  0000e	68 19 00 02 00	 push	 131097			; 00020019H
  00013	6a 00		 push	 0
  00015	ff 75 08	 push	 DWORD PTR _path$[ebp]
  00018	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  0001f	68 01 00 00 80	 push	 -2147483647		; 80000001H
  00024	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  0002a	85 c0		 test	 eax, eax
  0002c	74 06		 je	 SHORT $LN2@ReadRegist

; 211  : 		return 0;

  0002e	33 c0		 xor	 eax, eax

; 217  : }

  00030	8b e5		 mov	 esp, ebp
  00032	5d		 pop	 ebp
  00033	c3		 ret	 0
$LN2@ReadRegist:
  00034	56		 push	 esi

; 212  : 
; 213  : 	success = (RegQueryValueEx (hkey, name, 0,	0, (LPBYTE) value,	&size) == ERROR_SUCCESS);

  00035	8d 45 14	 lea	 eax, DWORD PTR _size$[ebp]
  00038	50		 push	 eax
  00039	ff 75 10	 push	 DWORD PTR _value$[ebp]
  0003c	6a 00		 push	 0
  0003e	6a 00		 push	 0
  00040	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00043	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00046	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegQueryValueExA@24

; 214  : 	RegCloseKey (hkey);

  0004c	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0004f	f7 d8		 neg	 eax
  00051	1b f6		 sbb	 esi, esi
  00053	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4

; 215  : 
; 216  : 	return success ? size : 0;

  00059	33 c0		 xor	 eax, eax
  0005b	83 c6 01	 add	 esi, 1
  0005e	5e		 pop	 esi
  0005f	0f 45 45 14	 cmovne	 eax, DWORD PTR _size$[ebp]

; 217  : }

  00063	8b e5		 mov	 esp, ebp
  00065	5d		 pop	 ebp
  00066	c3		 ret	 0
_ReadRegistryBytes ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _ReadRegistryString
_TEXT	SEGMENT
_name$GSCopy$1$ = -1056					; size = 4
_size$ = -1052						; size = 4
_hkey$ = -1048						; size = 4
_value$ = -1044						; size = 1040
__$ArrayPad$ = -4					; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_defaultValue$ = 16					; size = 4
_str$ = 20						; size = 4
_maxLen$ = 24						; size = 4
_ReadRegistryString PROC				; COMDAT

; 176  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 20 04 00
	00		 sub	 esp, 1056		; 00000420H
  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ___security_cookie
  0000e	33 c5		 xor	 eax, ebp
  00010	89 45 fc	 mov	 DWORD PTR __$ArrayPad$[ebp], eax
  00013	8b 4d 10	 mov	 ecx, DWORD PTR _defaultValue$[ebp]
  00016	8b 45 0c	 mov	 eax, DWORD PTR _name$[ebp]
  00019	53		 push	 ebx

; 177  : 	HKEY hkey = 0;
; 178  : 	char value[MAX_PATH*4];
; 179  : 	DWORD size = sizeof (value);
; 180  : 
; 181  : 	strncpy (str, defaultValue, maxLen-1);

  0001a	8b 5d 18	 mov	 ebx, DWORD PTR _maxLen$[ebp]
  0001d	56		 push	 esi
  0001e	8b 75 08	 mov	 esi, DWORD PTR _subKey$[ebp]
  00021	4b		 dec	 ebx
  00022	57		 push	 edi
  00023	8b 7d 14	 mov	 edi, DWORD PTR _str$[ebp]
  00026	53		 push	 ebx
  00027	51		 push	 ecx
  00028	57		 push	 edi
  00029	89 85 e0 fb ff
	ff		 mov	 DWORD PTR _name$GSCopy$1$[ebp], eax
  0002f	c7 85 e8 fb ff
	ff 00 00 00 00	 mov	 DWORD PTR _hkey$[ebp], 0
  00039	c7 85 e4 fb ff
	ff 10 04 00 00	 mov	 DWORD PTR _size$[ebp], 1040 ; 00000410H
  00043	e8 00 00 00 00	 call	 _strncpy

; 182  : 
; 183  : 	ZeroMemory (value, sizeof value);

  00048	68 10 04 00 00	 push	 1040			; 00000410H
  0004d	8d 85 ec fb ff
	ff		 lea	 eax, DWORD PTR _value$[ebp]
  00053	6a 00		 push	 0
  00055	50		 push	 eax
  00056	e8 00 00 00 00	 call	 _memset
  0005b	83 c4 18	 add	 esp, 24			; 00000018H

; 184  : 	if (RegOpenKeyEx (HKEY_CURRENT_USER, subKey,
; 185  : 		0, KEY_READ, &hkey) == ERROR_SUCCESS)

  0005e	8d 85 e8 fb ff
	ff		 lea	 eax, DWORD PTR _hkey$[ebp]
  00064	50		 push	 eax
  00065	68 19 00 02 00	 push	 131097			; 00020019H
  0006a	6a 00		 push	 0
  0006c	56		 push	 esi
  0006d	68 01 00 00 80	 push	 -2147483647		; 80000001H
  00072	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  00078	85 c0		 test	 eax, eax
  0007a	75 39		 jne	 SHORT $LN3@ReadRegist

; 186  : 		if (RegQueryValueEx (hkey, name, 0,	0, (LPBYTE) &value,	&size) == ERROR_SUCCESS)

  0007c	8d 85 e4 fb ff
	ff		 lea	 eax, DWORD PTR _size$[ebp]
  00082	50		 push	 eax
  00083	8d 85 ec fb ff
	ff		 lea	 eax, DWORD PTR _value$[ebp]
  00089	50		 push	 eax
  0008a	6a 00		 push	 0
  0008c	6a 00		 push	 0
  0008e	ff b5 e0 fb ff
	ff		 push	 DWORD PTR _name$GSCopy$1$[ebp]
  00094	ff b5 e8 fb ff
	ff		 push	 DWORD PTR _hkey$[ebp]
  0009a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegQueryValueExA@24
  000a0	85 c0		 test	 eax, eax
  000a2	75 11		 jne	 SHORT $LN3@ReadRegist

; 187  : 			strncpy (str, value, maxLen-1);

  000a4	53		 push	 ebx
  000a5	8d 85 ec fb ff
	ff		 lea	 eax, DWORD PTR _value$[ebp]
  000ab	50		 push	 eax
  000ac	57		 push	 edi
  000ad	e8 00 00 00 00	 call	 _strncpy
  000b2	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN3@ReadRegist:

; 188  : 
; 189  : 	RegCloseKey (hkey);

  000b5	ff b5 e8 fb ff
	ff		 push	 DWORD PTR _hkey$[ebp]
  000bb	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4

; 190  : 	return str;
; 191  : }

  000c1	8b 4d fc	 mov	 ecx, DWORD PTR __$ArrayPad$[ebp]
  000c4	8b c7		 mov	 eax, edi
  000c6	5f		 pop	 edi
  000c7	5e		 pop	 esi
  000c8	33 cd		 xor	 ecx, ebp
  000ca	5b		 pop	 ebx
  000cb	e8 00 00 00 00	 call	 @__security_check_cookie@4
  000d0	8b e5		 mov	 esp, ebp
  000d2	5d		 pop	 ebp
  000d3	c3		 ret	 0
_ReadRegistryString ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _ReadRegistryInt
_TEXT	SEGMENT
_size$ = -12						; size = 4
_value$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_defaultValue$ = 16					; size = 4
_ReadRegistryInt PROC					; COMDAT

; 148  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH

; 149  : 	HKEY hkey = 0;
; 150  : 	DWORD value, size = sizeof (DWORD);
; 151  : 
; 152  : 	if (RegOpenKeyEx (HKEY_CURRENT_USER, subKey,
; 153  : 		0, KEY_READ, &hkey) != ERROR_SUCCESS)

  00006	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	68 19 00 02 00	 push	 131097			; 00020019H
  00016	6a 00		 push	 0
  00018	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  0001b	c7 45 f4 04 00
	00 00		 mov	 DWORD PTR _size$[ebp], 4
  00022	68 01 00 00 80	 push	 -2147483647		; 80000001H
  00027	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  0002d	85 c0		 test	 eax, eax
  0002f	74 07		 je	 SHORT $LN2@ReadRegist

; 154  : 		return defaultValue;

  00031	8b 45 10	 mov	 eax, DWORD PTR _defaultValue$[ebp]

; 161  : }

  00034	8b e5		 mov	 esp, ebp
  00036	5d		 pop	 ebp
  00037	c3		 ret	 0
$LN2@ReadRegist:

; 155  : 
; 156  : 	if (RegQueryValueEx (hkey, name, 0,	0, (LPBYTE) &value, &size) != ERROR_SUCCESS)

  00038	8d 45 f4	 lea	 eax, DWORD PTR _size$[ebp]
  0003b	50		 push	 eax
  0003c	8d 45 f8	 lea	 eax, DWORD PTR _value$[ebp]
  0003f	50		 push	 eax
  00040	6a 00		 push	 0
  00042	6a 00		 push	 0
  00044	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00047	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0004a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegQueryValueExA@24
  00050	8b 4d f8	 mov	 ecx, DWORD PTR _value$[ebp]
  00053	85 c0		 test	 eax, eax

; 157  : 		value = defaultValue;
; 158  : 
; 159  : 	RegCloseKey (hkey);

  00055	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00058	0f 45 4d 10	 cmovne	 ecx, DWORD PTR _defaultValue$[ebp]
  0005c	89 4d f8	 mov	 DWORD PTR _value$[ebp], ecx
  0005f	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4

; 160  : 	return value;

  00065	8b 45 f8	 mov	 eax, DWORD PTR _value$[ebp]

; 161  : }

  00068	8b e5		 mov	 esp, ebp
  0006a	5d		 pop	 ebp
  0006b	c3		 ret	 0
_ReadRegistryInt ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _ReadLocalMachineRegistryStringNonReflected
_TEXT	SEGMENT
_type$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_str$ = 16						; size = 4
_size$ = 20						; size = 4
_ReadLocalMachineRegistryStringNonReflected PROC	; COMDAT

; 120  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 121  : 	HKEY hkey = 0;
; 122  : 	DWORD type;
; 123  : 
; 124  : 	if (RegOpenKeyEx (HKEY_LOCAL_MACHINE, subKey, 0, KEY_READ | KEY_WOW64_64KEY, &hkey) != ERROR_SUCCESS)

  00006	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	68 19 01 02 00	 push	 131353			; 00020119H
  00016	6a 00		 push	 0
  00018	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  0001b	68 02 00 00 80	 push	 -2147483646		; 80000002H
  00020	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  00026	85 c0		 test	 eax, eax
  00028	75 25		 jne	 SHORT $LN5@ReadLocalM

; 125  : 		return FALSE;
; 126  : 
; 127  : 	if (RegQueryValueEx (hkey, name, NULL, &type, (BYTE *) str, size) != ERROR_SUCCESS)

  0002a	ff 75 14	 push	 DWORD PTR _size$[ebp]
  0002d	8d 45 f8	 lea	 eax, DWORD PTR _type$[ebp]
  00030	ff 75 10	 push	 DWORD PTR _str$[ebp]
  00033	50		 push	 eax
  00034	6a 00		 push	 0
  00036	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00039	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0003c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegQueryValueExA@24

; 128  : 	{
; 129  : 		RegCloseKey (hkey);

  00042	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00045	85 c0		 test	 eax, eax
  00047	74 0c		 je	 SHORT $LN3@ReadLocalM
  00049	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
$LN5@ReadLocalM:

; 130  : 		return FALSE;

  0004f	33 c0		 xor	 eax, eax

; 135  : }

  00051	8b e5		 mov	 esp, ebp
  00053	5d		 pop	 ebp
  00054	c3		 ret	 0
$LN3@ReadLocalM:

; 131  : 	}
; 132  : 
; 133  : 	RegCloseKey (hkey);

  00055	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4

; 134  : 	return type == REG_SZ;

  0005b	33 c0		 xor	 eax, eax
  0005d	83 7d f8 01	 cmp	 DWORD PTR _type$[ebp], 1
  00061	0f 94 c0	 sete	 al

; 135  : }

  00064	8b e5		 mov	 esp, ebp
  00066	5d		 pop	 ebp
  00067	c3		 ret	 0
_ReadLocalMachineRegistryStringNonReflected ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _ReadLocalMachineRegistryString
_TEXT	SEGMENT
_type$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_str$ = 16						; size = 4
_size$ = 20						; size = 4
_ReadLocalMachineRegistryString PROC			; COMDAT

; 91   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 92   : 	HKEY hkey = 0;
; 93   : 	DWORD type;
; 94   : 
; 95   : 	if (RegOpenKeyEx (HKEY_LOCAL_MACHINE, subKey, 0, KEY_READ, &hkey) != ERROR_SUCCESS)

  00006	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	68 19 00 02 00	 push	 131097			; 00020019H
  00016	6a 00		 push	 0
  00018	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  0001b	68 02 00 00 80	 push	 -2147483646		; 80000002H
  00020	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  00026	85 c0		 test	 eax, eax
  00028	75 25		 jne	 SHORT $LN5@ReadLocalM

; 96   : 		return FALSE;
; 97   : 
; 98   : 	if (RegQueryValueEx (hkey, name, NULL, &type, (BYTE *) str, size) != ERROR_SUCCESS)

  0002a	ff 75 14	 push	 DWORD PTR _size$[ebp]
  0002d	8d 45 f8	 lea	 eax, DWORD PTR _type$[ebp]
  00030	ff 75 10	 push	 DWORD PTR _str$[ebp]
  00033	50		 push	 eax
  00034	6a 00		 push	 0
  00036	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00039	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0003c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegQueryValueExA@24

; 99   : 	{
; 100  : 		RegCloseKey (hkey);

  00042	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00045	85 c0		 test	 eax, eax
  00047	74 0c		 je	 SHORT $LN3@ReadLocalM
  00049	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
$LN5@ReadLocalM:

; 101  : 		return FALSE;

  0004f	33 c0		 xor	 eax, eax

; 106  : }

  00051	8b e5		 mov	 esp, ebp
  00053	5d		 pop	 ebp
  00054	c3		 ret	 0
$LN3@ReadLocalM:

; 102  : 	}
; 103  : 
; 104  : 	RegCloseKey (hkey);

  00055	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4

; 105  : 	return type == REG_SZ;

  0005b	33 c0		 xor	 eax, eax
  0005d	83 7d f8 01	 cmp	 DWORD PTR _type$[ebp], 1
  00061	0f 94 c0	 sete	 al

; 106  : }

  00064	8b e5		 mov	 esp, ebp
  00066	5d		 pop	 ebp
  00067	c3		 ret	 0
_ReadLocalMachineRegistryString ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _ReadLocalMachineRegistryMultiString
_TEXT	SEGMENT
_type$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_value$ = 16						; size = 4
_size$ = 20						; size = 4
_ReadLocalMachineRegistryMultiString PROC		; COMDAT

; 62   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 08	 sub	 esp, 8

; 63   : 	HKEY hkey = 0;
; 64   : 	DWORD type;
; 65   : 
; 66   : 	if (RegOpenKeyEx (HKEY_LOCAL_MACHINE, subKey, 0, KEY_READ, &hkey) != ERROR_SUCCESS)

  00006	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	68 19 00 02 00	 push	 131097			; 00020019H
  00016	6a 00		 push	 0
  00018	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  0001b	68 02 00 00 80	 push	 -2147483646		; 80000002H
  00020	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  00026	85 c0		 test	 eax, eax
  00028	75 25		 jne	 SHORT $LN5@ReadLocalM

; 67   : 		return FALSE;
; 68   : 
; 69   : 	if (RegQueryValueEx (hkey, name, NULL, &type, (BYTE *) value, size) != ERROR_SUCCESS)

  0002a	ff 75 14	 push	 DWORD PTR _size$[ebp]
  0002d	8d 45 f8	 lea	 eax, DWORD PTR _type$[ebp]
  00030	ff 75 10	 push	 DWORD PTR _value$[ebp]
  00033	50		 push	 eax
  00034	6a 00		 push	 0
  00036	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00039	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0003c	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegQueryValueExA@24

; 70   : 	{
; 71   : 		RegCloseKey (hkey);

  00042	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00045	85 c0		 test	 eax, eax
  00047	74 0c		 je	 SHORT $LN3@ReadLocalM
  00049	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
$LN5@ReadLocalM:

; 72   : 		return FALSE;

  0004f	33 c0		 xor	 eax, eax

; 77   : }

  00051	8b e5		 mov	 esp, ebp
  00053	5d		 pop	 ebp
  00054	c3		 ret	 0
$LN3@ReadLocalM:

; 73   : 	}
; 74   : 
; 75   : 	RegCloseKey (hkey);

  00055	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4

; 76   : 	return type == REG_MULTI_SZ;

  0005b	33 c0		 xor	 eax, eax
  0005d	83 7d f8 07	 cmp	 DWORD PTR _type$[ebp], 7
  00061	0f 94 c0	 sete	 al

; 77   : }

  00064	8b e5		 mov	 esp, ebp
  00066	5d		 pop	 ebp
  00067	c3		 ret	 0
_ReadLocalMachineRegistryMultiString ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\users\alexis\desktop\sources_gostcrypt_windows_1.3.1_commented\sources_gostcrypt_windows_1.3.1é\sources_gostcrypt_windows_1.3.1\common\registry.c
;	COMDAT _ReadLocalMachineRegistryDword
_TEXT	SEGMENT
_type$ = -12						; size = 4
_size$ = -8						; size = 4
_hkey$ = -4						; size = 4
_subKey$ = 8						; size = 4
_name$ = 12						; size = 4
_value$ = 16						; size = 4
_ReadLocalMachineRegistryDword PROC			; COMDAT

; 32   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 0c	 sub	 esp, 12			; 0000000cH

; 33   : 	HKEY hkey = 0;
; 34   : 	DWORD size = sizeof (*value);
; 35   : 	DWORD type;
; 36   : 
; 37   : 	if (RegOpenKeyEx (HKEY_LOCAL_MACHINE, subKey, 0, KEY_READ, &hkey) != ERROR_SUCCESS)

  00006	8d 45 fc	 lea	 eax, DWORD PTR _hkey$[ebp]
  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _hkey$[ebp], 0
  00010	50		 push	 eax
  00011	68 19 00 02 00	 push	 131097			; 00020019H
  00016	6a 00		 push	 0
  00018	ff 75 08	 push	 DWORD PTR _subKey$[ebp]
  0001b	c7 45 f8 04 00
	00 00		 mov	 DWORD PTR _size$[ebp], 4
  00022	68 02 00 00 80	 push	 -2147483646		; 80000002H
  00027	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegOpenKeyExA@20
  0002d	85 c0		 test	 eax, eax
  0002f	75 26		 jne	 SHORT $LN5@ReadLocalM

; 38   : 		return FALSE;
; 39   : 
; 40   : 	if (RegQueryValueEx (hkey, name, NULL, &type, (BYTE *) value, &size) != ERROR_SUCCESS)

  00031	8d 45 f8	 lea	 eax, DWORD PTR _size$[ebp]
  00034	50		 push	 eax
  00035	ff 75 10	 push	 DWORD PTR _value$[ebp]
  00038	8d 45 f4	 lea	 eax, DWORD PTR _type$[ebp]
  0003b	50		 push	 eax
  0003c	6a 00		 push	 0
  0003e	ff 75 0c	 push	 DWORD PTR _name$[ebp]
  00041	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  00044	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegQueryValueExA@24

; 41   : 	{
; 42   : 		RegCloseKey (hkey);

  0004a	ff 75 fc	 push	 DWORD PTR _hkey$[ebp]
  0004d	85 c0		 test	 eax, eax
  0004f	74 0c		 je	 SHORT $LN3@ReadLocalM
  00051	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4
$LN5@ReadLocalM:

; 43   : 		return FALSE;

  00057	33 c0		 xor	 eax, eax

; 48   : }

  00059	8b e5		 mov	 esp, ebp
  0005b	5d		 pop	 ebp
  0005c	c3		 ret	 0
$LN3@ReadLocalM:

; 44   : 	}
; 45   : 
; 46   : 	RegCloseKey (hkey);

  0005d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__RegCloseKey@4

; 47   : 	return type == REG_DWORD;

  00063	33 c0		 xor	 eax, eax
  00065	83 7d f4 04	 cmp	 DWORD PTR _type$[ebp], 4
  00069	0f 94 c0	 sete	 al

; 48   : }

  0006c	8b e5		 mov	 esp, ebp
  0006e	5d		 pop	 ebp
  0006f	c3		 ret	 0
_ReadLocalMachineRegistryDword ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\program files (x86)\windows kits\10\include\10.0.10240.0\ucrt\stdio.h
;	COMDAT _sprintf
_TEXT	SEGMENT
__Buffer$ = 8						; size = 4
__Format$ = 12						; size = 4
_sprintf PROC						; COMDAT

; 1776 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 1777 :     int _Result;
; 1778 :     va_list _ArgList;
; 1779 :     __crt_va_start(_ArgList, _Format);
; 1780 : 
; 1781 :     #pragma warning(push)
; 1782 :     #pragma warning(disable: 4996) // Deprecation
; 1783 :     _Result = _vsprintf_l(_Buffer, _Format, NULL, _ArgList);

  00003	8d 45 10	 lea	 eax, DWORD PTR __Format$[ebp+4]
  00006	50		 push	 eax
  00007	6a 00		 push	 0
  00009	ff 75 0c	 push	 DWORD PTR __Format$[ebp]
  0000c	6a ff		 push	 -1
  0000e	ff 75 08	 push	 DWORD PTR __Buffer$[ebp]
  00011	e8 00 00 00 00	 call	 ___local_stdio_printf_options
  00016	8b 08		 mov	 ecx, DWORD PTR [eax]
  00018	ff 70 04	 push	 DWORD PTR [eax+4]
  0001b	83 c9 01	 or	 ecx, 1
  0001e	51		 push	 ecx
  0001f	e8 00 00 00 00	 call	 ___stdio_common_vsprintf
  00024	83 c9 ff	 or	 ecx, -1
  00027	83 c4 1c	 add	 esp, 28			; 0000001cH
  0002a	85 c0		 test	 eax, eax
  0002c	0f 48 c1	 cmovs	 eax, ecx

; 1784 :     #pragma warning(pop)
; 1785 : 
; 1786 :     __crt_va_end(_ArgList);
; 1787 :     return _Result;
; 1788 : }

  0002f	5d		 pop	 ebp
  00030	c3		 ret	 0
_sprintf ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\program files (x86)\windows kits\10\include\10.0.10240.0\ucrt\stdio.h
;	COMDAT __vsprintf_l
_TEXT	SEGMENT
__Buffer$ = 8						; size = 4
__Format$ = 12						; size = 4
__Locale$ = 16						; size = 4
__ArgList$ = 20						; size = 4
__vsprintf_l PROC					; COMDAT

; 1455 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 1456 :     #pragma warning(push)
; 1457 :     #pragma warning(disable: 4996) // Deprecation
; 1458 :     return _vsnprintf_l(_Buffer, (size_t)-1, _Format, _Locale, _ArgList);

  00003	ff 75 14	 push	 DWORD PTR __ArgList$[ebp]
  00006	ff 75 10	 push	 DWORD PTR __Locale$[ebp]
  00009	ff 75 0c	 push	 DWORD PTR __Format$[ebp]
  0000c	6a ff		 push	 -1
  0000e	ff 75 08	 push	 DWORD PTR __Buffer$[ebp]
  00011	e8 00 00 00 00	 call	 ___local_stdio_printf_options
  00016	8b 08		 mov	 ecx, DWORD PTR [eax]
  00018	ff 70 04	 push	 DWORD PTR [eax+4]
  0001b	83 c9 01	 or	 ecx, 1
  0001e	51		 push	 ecx
  0001f	e8 00 00 00 00	 call	 ___stdio_common_vsprintf
  00024	83 c9 ff	 or	 ecx, -1
  00027	83 c4 1c	 add	 esp, 28			; 0000001cH
  0002a	85 c0		 test	 eax, eax
  0002c	0f 48 c1	 cmovs	 eax, ecx

; 1459 :     #pragma warning(pop)
; 1460 : }

  0002f	5d		 pop	 ebp
  00030	c3		 ret	 0
__vsprintf_l ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\program files (x86)\windows kits\10\include\10.0.10240.0\ucrt\stdio.h
;	COMDAT __vsnprintf_l
_TEXT	SEGMENT
__Buffer$ = 8						; size = 4
__BufferCount$ = 12					; size = 4
__Format$ = 16						; size = 4
__Locale$ = 20						; size = 4
__ArgList$ = 24						; size = 4
__vsnprintf_l PROC					; COMDAT

; 1385 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 1386 :     int const _Result = __stdio_common_vsprintf(

  00003	ff 75 18	 push	 DWORD PTR __ArgList$[ebp]
  00006	ff 75 14	 push	 DWORD PTR __Locale$[ebp]
  00009	ff 75 10	 push	 DWORD PTR __Format$[ebp]
  0000c	ff 75 0c	 push	 DWORD PTR __BufferCount$[ebp]
  0000f	ff 75 08	 push	 DWORD PTR __Buffer$[ebp]
  00012	e8 00 00 00 00	 call	 ___local_stdio_printf_options
  00017	8b 08		 mov	 ecx, DWORD PTR [eax]
  00019	ff 70 04	 push	 DWORD PTR [eax+4]
  0001c	83 c9 01	 or	 ecx, 1
  0001f	51		 push	 ecx
  00020	e8 00 00 00 00	 call	 ___stdio_common_vsprintf

; 1387 :         _CRT_INTERNAL_LOCAL_PRINTF_OPTIONS | _CRT_INTERNAL_PRINTF_LEGACY_VSPRINTF_NULL_TERMINATION,
; 1388 :         _Buffer, _BufferCount, _Format, _Locale, _ArgList);
; 1389 : 
; 1390 :     return _Result < 0 ? -1 : _Result;

  00025	83 c9 ff	 or	 ecx, -1
  00028	83 c4 1c	 add	 esp, 28			; 0000001cH
  0002b	85 c0		 test	 eax, eax
  0002d	0f 48 c1	 cmovs	 eax, ecx

; 1391 : }

  00030	5d		 pop	 ebp
  00031	c3		 ret	 0
__vsnprintf_l ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File c:\program files (x86)\windows kits\10\include\10.0.10240.0\ucrt\corecrt_stdio_config.h
;	COMDAT ___local_stdio_printf_options
_TEXT	SEGMENT
___local_stdio_printf_options PROC			; COMDAT

; 74   :     static unsigned __int64 _OptionsStorage;
; 75   :     return &_OptionsStorage;

  00000	b8 00 00 00 00	 mov	 eax, OFFSET ?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage

; 76   : }

  00005	c3		 ret	 0
___local_stdio_printf_options ENDP
_TEXT	ENDS
END
